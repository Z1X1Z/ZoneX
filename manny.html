<?php header('Cache-Control: max-age=31536000, public'); ?>

<!DOCTYPE html>
<html lang="en">
    <head>
        <script>
            window.userHasGestured = false;
            </script>
        <title>Starship~Zone:X</title>
        <meta charset="utf-8">
       <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <link type="text/css" rel="stylesheet" href="main.css">
</head>
        
        <body oncontextmenu="return false;">
            <!--disable right click solution from
                                        https://stackoverflow.com/questions/381795/how-to-disable-right-click-context-menu-in-javascript  -->
            <script src="OFFLINEonlineSwitch.js">
            </script>

            
            <script>
                window.iOS = false;
                window.android=false;
                window.mobile=false;
                if (/iPad|iPhone|iPod/.test(navigator.platform) || (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1) )
                  {
                      window.rez=window.devicePixelRatio/5.;
                      window.mobile=true;
                      window.iOS=true;
                  }
                  else if(navigator.userAgent.toLowerCase().match(/mobile/i)){
                       window.rez=window.devicePixelRatio/7.;
                       window.mobile=true;
                      window.android=true;
                   }
                  else       {
                      
                      window.rez=window.devicePixelRatio/2.;
                      window.mobile=false;
                      }
                </script>
       
            <script>
                var iframe = document.createElement('iframe');
                
                    let chapter = "";
                    let book = ""
                    let bookIndex = "";

                    let urlAppend = ""
                    window.readerSet = false;
                    let bibleWithText = false;
                    window.muteToggle = false

                if(true||location.hash.includes(".b")||location.hash.includes(".c("))
                {
                    if (location.hash.includes(".c("))
                    {let c = 0;
                        while (location.hash.slice(c-3,c)!=".c("&&c<location.hash.length)
                        {
                            c++;
                               }
                        while (location.hash[c]!=")"&& isNaN(location.hash[c])&&c<location.hash.length)
                        {
                        book+=location.hash[c];
                        c++;}
                        while (location.hash[c]!=")"&& !isNaN(location.hash[c])&&c<location.hash.length)
                        {
                        chapter+=location.hash[c];
                        c++;}
                    
let bookOfBooks=[
                    "Genesis",
                    "Exodus",
                    "Leviticus",
                    "Numbers",
                    "Deuteronomy",
                    "Joshua",
                    "Judges",
                    "Ruth",
                    "iSamuel",
                    "iiSamuel",
                    "iKings",
                    "iiKings",
                    "iChronicles",
                    "iiChronicles",
                    "Ezra",
                    "Nehemiah",
                    "Esther",
                    "Job",
                    "Psalms",
                    "Proverbs",
                    "Ecclesiastes",
                    "Songs",
                    "Isaiah",
                    "Jeremiah",
                    "Lamentations",
                    "Ezekiel",
                    "Daniel",
                    "Hosea",
                    "Joel",
                    "Amos",
                    "Obadiah",
                    "Jonah",
                    "Micah",
                    "Nahum",
                    "Habakkuk",
                    "Zephaniah",
                    "Haggai",
                    "Zechariah",
                    "Malachi",
                    
                    "Matthew",
                    "Mark",
                    "Luke",
                    "John",
                    "Acts",
                    "Romans",
                    "iCorinthians",
                    "iiCorinthians",
                    "Galatians",
                    "Ephesians",
                    "Philippians",
                    "Colossians",
                    "iThessalonians",
                    "iiThessalonians",
                    "iTimothy",
                    "iiTimothy",
                    "Titus",
                    "Philemon",
                    "Hebrews",
                    "James",
                    "iPeter",
                    "iiPeter",
                    "iJohn",
                    "iiJohn",
                    "iiiJohn",
                    "Jude",
                    "Revelation"
]
if(book.toLowerCase()=="songofsolomon"||book.toLowerCase()=="songofsongs")
book = "songs"

let maxLetterDepth=-1;
    for(var h = 0; h<bookOfBooks.length; h++)
    {
        let letterDepth=0;

        while(letterDepth<bookOfBooks[h].length&&letterDepth<book.length
              &&
              bookOfBooks[h][letterDepth].toLowerCase()==book[letterDepth].toLowerCase())
        {
        
            if (letterDepth>maxLetterDepth)
            {
            bookIndex = h;
            maxLetterDepth = letterDepth

            }
        letterDepth++;
        }
    }
    if (bookIndex=="") book = ""
    else
    {
        book=bookOfBooks[bookIndex].toLowerCase();

        let place = 0;
        if(book[place]=="i" && book!="isaiah"){
           while(book[place]=="i" && book!="isaiah")
            place++
        book=(place-1)+'_'+book.slice(place,book.length)
        }
}
         urlAppend = "chapter/"+book+"/"+chapter+".htm"
}
                    if( location.hash.includes(".c")||location.hash.includes(".b"))window.readerSet=true;
                     if (location.hash.includes(".b8"))
                    iframe.setAttribute("src", "https://openbible.com/audio/gilbert_music/");
                            else if(location.hash.includes(".b7"))   iframe.setAttribute("src","https://openbible.com/audio/gilbert_music_books/");

                            else if(location.hash.includes(".b6"))     iframe.setAttribute("src", "https://openbible.com/audio/hays/");
                            else if(location.hash.includes(".b5"))    iframe.setAttribute("src", "https://openbible.com/audio/souer/");
                            else if(location.hash.includes(".b4"))    iframe.setAttribute("src", "https://openbible.com/audio/gilbert/");
                        else if(location.hash.includes(".b3") )   iframe.setAttribute("src","https://openbible.com/audio/hays_books/");
                        else if(location.hash.includes(".b2")  )   iframe.setAttribute("src","https://openbible.com/audio/souer_books/");
                    else if(location.hash.includes(".b1")    ) iframe.setAttribute("src","https://openbible.com/audio/gilbert_books/");
                     else
                     {
                         if( location.hash.includes(".c")||location.hash.includes(".b")) iframe.setAttribute("src",  "https://www.biblehub.com/audio/"+urlAppend);
                         bibleWithText = true;}
                iframe.setAttribute("height", "100%");
                iframe.setAttribute("width", "100%");
                iframe.setAttribute("class", "onTOP");
                iframe.setAttribute("name", "TheBible");
                iframe.setAttribute("style","margin-left:50%;\
                                    -moz-transform: scaleX(0.5);\
                                    -moz-transform-origin: 0 0;\
                                    -o-transform: scaleX(0.5);\
                                    -o-transform-origin: 0 0;\
                                    -webkit-transform: scaleX(0.5);\
                                    -webkit-transform-origin: 0 0;");
               // iframe.setAttribute("style", "position:fixed");
                iframe.setAttribute("Id","Bible");
                document.body.appendChild(iframe);
        if(!location.hash.includes(".c")&&!location.hash.includes(".b")){
                iframe.setAttribute("width", "0");
                iframe.setAttribute("height", "0");
}
        
                }
                </script>
        <div id="load message" style="font-size:50px; background-color:blue;">     </div>

        <script>
            function loadScript(element, url, offlineURL)
            {
                // Adding the script tag to the head as suggested before
                var scriptElement = document.getElementById(element);//document.createElement("script");//
                scriptElement.type = 'text/javascript';
                scriptElement.src = url;
                //script.onreadystatechange = callback;                // Then bind the event to the callback function.  or at least that's how it goes without the stallLurker in the sonicstarship.  it's stabler. maybe
                //script.onload = callback;                // There are multiple callbacks for cross browser compatibility.
                scriptElement.onerror=function(){
                    var s = document.createElement("script");//document.getElementById('threeJSscript');
                    s.type = 'text/javascript';
                    s.src = offlineURL;
                    document.head.appendChild(s);
                    }
            }
          </script>




        <script id="threeJSscript"></script>
        <!--Deprecates with v160 of threejs
        <script>
        var cdnSwitchThree="three.js";
        //if (window.useCDN)cdnSwitchThree="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js";
        if (window.useCDN)cdnSwitchThree="https://cdn.jsdelivr.net/gh/Z1X1Z/zonex_jsdelivr/three.min.js";
        loadScript("threeJSscript",cdnSwitchThree,"three.js")
        </script>
        -->
        <script id="shim"></script> <!-- you need to provide the .js file, see README.md-->
        <script>
        var cdnSHIM="";
        if (window.useCDN)
        {cdnSHIM="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js";
        loadScript("shim",cdnSHIM,"");
        }
        </script>
       
        <script type="importmap">
          {
            "imports": {
                "three": "https://unpkg.com/three@v0.150.0/build/three.module.js"
            }
          }
        </script>
        
        <script id="osmdJS"></script> <!-- you need to provide the .js file, see README.md-->
        <script>
        var cdnOSMD="opensheetmusicdisplayMODIFIED.min.js";
        if (window.useCDN)cdnOSMD="https://cdn.jsdelivr.net/gh/Z1X1Z/zonex_jsdelivr@8/opensheetmusicdisplayMODIFIED.min.js";
        loadScript("osmdJS",cdnOSMD,"opensheetmusicdisplayMODIFIED.min.js")
        </script>
        
        <script id="wadJSscript"></script>
        <script>
        var cdnSwitchWAD="wad.min.js";
        if (window.useCDN)cdnSwitch="https://unpkg.com/web-audio-daw@4.12.0";
        
        function wrapperLurker(){
            if (userHasGestured)        loadScript("wadJSscript",cdnSwitchWAD,"wad.min.js")
            else        setTimeout(wrapperLurker,100);
        }
        //if(!location.hash.includes(".f")) //needs to be vetted
        wrapperLurker();
        </script>

        <!-- removing this script may fix android no load bug, but I'm testing z ordering in css        -->

        <div id="background_wrap">
   
               
           </div>

        <script>
            //splash
            let nf = document.getElementById('background_wrap');
            if(window.online)
            {
                if(Date.now()%2==1) nf.style = "background-image: url('https://cdn.jsdelivr.net/gh/Z1X1Z/zonex_jsdelivr@6/z1xlogo.png');"
                else nf.style = "background-image: url('https://cdn.jsdelivr.net/gh/Z1X1Z/zonex_jsdelivr/pentaloctalwtlzonexmonogram.jpeg');"
           }
            else
            {
                if(Date.now()%2==1)nf.style = "background-image: url('z1xlogo.png');"
                else nf.style = "background-image: url('pentaloctalwtlzonexmonogram.jpeg');"
                }
            
        </script>
           


    <div  id="nav" class="navbar" style="width:100%;z-index:4;">
        
            <div id="menu" style="display:none;">

        <div>
        <div class="dropdown">
          <button  class="dropbtn">Shp
          <div id="m1" class="dropdown-content">
              <!--https://www.w3schools.com/tags/att_input_type_number.asp this is the link for the below number code profile-->
            <!--  <label for="pitch Sample Size">pitch detection frames (1-2048):</label>
             <input type="number" id="pitch Sample Size" name="pitch Sample Size" class="num" min="1" max = "2048" onkeyup="Math.floor(fractionOfFrame=document.getElementById('pitch Sample Size').value)">
                 </p>
            -->
            <label for="ConcertKey">THE A Key Frequency (Should probably be "Concert A" 440 hz):</label>
           <input type="number" id="ConcertKey" name="ConcertKey" class="num" onkeyup="
                number = 'no number'
;
           if(document.getElementById('ConcertKey').value!=0)
                {
                window.ConcertKey=document.getElementById('ConcertKey').value
uniforms.concertKeyTuning.value=document.getElementById('ConcertKey').value
}
else {window.ConcertKey=440.;uniforms.concertKeyTuning.value=440.;}
">
               <br>
               
               <label for="TouchVolume">Touch Volume (0-1?):</label>
              <input type="number" id="TouchVolume" name="TouchVolume" class="num" onkeyup="
                                   number = 'no number'
;
                   window.touchVolume=document.getElementById('TouchVolume').value
            if(window.wadLOADED)
                for(var d = 0;d<DAWSonicTouchArray.length;d++)
                {
                    DAWSonicTouchArray[d]=refreshNoteDAW(DAWSonicTouchArray[d]);
                   //thread unsafe? Scope unsure// // if(bfi!=null) SonicTouchArrayX=DAWSonicTouchArray
                }
">
                  <br>
                  
               <label for="RadialWarp">Magnify rate of the octave, radially by</label>
              <input type="number" id="RadialWarp" name="RadialWarp" class="num" onkeyup="
                number = 'no number'
;
                    let b=document.getElementById('RadialWarp').value;
                    if(!isNaN(b)&&b>0){
radialWarp=b;
         uniforms.radialWarp.value = radialWarp;
}
">
                  <br>
                  <label for="fretCount">Fruits(max 1365)[a]</label>
                  <input type="number" id="fretCount" name="fretCount" class="num" onkeyup="
                          number = document.getElementById('fretCount').value;
                          key  = 'a';
                          if(!isNaN(number)){
                              callKey(new KeyboardEvent('keydown', {'key':key, 'keyCode':key.charCodeAt(0)}));
                          }
                                                  ">
                      <br>
                      
                      <input type="checkbox" id="extreme" name="t"  onclick= "
                          key  = 'e';
                          callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
                       <label for="extreme">Extreme Frets?![,.e]</label><br>
               
                      <input type="checkbox" id="StackOctaves" name="t"  onclick= "
                          key  = 'k';
                          callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                       <label for="StackOctaves">Concentric Octaves![.k]</label><br>
               
               <input type="checkbox" id="Haptic" name="t"  onclick= "window.haptic = !window.haptic; mcphrth();">
               <label for="Haptic">Haptic Song (Android)</label>
               <br>
               
               <input type="checkbox" id="Haptic2" name="t"  onclick= "window.haptic2 = !window.haptic2; mcphrth();">
               <label for="Haptic2">Haptic Implosion (Android)</label>
               <br>
              <input type="checkbox" id="Game On" name="t"  onclick= "
                  key  = 'e';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
               <label for="Game On">Game On?![e]</label><br>
              <input type="checkbox" id="Star Arms" name="t"  onclick= "
                  key  = '~';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
               <label for="Star Arms">Continuous Arms![~]</label><br>

               <input type="checkbox" id="Fullscreen" name="t"  onclick= "
                   key  = 'h';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                <label for="Fullscreen">Fullscreen![h]</label><br>
                <input type="checkbox" id="Verbose" name="t"  onclick= "
                    key  = 'v';
                    callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                 <label for="Verbose">Verbose![v]</label><br>
               <input type="checkbox" id="Volume Speed" name="t"  onclick= "
                   key  = 'w';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                <label for="Volume Speed">Volume Speed![w]</label><br>


                  <a id="disableVolume" name="t"  onclick= "

                      key  = 's';
                      callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                      Toggle Sound![.s]</a>
                  <input type="checkbox" id="Touch" name="t"  onclick= "
                      key  = 't';
                      callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
               <label for="Touch">Touch![t]</label><br>
               <a id="stillStar" name="t"  onclick= "

                   key  = 't';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
                   Touch Star![,t]</a>
               
                
                <input type="checkbox" id="Ring Spring" name="t"  onclick= "
                    key  = 'U';
                    callKey(new KeyboardEvent('keydown', {'key': key,'altKey':true,'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                 <label for="Ring Spring">Ring Spring![,.U]</label><br>
                <input type="checkbox" id="Note Stack" name="t"  onclick= "
                    key  = 's';
                    callKey(new KeyboardEvent('keydown', {'key': key,'altKey':true,'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                 <label for="Note Stack">Note Stack?![,.s]</label><br>
                 <input type="checkbox" id="Note Stars" name="t"  onclick= "
                   key  = 'P';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                <label for="Note Stars">Note Stars?![P]</label><br>
                <input type="checkbox" id="StarClover" name="t"  onclick= "
                    key  = 'O';
                    callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                 <label for="StarClover">Star in Clover?![O]</label><br>
                 

                     
                     <input type="checkbox" id="flameOrRiver" name="t"  onclick= "
                         key  = 'r';
                         callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                         <label for="flameOrRiver">Flame or River?[,r]</label><br>
                         
                         <input type="checkbox" id="PixelStar" name="t"  onclick= "
                             key  = 'p';
                             callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                             <label for="PixelStar">PixelStar![.p]</label><br>
                             
                             <input type="checkbox" id="pong" name="t"  onclick= "
                                 key  = 'u';
                                 callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
                                 <label for="pong">Pong?![,u]</label><br>
                                 
                                 <input type="checkbox" id="gatesofheaven" name="t"  onclick= "
                                     key  = 'q';
                                     callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'altKey':true,'keyCode':key.charCodeAt(0)}));">
                                     <label for="gatesofheaven">Gates of Heaven![,.q]</label><br>
                                     
                                     <input type="checkbox" id="pixelWitness" name="t"  onclick= "
                                         key  = 'w';
                                         callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'altKey':true,'keyCode':key.charCodeAt(0)}));">
                                         <label for="pixelWitness">Pixel Witnesses?![,.w]</label><br>
                                         
                                     <input type="checkbox" id="icicles" name="t"  onclick= "
                                         key  = 'i';
                                         callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'altKey':true,'keyCode':key.charCodeAt(0)}));">
                                         <label for="icicles">Icicles?![,.i]</label><br>
                                         
                                         <input type="checkbox" id="lfeq" name="t"  onclick= "
                                             key  = 'u';
                                             callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'altKey':true,'keyCode':key.charCodeAt(0)}));">
                                             <label for="lfeq">Linear Frequency?![,.q]</label><br>


                     <a id="TrailOverflowsClover" name="t"  onclick= "
                     
                     key  = 'Z';
                     callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                        Trail Overflows![Z]</a><br>
                     <a id="TrailOverflowsClover" name="t"  onclick= "
                     
                     key  = 'p';
                      callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
                         Spirograph?![,p]</a><br>

               <a id="pzyghthe" name="t"  onclick= "

                   key  = 't';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                   Harmonic Scythe![.t]</a><br>
               <a id="balloons" name="t"  onclick= "

                   key  = 'b';
                   callKey(new KeyboardEvent('keydown', {'key': key,'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                   Harmonic Balloons![,b]</a><br>
               <a id="balloonsExponential" name="t"  onclick= "

                   key  = 'n';
                   callKey(new KeyboardEvent('keydown', {'key': key,'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                   Harmonic Spiralloons Exponential![,n]</a><br>
               <a id="Star Stream" name="t"  onclick= "

                   key  = 'V';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                   Star Stream!![V]</a><br>
               <a id="BulletMine" name="t"  onclick= "

                   key  = 'B';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                   Stream Bullets\Mines![B]</a><br>
               </div>
          </button>
          </div>
               <div class="dropdown">
                 <button class="dropbtn">Shp2
                 
                 <div id="m2" class="dropdown-content">
                     
                     <input type="checkbox" id="butterflyHoney" name="t"  onclick= "
                         key  = 'w';
                         callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                         <label for="butterflyHoney">Butterfly Honey![.w]</label><br>
                         
                         
                         
                         <select name="Choose Instrument One"  id="Choose Instrument One"
                             onchange="
       
                                           instrument1 = this.value;
       bootSounds(instrument1,instrument2)
       "
                       >
                             <option selected="selected" value='square'>
                                 Square
                             </option>
                             <option value='triangle'>
                                 Triangle
                                </option>
                                   <option value='sawtooth'>
                                       Sawtooth
                                   </option>
                                   <option value='sine'>
                                       Zine
                                   </option>
                         </select>
                         
                         <select name="Choose Instrument Two"  id="Choose Instrument Two"
                             onchange="
       
                                           instrument2 = this.value;
       bootSounds(instrument1,instrument2)
       "
                       >
                             <option value='square'>
                                 Square
                             </option>
                             <option selected="selected" value='triangle'>
                                 Triangle
                                </option>
                                   <option value='sawtooth'>
                                       Sawtooth
                                   </option>
                                   <option value='sine'>
                                       Zine
                                   </option>
                         </select>
                         
                         
                         
               <a id="Clockwise Spin" name="t"  onclick= "

                   key  = 'D';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                   Clockwise Spin![D]</a><br>
               
               <a id="Counter Clockwise Spin" name="t"  onclick= "

                   key  = 'A';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                   Counter Clockwise Spin![A]</a><br>
               
               <a id="Shift Up" name="t"  onclick= "

                   key  = 'W';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                   Shift Up![W]</a><br>
               <a id="Shift Down" name="t"  onclick= "

                   key  = 'S';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                   Shift Down![S]</a><br>
               
               <a id="Star Spin" name="t"  onclick= "

                   key  = 'Q';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                   Star Spin![Q]</a><br>
               
               
                   
               <input type="checkbox" id="manualStar" name="t"  onclick= "
                   key  = 'g';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                   <label for="manualStar">Manual Star![.g]</label><br>
                   
               <label for="Note Skew">Semitones detuned</label>
               <input type="number" id="Note Skew" name="Note Skew" class="num" onkeyup="
                                                               number = 'no number'
;
                       window.twist-=window.skew
                       window.skew = document.getElementById('Note Skew').value*2.;
                       window.twist+=window.skew
                                               ">
                   <br>
                
               <input type="checkbox"  id="witnessFlip" name="t"  onclick= "
                   key  = 'z';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                   <label for="witnessFlip"> Witness Flip![.z]</label><br>
                   
               <input type="checkbox"  id="Brelued" name="t"  onclick= "
            
                       key  = 'x';
                       callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                   <label for="Brelued"> Brued![.x]</label><br>
                       <input type="checkbox"  id="stylus" name="t"  onclick= "
                           key  = 'r';
                           callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'altKey':true,'keyCode':key.charCodeAt(0)}));">
                           <label for="stylus"> Stylus?![,.r]</label><br>
                           
                           
               <a id="Oreo" name="t"  onclick=" key  = 'j';
                       callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
                   Oreo?![,j]</a><br>
               
               
               <a id="Cancel background Noise" name="t"  onclick= "

                   key  = 'p';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                   Squelch![p]</a><br>
               
               <a id="Listen Out" name="t"  onclick= "
                   key  = 'o';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
               listen Out![o]</a><br>
               <a id="Listen In" name="t"  onclick= "
                   key  = 'i';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
               listen In![i]</a><br>

               Tolerance for Pitch [.e]<br>
               <input type="radio" id="High Tolerance" name="tolerance" onclick="window.highORlow = 2">
               <label for="High Tolerance">Constant High!</label><br>
           <input type="radio" id="Low Tolerance" name="tolerance" onclick="window.highORlow =1;">
           <label for="Low Tolerance">Constant Low!</label><br>
           
       <input type="radio" id="Perceptive Tolerance" name="tolerance" onclick="window.highORlow =0;">
       <label for="Perceptive Tolerance">Dynamic Perceptive?!</label><br>
           
           
               <a id="Faster" name="t"  onclick= "
                   key  = '=';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
               Faster Movement![=]</a><br>
               <a id="Slower" name="t"  onclick= "
                   key  = '_';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
               Slower Movement![-]</a><br>
               <a id="Reset Movement Speed" name="t"  onclick= "
                   key  = '0';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
               Reset Movement![0]</a><br>
               
               <label for="movementSpeed">Movement Speed[0]</label>
               <input type="number" id="movementSpeed" name="movementSpeed" class="num" onkeyup="
                       number = document.getElementById('movementSpeed').value;
                       key  = '0';
                       if(!isNaN(number)){
                           callKey(new KeyboardEvent('keydown', {'key':key, 'keyCode':key.charCodeAt(0)}));
                       }
                                               ">
                   <br>
                   
                   <label for="zoomSpeed">Zoom Speed[\]</label>
                   <input type="number" id="zoomSpeed" name="zoomSpeed" class="num" onkeyup="
                           number = document.getElementById('zoomSpeed').value;
                           key  = '\\';
                           if(!isNaN(number)){
                               callKey(new KeyboardEvent('keydown', {'key':key, 'keyCode':key.charCodeAt(0)}));
                           }
                                                   ">
                       <br>
                              <label for="inBoost">In Boost[,.I]</label>
                   <input type="number" id="inBoost" name="inBoost" class="num" onkeyup="
                           number = document.getElementById('inBoost').value;
                           key  = 'I';
                           if(!isNaN(number)){
                               callKey(new KeyboardEvent('keydown', {'key':key, 'altKey':true, 'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));
                           }
                                                   ">
                       <br>
                       <a id="FasterZoom" name="t"  onclick= "
                           key  = ']';
                           callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                       Faster Zoom![]]</a><br>
                       <a id="SlowerZoom" name="t"  onclick= "
                           key  = '[';
                           callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                       Slower Zoom![[]</a><br>
                       <a id="Reset Zoom Speed" name="t"  onclick= "
                           key  = '\\';
                           callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                       Reset Zoom![\]</a><br>
                       <label for="Trail Length">Trail Seconds[/]</label>
                       <input type="number" id="Trail Length" name="Trail Length" class="num" onkeyup="
                               number = document.getElementById('Trail Length').value;
                               key  = '/';
                               if(!isNaN(number)){
                                   callKey(new KeyboardEvent('keydown', {'key':key, 'keyCode':key.charCodeAt(0)}));
                               }
                                                       ">
                           <br>
               <input type="radio" id="1 Rivers" name="eden" onclick="uniforms.eden.value = 0">
               <label for="1 Rivers">1 Rivers[{]</label><br>
               
               <input type="radio" id="5 Rivers in Clover" name="eden" onclick="uniforms.eden .value= 1">
               <label for="5 Rivers in Clover">5 Rivers in Clover[{]</label><br>
               
               <input type="radio" id="5 Rivers" name="eden" onclick="uniforms.eden.value = 2">
               <label for="5 Rivers">5 Rivers Up Top[{]</label><br>
               <a id="Stegosaurus" name="t"  onclick= "
                   key  = '}';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                   Stegasaurus![}]</a><br>
               
               <a id="MannyOnTrail" name="t"  onclick= "
                   key  = 'E';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                   Manny On Trail![E]</a><br>
               
       <a id="starOnDot" name="t"  onclick= "

       key  = 'd';
        callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
    Star on Dot![,d]</a><br>
       <input type="checkbox"  id="pointers" name="t"  onclick= "
           key  = 'j';
           callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
           <label for="pointers"> Pointer?![.j]</label><br>
           
                     <input type="checkbox"  id="user camera" name="t"  onclick= "
                         key  = 'l';
                         callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                         <label for="user camera"> User Camera![.l]</label><br>
                         
                 <input type="checkbox"  id="env camera" name="t"  onclick= "
                     key  = 'v';
                     callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                     <label for="env camera"> Environment Camera![.v]</label><br>

          </div>
               </button>
          </div>
        <div class="dropdown">
          <button class="dropbtn">Clvr
          <div  id="m3" class="dropdown-content">
              <label for="Ngenesis">Ngenesis:[,.t]</label>
             <input type="number" id="Ngenesis" name="Ngenesis" class="num" onkeyup="
                  number = 'no number'
  ;
  uniforms.nGenesis.value=document.getElementById('Ngenesis').value
  
  "><br>
        <label for="squeezeN">Squeeze:[,.Q]</label>
             <input type="number" id="squeezeN" name="squeezeN" class="num" onkeyup="
                  number = 'no number'
  ;
  uniforms.squeezeN.value=document.getElementById('squeezeN').value
  
  "><br>
  
  
              <input type="checkbox"  id="Variant0" name="t"  onclick= "
                  key  = '0';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                  <label for="Variant0"> Variant0![.0]</label><br>
                  <input type="checkbox"  id="Variant1" name="t"  onclick= "
                      key  = '1';
                      callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                      <label for="Variant1"> Variant1![.1]</label><br>
                  <!--
              <input type="checkbox"  id="Variant2" name="t"  onclick= "
                  key  = '2';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                  <label for="Variant2">Variant2![.2]</label><br>

                  <input type="checkbox"  id="Variant3" name="t"  onclick= "
                          key  = '3';
                          callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                          <label for="Variant3">  Variant3![.3]</label><br>
                      -->
                  
      <a id="Chirality" name="t"  onclick= "
          key  = '4';
          callKey(new KeyboardEvent('keydown', {'key': key,  'altKey':true,'keyCode':key.charCodeAt(0)}));">
          Variant4?![.4]</a><br>
      
                              <!--
                              <input type="checkbox"  id="Variant5" name="t"  onclick= "
                                      key  = '5';
                                      callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                                      <label for="Variant5">  Variant5![.5]</label><br>
                                      
                                      <input type="checkbox"  id="Variant6" name="t"  onclick= "
                                              key  = '6';
                                              callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                                              <label for="Variant6">  Variant6![.6]</label><br>
                                              -->
                                              <input type="checkbox"  id="Variant7" name="t"  onclick= "
                                                      key  = '7';
                                                      callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                                                      <label for="Variant7">  Variant7![.7]</label><br>
                                                      
                                                      <input type="checkbox"  id="Variant8" name="t"  onclick= "
                                                              key  = '8';
                                                              callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                                                              <label for="Variant8">  Variant8![.8]</label><br>
                                                              
                                                              <input type="checkbox"  id="Variant9" name="t"  onclick= "
                                                                      key  = '9';
                                                                      callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                                                                      <label for="Variant9">  Variant9![.9]</label><br>
                                                                  
                                          
                                  
                          
              <a id="Chirality" name="t"  onclick= "
                  key  = '|';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                  Flop Chirality![|]</a><br>
              
              <label for="CloverTwist">Twist offset:</label>
             <input type="number" id="CloverTwist" name="CloverTwist" class="num" onkeyup="
                number = 'no number'
;
uniforms.cloverOffset.value=document.getElementById('CloverTwist').value/6.">
                 </p>
                 
                 <a id="Add a petal" name="t"  onclick= "
                     key  = 'u';
                     callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                 Add a petal![u]</a><br>
                 <a id="Remove a petal" name="t"  onclick= "
                     key  = 'y';
                     callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                 Remove a petal![y]</a><br>
                 <!--https://www.w3schools.com/tags/att_input_type_number.asp this is the link for the below number code profile-->
                 <label for="petalCount">Petal Quantity:</label>
                <input type="number" id="petalCount" name="petalCount" class="num" onkeyup="
                number = 'no number'
;
uniforms.petals.value=document.getElementById('petalCount').value-6.">
                    </p>
                    
          <!--       <input type="checkbox" id="omniCore" name="t"  onclick= "
              key  = 'o';
              callKey(new KeyboardEvent('keydown', {'key': key,'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
           <label for="omniCore">omniCORE![,o]</label><br>
                -->
                 
<!--
                       <input type="checkbox" id="dynamicCoring" name="t"  onclick= "
                    key  = 'c';
                    callKey(new KeyboardEvent('keydown', {'key': key,'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                 <label for="dynamicCoring">Dynamic Coring[,c]</label><br>
                 -->
                       <input type="checkbox" id="Center" name="t"  onclick= "
                    key  = 'c';
                    callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
             <label for="Center">Center![c]</label><br>
                 <input type="checkbox" id="Zoom Static" name="t"  onclick= "
                     key  = 'l';
                     callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                  <label for="Zoom Static">Zoom Static![l]</label><br>
                  <input type="checkbox" id="Clovers Pop" name="t"  onclick= "
                      key  = 'n';
                      callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                   <label for="Clovers Pop">Clovers Pop?![n]</label><br>
                   
                   <input type="checkbox" id="Clovers Slide" name="t"  onclick= "
                       key  = 'H';
                       callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                    <label for="Clovers Slide">Clovers Slide![H]</label><br>
                    
                    <input type="checkbox" id="Dancer" name="t"  onclick= "
                       key  = 's';
                       callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                       
                    <label for="Dancer">Dancer![s]</label><br>
                    <!--
                    <input type="checkbox" id="multiplicatorNexus" name="t"  onclick= "uniforms.multiplicatorNexus.value=!uniforms.multiplicatorNexus.value">
                        <label for="multiplicatorNexus">Slippery Spokes![,m]</label><br>
-->
                           <input type="checkbox" id="Refractelate" name="t"  onclick= "
                               key  = '!';
                               callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                            <label for="Refractelate">Refractelate![!]</label><br>


                            <input type="checkbox" id="Clovoid" name="t"  onclick= "
                                key  = '@';
                                callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                             <label for="Clovoid">Clovoid![@]</label><br>
                             
                             <input type="checkbox" id="144000" name="t"  onclick= "
                                 key  = 'J';
                                 callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                              <label for="144000">144000![J]</label><br>
                              <input type="checkbox" id="Spoker" name="t"  onclick= "
                                  key  = 'T';
                                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                               <label for="Spoker">Spoker?![T]</label><br>
                               <input type="checkbox" id="SpokeLove" name="t"  onclick= "
                                   key  = 'F';
                                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                                <label for="SpokeLove">Spoke Love?![F]</label><br>
                                <input type="checkbox" id="Distributor" name="t"  onclick= "


                                                                  key  = 'D';


                                                                  callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'altKey':true,'keyCode':key.charCodeAt(0)}));">


                                                               <label for="Distributor">Distrib?![,.D]</label><br>
                                <input type="checkbox" id="Dilate" name="t"  onclick= "
                                    key  = 'o';
                                    callKey(new KeyboardEvent('keydown', {'key': key,'altKey':true, 'keyCode':key.charCodeAt(0)}));">
                                 <label for="Dilate">Dilate?![.o]</label><br>
                               
                                 <input type="checkbox" id="ftl" name="t"  onclick= "
                                     key  = 'f';
                                     callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
                                     <label for="ftl">Feed?![.,f]</label><br>

                                 <!--
                                 <input type="checkbox" id="super stability" name="t"  onclick= "
                                     key  = ';';
                                     callKey(new KeyboardEvent('keydown', {'key': key,'altKey':true, 'keyCode':key.charCodeAt(0)}));">
                                  <label for="super stability">Super Stability![.;]</label><br>
                                  -->
                                 <input type="checkbox" id="twelveGates" name="t"  onclick= "
                                     key  = 'n';
                                     callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true, 'keyCode':key.charCodeAt(0)}));">
                                     <label for="twelveGates">Daisies?![.n]</label><br>
                                     
                                     <label for="metaGates">Meta Daisies Every?![.m]:</label>
                                     <input type="number" id="metaGates" name="metaGates" class="num" onkeyup="
                                        number = 'no number'
;
                        uniforms.twelveGatesMeta.value=document.getElementById('metaGates').value">
                                         </p>
                                         
                                         <label for="orth">Ortho![,O]:</label>
                                         <input type="number" id="orth" name="orth" class="num" onkeyup="
                                            number = 'no number'
    ;
                          uniforms.OrthoEvery.value=document.getElementById('orth').value">
                                             </p>
                                 <input type="checkbox" id="Cloverso" name="t"  onclick= "
                                     key  = 'G';
                                     callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                                     <label for="Cloverso">Cloverso![,G]</label><br>
                                 <input type="checkbox" id="field Power Boost" name="t"  onclick= "
                                     key  = 'x';
                                     callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                                  <label for="field Power Boost">Field Power Boost![,x]</label><br>
                                  
                                  <input type="checkbox" id="meta field Power Boost" name="t"  onclick= "
                                      key  = 'z';
                                      callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                                   <label for="meta field Power Boost">Meta Field Power Boost![,z]</label><br>
                                   <input type="checkbox" id="dynamicOvercore" name="t"  onclick= "
                                       key  = 'h';
                                       callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'altKey':true, 'keyCode':key.charCodeAt(0)}));">
                                    <label for="dynamicOvercore">dynamic Overcore![,.h]</label><br>
                                 <a id="ReFactor" name="t"  onclick= "
                                     key  = 'r';
                                     callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true, 'keyCode':key.charCodeAt(0)}));">
                                 ReFactor Clover![.r]</a><br>

                                 <a id="swap" name="t"  onclick= "
                                     key  = 'N';
                                     callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                                 Swap?![,.N]</a><br>
                                 
                               <a id="Continuum Clover" name="t"  onclick= "
                                   key  = '&';
                                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                               Continuum Clover?![&]</a><br>
                               <a id="OCF" name="t"  onclick= "
                                   key  = 'o';
                                   callKey(new KeyboardEvent('keydown', {'key': key,'altKey':true,'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                               Oppositional Flop![,.o]</a><br>
                               
                               
                               
                               
                                      <input type="checkbox" id="squareTrioGenesisMeta" name="t"  onclick= "
                         key  = 'p';
                         callKey(new KeyboardEvent('keydown', {'key': key,'ctrlKey':true,'altKey':true, 'keyCode':key.charCodeAt(0)}));">
                                       <label for="squareTrioGenesisMeta">nonaGenesisMeta![,.p]</label><br>
                                     

                                 
                                 <a id="cellularDivision" name="t"  onclick= "
                         key  = 'b';
                         callKey(new KeyboardEvent('keydown', {'key': key,'ctrlKey':true,'altKey':true, 'keyCode':key.charCodeAt(0)}));">
                                     Biogenesis![.,b]</a><br>
                                 
                                 <a id="Pie" name="t"  onclick= "
                         key  = 'l';
                         callKey(new KeyboardEvent('keydown', {'key': key,'ctrlKey':true,'altKey':true, 'keyCode':key.charCodeAt(0)}));">
                                     Pie![,.l]</a><br>
                                 
                                 
                                 </div>
          </button>

          </div>
                               <div class="dropdown">
                                 <button class="dropbtn">Clvr2
                                 <div  id="m4" class="dropdown-content">
                                     <input type="checkbox" id="stellarNursery" name="t"  onclick= "
                                         key  = 'c';
                                         callKey(new KeyboardEvent('keydown', {'key': key,'ctrlKey':true,'altKey':true, 'keyCode':key.charCodeAt(0)}));">
                                      <label for="stellarNursery">Stellar Nursery![.,c]</label><br>
                                      
                                      
                                      
                                      <input type="checkbox" id="squareClover" name="t"  onclick= "
                                          key  = 'q';
                                          callKey(new KeyboardEvent('keydown', {'key': key,'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                                       <label for="squareClover">Square Clover![,q]</label><br>
                                       
                                       
                                      <input type="checkbox" id="sphereClover" name="t"  onclick= "
                                          key  = 'f';
                                          callKey(new KeyboardEvent('keydown', {'key': key,'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                                       <label for="sphereClover">Sphere Clover![,f]</label><br>
                                       
                                       
                                      <input type="checkbox" id="chop" name="t"  onclick= "
                                          key  = 'e';
                                          callKey(new KeyboardEvent('keydown', {'key': key,'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                                       <label for="chop">Chop![,e]</label><br>
                                       
                                       
                                     <label for="Base Number">Log base this of x^3 (maybe 1.5-4):</label>
                                    <input type="number" id="Base Number" name="Base Number" class="num" onkeyup="
                number = 'no number'
;
uniforms.baseN.value=document.getElementById('Base Number').value">
                                        <br>
                                           <label for="coringConstant">Coring Value (>0.):</label>
                   <input type="number" id="coringConstant" name="coringConstant" class="num" onkeyup="
                number = 'no number'
;
                       var coreNUM=document.getElementById('coringConstant').value;
                       if(coreNUM>0.)coreData.fill(Number(coreNUM));
                       else coreData.fill(-1./leaf)


">
                       <br>
                                             <input type="checkbox" id="duperCore" name="t"  onclick= "
                                                                    window.dupered=!window.dupered;">
                                              <label for="duperCore">Duper Core!</label><br>
                       
                <form>

                      <input type="radio" id="OriginalOrange" name="colorMode" onclick="uniforms[ 'colorCombo' ].value=-7;">
                      <label for="OriginalOrange">Original Orange!</label><br>
                  <input type="radio" id="GreenAndPink" name="colorMode" onclick="uniforms[ 'colorCombo' ].value=-2;">
                  <label for="GreenAndPink">Green and Pink!</label><br>
                  <input type="radio" id="OddOrange" name="colorMode" onclick="uniforms[ 'colorCombo' ].value=-3;">
                  <label for="OddOrange">Odd Orange!</label><br>
                  <input type="radio" id="YellowAndPurple" name="colorMode" onclick="uniforms[ 'colorCombo' ].value=-4;">
                  <label for="YellowAndPurple">Yellow and Purple!</label><br>

                  <input type="radio" id="BlueAndPink" name="colorMode" onclick="uniforms[ 'colorCombo' ].value=-5;">
                  <label for="BlueAndPink">Blue and Pink!</label><br>

                  <input type="radio" id="Glowing" name="colorMode" onclick="uniforms[ 'colorCombo' ].value=-6;">
                  <label for="Glowing">Glowing!</label><br>

                    <input type="radio" id="Rainbow" name="colorMode" onclick="uniforms[ 'colorCombo' ].value=-1;">
                    <label for="Rainbow">Rainbow?!</label><br>

                      <input type="radio" id="Inheritance" name="colorMode" onclick="uniforms[ 'colorCombo' ].value=-8;">
                      <label for="Inheritance">Inheritance!</label><br>
                </form>
                [q]

                <br>

                <input type="checkbox" id="Reverse Colors" name="t"  onclick= "
                    key  = ';';
                    callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                 <label for="Reverse Colors">Reverse Colors![;]</label><br>

                 <input type="checkbox" id="Remediate Colors" name="t"  onclick= "
                     key  = 'R';
                     callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                  <label for="Remediate Colors">Remediate Colors![R]</label><br>

                  <input type="checkbox" id="Inherited Colors" name="t"  onclick= "
                      key  = 'K';
                      callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                   <label for="Inherited Colors">Inherited Colors?![K]</label><br>

                  <input type="checkbox" id="Black" name="t"  onclick= "
                      key  = 'T';
                      callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'altKey':true, 'keyCode':key.charCodeAt(0)}));">
                   <label for="Black">black![,.B]</label><br>


                   <input type="checkbox" id="Radial Rainbow Clover" name="t"  onclick= "
                       key  = 'M';
                       callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                    <label for="Radial Rainbow Clover">Radial Rainbow Clover![M]</label><br>


                    <input type="checkbox" id="Spin Towards Me" name="t"  onclick= "
                        key  = 'h';
                        callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
                     <label for="Spin Towards Me">Spin Towards Me![,h]</label><br>
 
                    <input type="checkbox" id="spinner" name="t"  onclick= "
                        key  = 'C';
                        callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'altKey':true,'keyCode':key.charCodeAt(0)}));">
                     <label for="spinner">Relativity![,.C]</label><br>
 



                <form>
                  <input type="radio" id="Up" name="carousel" onclick="uniforms[ 'carousel' ].value=-1;">
                  <label for="Up">Carousel Up!</label><br>
                  <input type="radio" id="Down" name="carousel" onclick="uniforms[ 'carousel' ].value=1;">
                  <label for="Down">Carousel Down!</label><br>
                  <input type="radio" id="Off" name="carousel" onclick="uniforms[ 'carousel' ].value=0;">
                  <label for="Off">Carousel Off</label>

                </form>
                [j]
                <br>

                <form>
                  <input type="radio" id="mUp" name="mcarousel" onclick="uniforms[ 'metaCarousel' ].value=-1;">
                  <label for="mUp">Meta-Carousel Wise One!</label><br>
                  <input type="radio" id="mDown" name="mcarousel" onclick="uniforms[ 'metaCarousel' ].value=1;">
                  <label for="mDown">Meta-Carousel Wise 2!</label><br>
                  <input type="radio" id="mOff" name="mcarousel" onclick="uniforms[ 'metaCarousel' ].value=0;">
                  <label for="mOff">Meta-Carousel Off</label>
                </form>
                [k]
                <br>

            <form>
              <input type="radio" id="SpirallizeOriginal" name="Spirallize" onclick="uniforms[ 'spirated' ].value=1;">
              <label for="SpirallizeOriginal">Spirallize Original!</label><br>
              <input type="radio" id="SpirallizeMirror" name="Spirallize" onclick="uniforms[ 'spirated' ].value=-1;">
              <label for="SpirallizeMirror">Spirallize Mirror!</label><br>
              <input type="radio" id="SpirallizeOff" name="Spirallize" onclick="uniforms[ 'spirated' ].value=0;">
              <label for="SpirallizeOff">Spirallize Off</label>

            </form>
[?]
<br>

<a id="whirl" name="t"  onclick= "
key  = 'i';
callKey(new KeyboardEvent('keydown', {'key': key,'altKey':true, 'keyCode':key.charCodeAt(0)}));">
    Whirlpool![.i]</a><br>

<a id="leaf" name="t"  onclick= "
key  = 'z';
callKey(new KeyboardEvent('keydown', {'key': key,'altKey':true, 'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
    leafType![,.z]</a><br>
<a id="goldenRatio Type" name="t"  onclick= "
key  = 'x';
callKey(new KeyboardEvent('keydown', {'key': key,'altKey':true, 'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
    grType![,.x]</a><br>
<a id="leapIn" name="t"  onclick= "
key  = 'C';
callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
Leap In![C]</a><br>

<a id="resetZoom" name="t"  onclick= "
key  = 'L';
callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
Reset Zoom![L]</a><br>


               
               <input type="checkbox" id="polyNomialStretch" name="t"  onclick= "
                  key  = 'P';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true, 'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
               <label for="polyNomialStretch">polyNomialStretch?![,.P]</label><br>
        
<a id="seventhEYE" name="t"  onclick= "
key  = 'O';
callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true, 'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
seventhEYE![,.O]</a><br>
          <label for="Budge">SeventhEYE Budge:[,.B]</label>
                  <input type="number" id="Budge" name="Budge" class="num" onkeyup="
                                                 number = 'no number'
;
                                 uniforms.budge.value=document.getElementById('Budge').value
                                 "><br>

  
               <input type="checkbox" id="seven2" name="t"  onclick= "
                  key  = 'J';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true, 'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
               <label for="seven2">Seven Squared![,.J]</label><br>
        



        </div>
                                         </button>
                                </div>
        
        <div class="dropdown">
          <button class="dropbtn">Xtr
          <div  id="m5" class="dropdown-content">
                <label for="smush">Smush!:[,.S]</label>
                  <input type="number" id="smush" name="smush" class="num" onkeyup="
                                                 number = 'no number'
;
                                 uniforms.smush.value=document.getElementById('smush').value
                                 "><br>
              <input type="checkbox" id="armStar" name="t"  onclick= "
                  key  = 'R';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true, 'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
               <label for="armStar">ArmStar?![,.R]</label><br>
              <input type="checkbox" id="wink" name="t"  onclick= "
                  key  = 'k';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true, 'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
               <label for="wink">Wink?![,.k]</label><br>
               <input type="checkbox" id="Friends" name="t"  onclick= "
                   key  = 'f';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                <label for="Friends">Friends![f]</label><br>
                <input type="checkbox" id="Bridge" name="t"  onclick= "
                    key  = 'z';
                    callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                 <label for="Bridge">Bridge?![z]</label><br>
             
                 <input type="checkbox" id="cycler" name="t"  onclick= "
                     key  = 'b';
                     callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                  <label for="cycler">Cycler![b]</label><br>
                 <input type="checkbox" id="Wheel" name="t"  onclick= "
                     key  = 'm';
                     callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                  <label for="Wheel">Wheel![m]</label><br>
                  <label for="mandelCloverSize">Wheel Degree:[m]</label>
                  <input type="number" id="mandelCloverSize" name="mandelCloverSize" class="num" onkeyup="
                                                 number = 'no number'
;
                                 uniforms.mandelCloverFactor.value=document.getElementById('mandelCloverSize').value
                                 "><br>
                      
                  <input type="checkbox" id="Articles" name="t"  onclick= "
                      key  = 'G';
                      callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                   <label for="Articles">Articles![G]</label><br>
                   
               <input type="checkbox" id="cloverArms" name="t"  onclick= "
                   key  = 'm';
                   callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true, 'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                <label for="cloverArms">Clover Arms![,.m]</label><br>
                 
                    <input type="checkbox" id="Dynamic Dance" name="t"  onclick= "
                        key  = 'X';
                        callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                     <label for="Dynamic Dance">Dynamic Dance![X]</label><br>
                     
                     <input type="checkbox" id="Feedback Voice" name="t"  onclick= "window.FeedbackSound =  !window.FeedbackSound;">
                      <label for="Feedback Voice">Feedback Voice!(regulated by System Volume)[,v]</label><br>
                      
                      <input type="checkbox" id="Quiet Sound" name="t"  onclick= "window.playQuietestSound =  !window.playQuietestSound;">
                       <label for="Quiet Sound">Quietest Sound![,.v]</label><br>
                      
                     <input type="checkbox" id="Blank background" name="t"  onclick= "
                         key  = 'Y';
                         callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                      <label for="Blank background">Blank background![Y]</label><br>
                      
                 <a id="Cycle Character" name="t"  onclick= "
                     key  = 'U';
                     callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                     Cycle character![U]</a><br>
                 
            <a id="EyeHolies" name="t"  onclick= "
                key  = 'l';
                callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
                Eye Color?![,l]</a><br>
            <a id="InseyedOut" name="t"  onclick= "
                key  = 'J';
                callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
                InseyedOut?![,J]</a><br>
            <a  id="horns" name="t"  onclick= "
                key  = 'L';
                callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
             Altar Horns![,L]</a><br>
                     <a  id="major" name="t"  onclick= "
                key  = 'M';
                callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'altKey':true,'keyCode':key.charCodeAt(0)}));">
             Major?![,.M]</a><br>

       <a id="unrollEyes" name="t"  onclick= "
           key  = 'y';
           callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'altKey':true,'keyCode':key.charCodeAt(0)}));">
           Unroll![,.Y]</a><br>
       
            <a id="Heart Star" name="t"  onclick= "
                key  = 'h';
                callKey(new KeyboardEvent('keydown', {'key': key,'altKey':true, 'keyCode':key.charCodeAt(0)}));">
                Heart Star?![.h]</a><br>
                 
            <a id="BigEyes" name="t"  onclick= "
                key  = 'y';
                callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                BigEyes![.y]</a><br>
            <a id="Music Angel Man" name="t"  onclick= "
                key  = 'a';
                callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'keyCode':key.charCodeAt(0)}));">
                Music Angel Man?![.a]</a><br>
            <a id="spark" name="t"  onclick= "
                key  = 's';
                callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
                Sparkles![,s]</a><br>
            <a id="deck" name="t"  onclick= "
                key  = 'n';
                callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'altKey':true,'keyCode':key.charCodeAt(0)}));">
                Cards![,.n]</a><br>
                 <a id="Metronome Up" name="t"  onclick= "
                     key  = '>';
                     callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                     Metronome Up![>]</a><br>

                 <a id="Metronome Down" name="t"  onclick= "
                     key  = '<';
                     callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                     Metronome Down![<]</a><br>

                 
                 <a id="Just Face" name="t"  onclick= "
                     key  = '*';
                     callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                     Just Face![*]</a><br>
                 
                  <a id="Manny" name="t"  onclick= "
                      key  = 'g';
                      callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                      Manny![g]</a><br>


                  <a id="Acrostic" name="t"  onclick= "
                      key  = '$';
                      callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                      Acrostic![$]</a><br>

                   <a id="ToLToK" name="t"  onclick= "
                       key  = 'd';
                       callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                       ToLToK![d]</a><br>

                    <a id="Mandelbrot" name="t"  onclick= "
                        key  = 'a';
                        callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                        Mandelbrot![,a]</a><br>

                     <a id="Refractelbrot" name="t"  onclick= "
                         key  = 'r';
                         callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                         Refractelbrot![r]</a><br>

           <a id="XSquared" name="t"  onclick= "
               key  = 'x';
               callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
               XSquared![x]</a><br>
           
           <a id="armMode" name="t"  onclick= "
                        key  = 'd';
                        callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true, 'keyCode':key.charCodeAt(0)}));"
>
               Arms?![.d]</a><br>
                                     
                      <input type="checkbox" id="nabaoth" name="t"  onclick= "
                          key  = 'H';
                          callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'ctrlKey':true,'keyCode':key.charCodeAt(0)}));">
                       <label for="nabaoth">Hand Of God?![,.H]</label><br>
               
<!--
         <a id="ToLX" name="t"  onclick= "
             key  = 'b';
             callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
             ToLX![b]</a><br>
         !-->
               
               
        </div>
          </button>

    </div>
        
        <div class="dropdown">
          <button class="dropbtn">Rez
          <div id="resolutionDropContent" class="dropdown-content" style="column-count: 1">
              <label for="rez">Pixels per pixel</label>
             <input type="number" id="rez" name="rez" class="num" onkeyup="
                            rez=window.devicePixelRatio/document.getElementById('rez').value
                            renderer.setPixelRatio( rez);
                            ">
                 <br>
                 <!--
                  <input type="radio" id=".5rez" name="colorMode" onclick="
                  key  = '`';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                  <label for=".5rez">.5 of a pixel per pixel (Apple Only)[`]</label><br>
                 -->
                  <input type="radio" id="1rez" name="colorMode" onclick="
                  key  = '1';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                  <label for="1rez">1 pixel per pixel[1]</label><br>
                  <input type="radio" id="2rez" name="colorMode" onclick="
                  key  = '2';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                  <label for="2rez">2 pixels per pixel[2]</label><br>
                  <input type="radio" id="3rez" name="colorMode" onclick="
                  key  = '3';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                  <label for="3rez">3 pixels per pixel[3]</label><br>
                  <input type="radio" id="4rez" name="colorMode" onclick="
                  key  = '4';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                  <label for="4rez">4 pixels per pixel[4]</label><br>
                  <input type="radio" id="5rez" name="colorMode" onclick="
                  key  = '5';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                  <label for="5rez">5 pixels per pixel[5]</label><br>
                  <input type="radio" id="6rez" name="colorMode" onclick="
                  key  = '6';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                  <label for="6rez">6 pixels per pixel[6]</label><br>
                  <input type="radio" id="7rez" name="colorMode" onclick="
                  key  = '7';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                  <label for="7rez">7 pixels per pixel[7]</label><br>
                  
              <input type="radio" id="8rez" name="colorMode" onclick="
              key  = '8';
              callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
              <label for="8rez">8 pixels per pixel[8]</label><br>
    
                  <a id="Incrementally Increase Resolution" name="t"  onclick="
                  key  = '_';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                      Refine resolution![_]</a><br>
                  <a id="Incrementally Decrease Resolution" name="t"  onclick="
                  key  = '+';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                      Reduce resolution![+]</a><br>
                  
              </div>
          </button>

                  </div>
        <script>
            function setTransparencyCSS(){
                if (sheetTranslucent) {
                           document.getElementById("textWindow").style="position:fixed; margin-left:50%;"
                                             document.getElementById("osmdCanvas").style.bottom="100px"
                }
                else {   document.getElementById("textWindow").style="position:static;margin-left:0%;";
                                             document.getElementById("osmdCanvas").style.bottom="0px"
                                        bottomOfScreenHeight=0;
                    }
            }
            </script>
        <div class="dropdown">
          <button class="dropbtn">Word
               
          <div id="scoreDropContent" class="dropdown-content" style="font-size:1em; column-count:1;">
              
              
              [#.c(BookChapter)]:

              <select name="choose reader"  id="reader"
                  onchange="
              window.readerSet = true;

                                key  = 'b';
                                number = this.value;
                                window.muteToggle = true;
                                callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true, 'keyCode':key.charCodeAt(0)}));
                                window.muteToggle = false;
"
            >
            <option value="100" selected="selected">Blessed Reader
            </option>
                  <option value='0'>
                      Hays (w/ text)[#.b0]
                  </option>
                  <option value='1'>
                      Gilbert by book[#.b1]
                  </option>
                  
                        <option value='2'>
                            Souer by book[#.b2]
                        </option>
                        <option value='3'>
                            Hays by book[#.b3]
                        </option>
                <option value='4'>
                    Gilbert by chapter[#.b4]
                </option>
                
                      <option value='5'>
                          Souer by chapter[#.b5]
                      </option>
                      <option value='6'>
                          Hays by chapter[#.b6]
                      </option>
                      <option value='7'>
                          Gilbert w/ music by book[#.b7]
                      </option>
                      <option value='8'>
                          Gilbert w/ music by chapter[#.b8]
                      </option>
                      
              </select>
              
              
              <input type="checkbox" id="BibleToggle" name="t"  onclick= "
              key  = 'b';
              callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true, 'keyCode':key.charCodeAt(0)}));
">
              <label for="BibleToggle">Listen to The Bible[.b]</label>
              
              <br>

                  <input type="checkbox" id="Guitar" name="t"  onclick= "
                      key  = 'g';
                      callKey(new KeyboardEvent('keydown', {'key': key, 'altKey':true,'ctrlKey':true, 'keyCode':key.charCodeAt(0)}));">
                   <label for="Guitar">Guitar?[,.g]</label><br>
                   <input id="strings"  type="text"></input><br>
        <script>
            document.getElementById("strings").value = "8 13 18 23 27 32"
            </script>
             Load Audio File<input type="file" id="audioFile">
               <a id="Incrementally Decrease Resolution" name="t"  onclick="
                  key  = 'Z';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'ctrlKey':true,'altKey':true,'keyCode':key.charCodeAt(0)}));">
                     Play Audio File![,.Z]</a>
        <select name="song" id="song"
              onchange='
                if(this.value!="none"){
                    loadScore(this.value)

                    if (uniforms.scoreLoaded.value) osmd.clear();
                    uniforms.scoreLoaded.value=true;
            
            
            
                    setTransparencyCSS();
            
            
            
            
                }
                else{
                        osmd.zoom=0.;
                        osmd.render();
                        osmd.clear();
                        osmd=null; adjustThreeJSWindow();
                            uniforms.scoreLoaded.value=false;
                            
                                       document.getElementById("textWindow").style="position:fixed; margin-left:50%;"
            
            }'
        >
              <option value='none'>
                  None
              </option>
            <option value="https://cdn.jsdelivr.net/gh/Z1X1Z/zonex_jsdelivr/JesusChristisRisenToday.xml">
                Jesus Christ is Risen Today
            </option>
            <option value="https://cdn.jsdelivr.net/gh/Z1X1Z/zonex_jsdelivr/Amazing_Grace.mxl">
                Amazing Grace
            </option>
          </select>
          <label for="song"> :song</label>
<br>
          <script> document.getElementById('song').value = "none";</script>
             
             <input type="checkbox" id="ScoreTranslucent" name="t"  onclick= '
        if("osmd" in window&&osmd!=null)
   {
              sheetTranslucent=!sheetTranslucent;

                   setTransparencyCSS();
                if("osmd" in window && typeof osmd != null){
                        setOSMDcolors();
                        onWindowResize();
                    }
   }
   
   '>
              <label for="ScoreTranslucent">Score Translucent</label>
              <input type="checkbox" id="scoreBlack" name="t"  onclick= '
             scoreColorInversion=true;
                if("osmd" in window && typeof osmd != null){
                        setOSMDcolors();
                        osmd.render();
                        getElementById("scoreWhite").checked  = false;
                }
'>              <label for="scoreBlack">Score Black</label>
<input type="checkbox" id="scoreWhite" name="t"  onclick= '
scoreColorInversion=false;
                if("osmd" in window && typeof osmd != null){
                    setOSMDcolors();
                    osmd.render();
                    getElementById("scoreBlack").checked  = false
                }
'>              <label for="scoreWhite">Score White</label>

              <br>
              <a id="osmdSound" name="t"  onclick= '
window.noteHit=true;
           //window.noteExpired=true;
                           window.osmdSound=(window.osmdSound+1)%3;
                            
       if(window.osmdSound==0) for(var o=0;o<osmdOscillators;o++){
            if(typeof singAlong[o] =="object")
            {
                singAlong[o].stop();
                singAlong2[o].stop();
            }
}
                
'>Guide sound</a>
<br>
Open MusicXML file
 <input type="file" id="files" >

                  <output id="list"></output>
                 
                  <br>
                  <a id="reset" name="t"  onclick="
                  key  = ' ';
                  callKey(new KeyboardEvent('keydown', {'key': key, 'keyCode':key.charCodeAt(0)}));">
                      Reset Settings![SPACE]</a><br>
              </div>
          
          </button>

                  </div>
        
        
     

        </div>
        <script src="fileSelectAndLoadOSMD.js"></script>
        
<div>
    <p>
        <div id="hotkeyHolder">
              
              </div>
</div>
              
    </div>

    </div>
    <script>let n = document.getElementsByName('t');
        for(var p = 0; p<n.length;p++)n[p].checked  = false;

    </script>
    
    <script>
     if(location.hash.includes(".c")||location.hash.includes(".b"))
     {
        let content = document.getElementsByClassName("dropdown-content");
        document.getElementById("nav").style.width="50%";
        for(var o = 0; o<content.length; o++)content[b].style.width="50%";
        }
     
     </script>
    

    
    <div id="menuDivider" class="onBottom" style="text-align:right; width:100%; z-index:4;">
        
            <button name="menuButton" style = "background-color:rgba(127.5,127.5,127.5,0.333);" onclick='
                let menu=document.getElementById("menu")
                if( menu.style.display=="block")  menu.style.display="none"
                else if( menu.style.display=="none")menu.style.display="block";'>Menu</button>
    </div>
    <script>
        if(window.readerSet)document.getElementById("menuDivider").style.width="50%"
    </script>

  <div id="timeNumber" style="color:white;font-size:20em;text-align: center;   top: 0%;      width: 100%;z-index:5;position:absolute;"></div>
  <div id="numberExplanation" style="color:white;font-size:7em;text-align: center;   top: 55%;      width: 100%;z-index:5;position:absolute;"></div>

    <div id="container"> 
      </div></div></div>
    <script src="wadLoader.js"> </script>
    <div>
    <div id="textWindow" class="onBottom" style="z-index:3;font-size:16;"></div>


    <div id="score">

        <canvas id="CANVAS"></canvas>

            <div id="osmdCanvas" class="onBottom" style = "bottom:0px;z-index:4;
">

                <div id="anchorDiv" >
                    <img id="CursorIMG"></img>
                    <canvas id="osmdCanvasAnchor"  >
                        </canvas>
                </div>
            </div>

    </div>
    </div id="score">
    </div>
        <script>
        document.getElementById("files").addEventListener("change", handleFileSelect, false);
/*
        document.getElementById("score").onpointerdown=
        function(event){
          event.stopImmediatePropagation();
          event.preventDefault();
        };
 */
        </script>
    
    
    
    <script>//used for resetting column counts for screen porportion in onWindowResize in starshipMod
        var menuBoxes = document.getElementsByClassName("dropdown-content")
        var rezBox = document.getElementById("resolutionDropContent");
        var scoreBox = document.getElementById("scoreDropContent");

          let aeid="";
          let blocked = false;
          let onMenuHeader = false;
          function pointerInMenu(e){
             onMenuHeader = false;
            if(e.srcElement.className=="dropbtn")
            {onMenuHeader = true;

                }
          }
        function closeMenus()
        {
            let allMenus = document.getElementsByClassName("dropdown-content");
        for(var menus=0; menus<allMenus.length;menus++)
       
       allMenus[menus].style.display="none";
        let allButtons = document.getElementsByClassName("dropbtn");
    for(var buttons=0; buttons<allButtons.length;buttons++)
    allButtons[buttons].style.backgroundColor="rgba(127.5,127.5,127.5,.5)";
        
            }
          function toggleMenuCategory ()
          {
          if(ae!=null&&!menuJustClosedBybackgroundPress&&ae.id!="load message"){
              
              closeMenus();
               
                if(ae.id!=aeid)
                {
                blocked=false;
                }
            if(blocked&&onMenuHeader)
              {ae.style.display="none";blocked=false;
                  document.activeElement.style.backgroundColor="rgba(127.5,127.5,127.5,.5)";

              }
              else if(!blocked&&onMenuHeader)
              {ae.style.display="block";blocked=true;
                  ae.parentElement.style.backgroundColor="green";

              }
              else if(ae.style.display=="none"||ae.style.display=="")
              {blocked=true;

              ae.style.display="block";
              ae.parentElement.style.backgroundColor="green";

              }
              else {
                  blocked=false;
                  ae.style.display="none";
                  ae.parentElement.style.backgroundColor="rgba(127.5,127.5,127.5,.5)";

                  }          aeid=ae.id;

                              }

          menuJustClosedBybackgroundPress=false

          }
        let menuJustClosedBybackgroundPress = false;

        document.getElementById("container").addEventListener("pointerdown",(e)=>{aeid="";menuJustClosedBybackgroundPress=true;closeMenus();})

        document.getElementById("menuDivider").addEventListener("pointerdown",(e)=>{aeid="";menuJustClosedBybackgroundPress=true;closeMenus();})
        
        document.getElementById("textWindow").addEventListener("pointerdown",(e)=>{aeid="";menuJustClosedBybackgroundPress=true;closeMenus();})

         addEventListener("pointerover",(e)=>{pointerInMenu(e)})

         //addEventListener("pointerup",(e)=>{)//setTimeout to give android time to notice active element
         addEventListener("pointerdown",(e)=>{
ae=(e.target.className=="dropbtn")?e.target.firstElementChild:null;
          setTimeout(toggleMenuCategory,50)
          
         })//setTimeout to give time for menuJustClosedBybackgroundPress

    </script>
    
    
    
    
    <script id="vertexShader" type="x-shader/x-vertex" >

        varying vec2 vUv;

    void main()    {

        vUv = uv;
        gl_Position = vec4( position, 1.0 );
    }
</script>


    <script id="wipeFragmentShader" type="x-shader/x-fragment">
        varying vec2 vUv;
        uniform sampler2D cloverSampler;
        uniform vec2 resolution;
       void main(){
          //  gl_FragColor=texture2D(cloverSampler, vUv);
            gl_FragColor=texture(cloverSampler, vUv);

        }
        </script>

    <script id="FourRiversfragmentShader" type="x-shader/x-fragment">
        varying vec2 vUv;
        uniform sampler2D STAR;
        uniform sampler2D EDEN;
        uniform vec2 loudestFret1;
        uniform vec2 loudestFret2;
        uniform vec2 loudestFret3;
        uniform vec2 loudestFret4;
        uniform vec2 d;
        uniform vec2 resolution;
        
        uniform float volumeFret1;
        uniform float volumeFret2;
        uniform float volumeFret3;
        uniform float volumeFret4;
        
        uniform int eden;


        const float PI = 3.14159274;
        
        
        
        
       // const float gr = -cos(216.*PI/180.)/-cos(612.*PI/180.)-1.;
                            ///const float leaf = -1.32471795;
                              //leafbypass to alternative mode below     https://www.wolframalpha.com/input?i=a%3D%28%281-%28%281-%28%281-a%29%5E2-1%29%29%5E2-1%29%29%5E2-1%29
                            //  const float leaf = (1.347296355333/-1.32471795)*4./3.;
                            // const gr = //sqrt
                           //                       ((2.5320888862379)/1.618033988749);
                             //a=1.3472963553338606977034332535386295920007513543681387744724827562641316442780294708430332263148
                              //    a=2.5320888862379560704047853011108333478716649141607904917080905692843107777137494470564585533611
                             //     and a=-0.87938524157181676810821855464946293987241626852892926618057332554844242199177891789949177967590
                              
                              
        float zin(float x){return -sin(x);}
        float coz(float x){return -cos(x);}
        
        
        vec2 spin2(vec2 f, float t)
        {    //https://en.wikipedia.org/wiki/Rotation_matrix
            float angle =t;
            float fxb=f.x;
            f.x=-f.x*coz(-angle)-f.y*zin(-angle);
         f.y=fxb*zin(-angle)-f.y*coz(-angle);
         return f;
        }
        
void main(){
        vec4 Pishon=vec4(0.),Gihon=vec4(0.),Tigris=vec4(0.),Euphrates=vec4(0.);
        vec2 vUvEagle=vec2(0.),vUvMan=vec2(0.),vUvOx=vec2(0.),vUvLion=vec2(0.);
        
            float cutOutDegree=1.;
            float atanD = atan(d.y,d.x);
            float stegOrFour = 1.;
            if(eden!=4)
       {
           vec2 vUv2 = vUv*2.;

                vUvEagle=vUv2-1.;
                vUvMan=vUv2;
                vUvOx=vUv2+vec2(0.,-1.);
                vUvLion=vUv2+vec2(-1.,0.);
       }
       else
       {
           vec2 scale = min(resolution.x,resolution.y)/resolution.yx;
           vec2 vUvScaled =(vUv-.5)*scale;
             vUvEagle = (vUvScaled*volumeFret1-loudestFret1/8.)/scale*2.+.5;
             vUvMan = (vUvScaled*volumeFret2-loudestFret2/8.)/scale*2.+.5;
             vUvOx = (vUvScaled*volumeFret3-loudestFret3/8.)/scale*2.+.5;
             vUvLion = (vUvScaled*volumeFret4-loudestFret4/8.)/scale*2.+.5;
                        stegOrFour=2.;
    }
            if(abs(max(vUvEagle.x,vUvEagle.y))<1.&&min(vUvEagle.x,vUvEagle.y)>0.)
                        Pishon += texture2D(STAR,vUvEagle);
            if(abs(max(vUvOx.x,vUvOx.y))<1.&&min(vUvOx.x,vUvOx.y)>0.)Gihon+=texture2D(STAR,vUvOx);
            if(abs(max(vUvMan.x,vUvMan.y))<1.&&min(vUvMan.x,vUvMan.y)>0.) Tigris+=texture2D(STAR,vUvMan);
            if(abs(max(vUvLion.x,vUvLion.y))<1.&&min(vUvLion.x,vUvLion.y)>0.)Euphrates+=texture2D(STAR,vUvLion);
            vec4  TheFifthRiver = texture2D(STAR,vUv);

             gl_FragColor=clamp((Pishon+Gihon+Tigris+Euphrates)
                      // -TheFifthRiver//alpha blended
                       -TheFifthRiver*stegOrFour
                       ,0.,1.)
    /vec4(vec3(1.5),1.)+TheFifthRiver;//vec4(vec3(2.),1.); //the divisor of the rivers is seemingly open to interpretation
    ;}
        </script>
<script id="fragmentShader" type="x-shader/x-fragment">
    varying vec2 vUv;
    
        uniform float squeezeN;

    uniform float movieTime;
    uniform float concertKeyTuning;
    uniform float noteFrozen;
    uniform int cellularDivision;
    uniform bool triogenesis;
    
        uniform float seventhEYE;

        uniform float budge;

        uniform bool polyNomialStretch;
        uniform bool Black;
        uniform int swap;



    uniform bool squareGenesis;
    uniform int nGenesis;
    uniform bool eyeSingle;
    uniform int unroll;

    uniform float coreDilation;
    uniform bool gates;
    uniform int armsSpinning;
    uniform float lownote;
    uniform int oppositionalCoreFlop;
    uniform bool chop;
    uniform bool superStable;
    uniform bool spinTowardsMe;
    uniform float whirlpool;
    uniform bool distributor;
    uniform bool sevenSquared;
    uniform float largeEyeColor;
    uniform float cloverOffset;
    
    uniform bool Pointers;
    uniform bool pixelSTARon;
    uniform bool pixelWitnesses;
    uniform bool icicle;
    uniform bool linearEQ;

    uniform bool pongOn;
    uniform int heartStar;
    uniform int holyeyes;
    uniform float maxSamp;
    uniform float minSamp;

    uniform float fftSize;
    uniform float zoomOutRatchetThreshold;
    uniform float sampleRate;
    uniform float nyq;//actually 2/nyquist
    uniform float radialWarp;
    uniform sampler2D audioBuffer;
    uniform sampler2D micIn;

    uniform sampler2D videoTexture;
    uniform sampler2D videoTexture2;

    
    uniform sampler2D STAR;
    uniform sampler2D EDEN;
    uniform sampler2D coreTextureSampler;
    uniform sampler2D omniDynamic;
    uniform vec2 constellationDynamic[50];
    uniform sampler2D pitchHandsFingers;
    uniform sampler2D firstHandsFingers;
    uniform sampler2D secondHandsFingers;
    uniform sampler2D thirdHandsFingers;
    uniform sampler2D fourthHandsFingers;
    
        uniform sampler2D twelveNotesTex;
                uniform bool ringSpring;

        uniform sampler2D radialFrequenciesSummed;

    uniform int major;

    uniform bool constellation;

    uniform float squirgleDynamic[12];
    uniform int squirgle;
    uniform bool cards;
    uniform sampler2D uberDuper;

    uniform int eden;

    uniform bool multiplicatorNexus;
    uniform bool squareClover;

    uniform int musicAngelMan;
    uniform bool fieldPowerBoost;
    uniform bool fieldPowerBoostMeta;
    uniform bool helm;
    uniform float balloonsON;
    uniform float balloonsONexponential;
    uniform bool sparklesON;
    uniform bool SPHEREofTheLORD;
    uniform float note;
    uniform float upOrDown;
    uniform bool handOfGod;
    uniform vec2 pongBallCoords;

    uniform float refactorCores;
    uniform bool clvrVariant1;
    uniform bool clvrVariant2;
    uniform bool clvrVariant3;
    uniform float clvrVariant4;
    uniform bool clvrVariant5;
    uniform bool clvrVariant6;
    uniform bool clvrVariant7;
    uniform bool clvrVariant8;
    uniform bool clvrVariant9;
    uniform bool clvrVariant0;

    uniform bool dynamicDance;
    
    uniform bool Spoker;
    uniform bool spokelover;
    uniform bool twelveGates;
    uniform float twelveGatesMeta;
    uniform bool dilate;

    uniform int continuumClover;
    uniform bool cloverSlide;
    uniform bool dynamicOvercore;
    uniform float baseN;
    
    uniform bool Inherited;
    uniform int spokesVisualizeColors;
    uniform vec2 coords;
    uniform vec2 constellationCoord;
    uniform int starOnDot;
    uniform vec2 dotCoord;
    uniform vec2 d;
    uniform vec2 coordSHIFT;
    uniform float duperZoom;

    uniform vec2 resolution;

    uniform int colorCombo;
    uniform bool colorInverter;
    
    uniform bool gameOn;
    uniform bool scoreLoaded;

    uniform float time;
    uniform float volume;
    uniform float totalAmp;

    uniform float rate;
    uniform float zoom;
    uniform float metronome;

    uniform float time2dance;
    uniform int fourCreats;
    uniform int Character;
    uniform bool articles;


    uniform bool MetaCored;//used for freezing current zoom level
    uniform bool outerCoresOff;//used for isolating coring to central core

    uniform bool free;

    uniform float morph;
    uniform bool spinner;

    uniform float carousel;
    uniform float metaCarousel;
    uniform float petals;

    uniform float spirated;

    uniform bool hearTOL;

    uniform bool wheel;
    uniform bool Refractelate;
    uniform float centralCores;
    uniform float externalCores;
    uniform float upCoreCycler;

uniform bool Clovoid;
uniform bool remediatedColors;
uniform bool dotted;
uniform bool onehundredfortyfourthousand;
uniform float shaderScale;

uniform float starSpin;
uniform int chirality;

uniform int MannyONtrail;
uniform float twistStar;
uniform float flipStar;
uniform float witnessFlip;
uniform float brelued;

uniform bool NightAndDay;

uniform float mandelCloverFactor;
uniform float exponentialPetals;
uniform float gr;
uniform float leaf;
uniform bool cloverArms;
uniform int elderHorns;
uniform int inseyedOut;
uniform bool cloverso;
uniform bool feedTheLamb;
uniform float OrthoEvery;


        uniform vec2 loudestFret1;
        uniform vec2 loudestFret2;
        uniform vec2 loudestFret3;
        uniform vec2 loudestFret4;
        
        uniform float volumeFret1;
        uniform float volumeFret2;
        uniform float volumeFret3;
        uniform float volumeFret4;
    uniform float smush;
    uniform bool armStar;
                                  
                                  const float twoThirds = 2./3.;
                                  const float sqrt2 = sqrt(2.);

                                  const float PI = 3.14159274;
                                  const float PI2 = PI*2.;
                                  const float divideByMultiplyingPi = 1./PI;

                                  const float divideByMultiplyingPi2 = .5/PI;

                                  const float PIdiv2 = PI/2.;

                                  const float LogHalfReciprocal = 1./log(.5);
                                  const float log2 = log(2.);
                               //   const float gr = -cos(216.*PI/180.)/-cos(612.*PI/180.)-1.;
  //  const float leaf = -1.3247179;//5724474;
    const float eConstant = 2.71828182;
                                                        
    float lerp(float a) {return -abs(mod(a,2.)-1.);}
    float lerp2(float a) {return -abs(mod(a,4.)-2.)+1.;}

    float zin(float x){return -sin(x);}
    float coz(float x){return -cos(x);}
    float rnd(float x){return sign(x)*floor(abs(x)+.5);}
    
    //The below hsv2rgb function is:
    // The MIT License
    // Copyright  2014 Inigo Quilez
    vec3 hsv2rgb( vec3 c )//https://www.shadertoy.com/view/lsS3Wc
    {
        vec3 rgb = clamp( abs(mod(c.x*6.0+vec3(0.0,4.0,2.0),6.0)-3.0)-1.0, 0.0, 1.0 );
        return c.z * mix( vec3(1.0), rgb, c.y);
    }
    
    vec2 spin2(vec2 f, float t)
    {    //https://en.wikipedia.org/wiki/Rotation_matrix
        float angle =t;
        float fxb=f.x;
        f.x=-f.x*coz(-angle)-f.y*zin(-angle);
     f.y=fxb*zin(-angle)-f.y*coz(-angle);
     return f;
    }
                                                        const float chevronCount = 18.;

vec4 oppositeOfPitchMarker (vec2 r){//pitch pointer
    float angle =  atan(r.y,r.x)-atan(d.x,d.y);
    vec4 ret = vec4(0.);
    float angleAsOne = angle*divideByMultiplyingPi2;
    float wedge = (mod(angleAsOne+2.+.5,1.)-.5)*12.;
    float dist = length(r);
    if( abs(wedge)< 7./24.&&dist-.5/chevronCount<.5
    && mod(dist*chevronCount+abs(wedge)*2.,1.)<.5)
        ret =  vec4(hsv2rgb(vec3(mod((atan(-d.x,d.y)*flipStar+twistStar)/PI2*12.*brelued+4.,12.)/12.,1.,1.)),1.);
    else if(MannyONtrail==0&&abs(mod(angleAsOne+2.,1.)-.5)*12.<1./12.)
        ret =vec4(vec3(.5),1.);

    return vec4(ret);
}

                                                        
                                                        
                                                        
                    
                         
vec3 paddles(vec2 vUvCentered){
       float shade = 0.;
                   vec3 ret = vec3(0.);

       if(abs(vUvCentered.x)>.47)
       {
                         float incrementSize = 1./12.;
                         float staff =mod(vUv.y*12.+.5+12.,1.)-.5;
           if ( abs(staff)<=incrementSize)
           ret =hsv2rgb( vec3(mod((-vUv.y+(6.-2.*brelued*flipStar)/12.+twistStar*divideByMultiplyingPi2)*flipStar*brelued+1.,1.) ,1.,1. )); //vec4(mod(note,12.)/12.);
           else if ( abs(staff)<=incrementSize*2.)shade=.25;//(vUvCentered.x/2.-1.25);
           


           else if(mod(vUv.y-mod(noteFrozen/12.*flipStar+twistStar*divideByMultiplyingPi2,1.)+1.+1./12.,1.)<=2./12.)shade= sign(-vUvCentered.x)*170.*flipStar*brelued;
           
           }
       if(ret.x==0.&&ret.y==0.&&ret.z==0.)ret+=shade;
       return ret;
   }
                   
    vec3 ball(vec2 p){
        vec3 ret = vec3(0.);
    if (length(pongBallCoords-vUv*resolution)<length(resolution.y)/12.)
        if (vUv.x>.5)ret= vec3(10.);
        else ret= vec3(-10.);
    else ret=vec3(0.);
    return ret;
    }
   vec4 waveForm(){
       vec4 ret=vec4(0.);//1.,.5,1.,1.);
       if((1.-vUv.y)<.25){
           
          // vec2 flatScreen=1.-vUv;
          // flatScreen*=2.;
    float frAmp = texture2D(audioBuffer, vec2(pow(abs(.5-vUv.x)*4.,2.)/4.,0.)).r;
    //if(volume>zoomOutRatchetThreshold)
    frAmp/=maxSamp*2.;
   // float frAmp = texture2D(audioBuffer, vec2(pow(abs(.5-vUv.x)*2.,2.)/2./
                                            //  pow(2.,(note)/12.+4.)*440. ,0.)).r;//adjusted to pitch

   if (log(abs(frAmp)*(1./(1.-vUv.y))*(resolution.x/max(
                                                     resolution.x,resolution.y)))>1.) ret = vec4(sign(frAmp));
   
   }
               //           else ret=vec4(1.);
       
    return ret;
    }
                                                        float linearEQsize = 1./4.;
    vec4 linearFrequencyEQ(vec2 h)
                {
                vec4 ret=vec4(0.);//1.,.5,1.,1.);
                
                if(h.x<linearEQsize){
                    
                // vec2 flatScreen=1.-vUv;
                // flatScreen*=2.;
                float frAmp = texture2D(micIn, vec2(h.y,0.)).r*linearEQsize;
                // float frAmp = texture2D(audioBuffer, vec2(pow(abs(.5-vUv.x)*2.,2.)/2./
                //  pow(2.,(note)/12.+4.)*440. ,0.)).r;//adjusted to pitch
                 if (frAmp>h.x)
                 {
                     
               float freq =h.y*sampleRate;
             float noteLine =12.*log(freq/concertKeyTuning)/log2+49.;
                            //     if(mod(rnd(noteLine),12.)==6.)
                                     {
              if (frAmp>h.x*1.5)  ret = vec4(hsv2rgb( vec3( mod((-noteLine)*brelued+4.,12.)/12. ,1.,1. )),0.); //vec4(mod(note,12.)/12.);
                    else if(frAmp>h.x) ret =vec4(sign(vUv.x-.5)*20.*flipStar*brelued);
                    }
}
                }
                //           else ret=vec4(1.);

                return ret;
              }
    vec4 audioEq( vec2 uv )//Shekina Glory
    {

        uv=uv.yx*1./2.;
        float angle = ((-atan(uv.y,uv.x)*flipStar-twistStar                    -PI+PIdiv2*flipStar)*divideByMultiplyingPi2
);
                        //angle=mod(angle,1.);
                        
        float frAmp=0.;
        //return vec4(angle);
     //   const float octBoost = 17.;
      //  float b =nyq*pow(2.,angle+octBoost);
//starts -3, full -2
float brightness=0.;
/*
        for (float n = -1.; n<11.;n+=1.)//the range seems small
       // if(b>=.5/nyq&&b<sampleRate/2.)
//not sure why it has negative range
        //if (twistStar<24.)
         {
              float b =1./sampleRate*pow(2.,angle+n)*concertKeyTuning;//440hz down one note is 415.305
              if(b<1.){
              float frampBuffer = texture2D(micIn, vec2(b,0.)).r;
               //if(rnd(angle*12.)==1.)
              //if(mod(rnd(angle*12.),12.)==1.)
             frAmp += frampBuffer;
              //  brightness=10.;

       // if(rnd(mod(angle*12.,12.))==1.)
        if(n<=10.&&n>=0.)brightness +=(n+1.)*frampBuffer;
}
        }
        */
         brightness/=8.;
         brightness=.9;
                             //  if(mod(angle+10.,1.)<1./12.)  
                         //     if(rnd(mod(angle+10.,1.)*12.)==1.) 
                          frAmp = texture2D(radialFrequenciesSummed, vec2(mod(angle+10.-1./12.,1.),0.)).r;

         //  frAmp/=255.;
         frAmp/=2.;
       //    frAmp=pow(frAmp,.888);
        float d = length( uv);
        float frampDIVlend = frAmp/d;
        frampDIVlend*=frampDIVlend;
        float frampMultlen = frAmp*d;
        frampMultlen*=frampMultlen;

       // frampMultlen*=frampMultlen;
       //
     //  if(brelued==-1.)angle=(-angle);
     
       if(brelued==-1.)angle = (atan(uv.y,uv.x)+PIdiv2+twistStar)*divideByMultiplyingPi2;
       
       
       
       vec4 ret =vec4(0.);
       
         if (
             (frampDIVlend>.5|| frampMultlen>.25)
             &&(frampDIVlend<1.||(frampDIVlend>2.
                                   &&frampDIVlend<4.||(frampDIVlend>8.
                                      &&frampDIVlend<16.||(frampDIVlend>32.
                                         &&frampDIVlend<64.||(frampDIVlend>128.
                                         )))))
                || (frampMultlen>.5&&frampMultlen<.75)
            )
        ret=  vec4(clamp(hsv2rgb(
                                      vec3(
                                           mod((-angle+4./12.)//+3.-flipStar/12.
                                               ,1.),.75,1.
                                           ))
                              ,.0,1.)/pow(2.,d)
                   *brightness*(brightness)
                   , 1.);
        else ret= vec4(.0);
        return ret;
    }



    float starnSize = PI/120.*2.*7./8.*2.;
    
    float scalar =1./2.*3./4.;

    vec4 starns ( vec2 uv//,float noteOfStar
    )//Seven stars, two witnesses
    {
       float noteOfStar = mod(rnd((atan(uv.y,uv.x)-twistStar*flipStar+PI2*4.)/PI2*12.*flipStar+12.*12.+6.),12.);
     //  if(noteOfStar!=1.)noteOfStar=11.;
      //  float nyq =  fftSize/sampleRate/2.;
        
        //uv=vec2(-uv.x,uv.y);
      //  float octaveSpin = 5./12.;
    
        float angle1 =(noteOfStar/12.*PI2+twistStar+PI)*flipStar; //mod((noteOfStar/12.*PI2+twistStar+PI+PI2)*flipStar,PI2);//this is for the position from centerVV;
        uv.x += coz(angle1)*scalar;
       uv.y += zin(angle1)*scalar;//^^
       uv=spin2(uv,-angle1+PIdiv2
                );
       vec4 ret = vec4(0.);
       if(length(uv)<starnSize){
       //uv *=    26.5;
   // return vec4(angle1*divideByMultiplyingPi2+.5  );
            float angle =witnessFlip*atan(uv.x,uv.y);// mod(atan(uv.x,uv.y)+PI2,PI2);//
          //       if(angle<0.)angle = PI-angle;
          //  angle += (PI2*(noteOfStar
//this value is uncertain
               //           )/12. );
               
        angle /= PI2;
        angle = angle+.5;
       //  angle = mod(angle+1.,1.);
      //   return vec4(uv*10.,
        //             vec3(angle)
      //            length(uv)
      //               ,1.);
      float angleExpanded10 = (angle*10.);
        float oct =floor(
          angleExpanded10-6.
        );
        ;
        float noteBend = angleExpanded10-floor(angleExpanded10)+.5;//angle*10.-floor(angle*10.-.5)-.5; seems to be the least overflow between notes, thereby seems correct
        float note0 = (-oct+(noteOfStar-noteBend)/12.);
      //  return vec4(note0/72.);
       // return vec4(note0/144.);
     //  note0-=1.;
        float note1 =1./sampleRate*pow(2.,note0)*concertKeyTuning;

        float noteAmp = texture2D(micIn,
        vec2(note1
        ,0.)).r;
                      // if(floor(oct)!=2.)noteAmp=0.;
                   //  if(rnd(mod(note0*12.+12.*12.,12.))!=1.)noteAmp*=0.;
                       noteAmp*=12.;
                       // if(rnd(mod(note0*12.,12.))==0.)noteAmp=100.;//incomplete testing and
                       // else noteAmp=0.;
                       
       // noteAmp=pow(noteAmp,.5);
       // noteAmp/=255.;
      // return vec4(noteAmp);
        float d = length( uv);///16.;
        //fr=(fr)*(fr)/3.;
      //  float power = 5.;
      // float b = pow(noteAmp,power)/pow(d*6.,power*.5);
        float rote = -0.;
        float noteAmpToLength=noteAmp/d;
       float noteAmpByLength = noteAmp*d;
       // if(noteOfStar==0.)return vec4(1.);
       // else return vec4(0.);
       //return vec4(noteAmpToLength);
    
            if
                       ((noteAmpToLength>.5|| noteAmpByLength>.25)
                          &&(noteAmpToLength<1.||(noteAmpToLength>2.
                                                &&noteAmpToLength<4.||(noteAmpToLength>8.
                                                   &&noteAmpToLength<16.||(noteAmpToLength>32.
                                                      &&noteAmpToLength<64.||(noteAmpToLength>128.
                                                      )))))
                             || (noteAmpByLength>.5)
                         )
               
              {
                  /*
           if(noteOfStar==mod(0. +rote,12.))
           ret=vec4(clamp(
                           noteAmpToLength
                    ,0.,1.)*.25
                    );
                    else if(      noteOfStar==mod(6. +rote,12.))
                    ret=vec4(.25
                             );
                   */
               if(
                  noteOfStar==mod(0. +rote,12.)||
              noteOfStar==mod(2. +rote,12.) ||
              noteOfStar==mod(5.  +rote,12.)||
              noteOfStar== mod(7. +rote,12.)||
              noteOfStar== mod(10. +rote,12.))
              {
               ret=vec4(clamp(
                                                        noteAmpToLength
                                                 ,0.,1.)
                                                 )*.125;
            }
              else if   ( noteOfStar==mod(6. +rote-rnd(twistStar/PI2*12.),12.))
              ret=vec4(vec3(clamp(
                                                       noteAmpToLength
                                                ,0.,1.)*.25
                                                ),1.);
        else{
            
                        // if(colorCombo==100)ret=vec4(-15./255.);
                        // else
ret= vec4(clamp(
                noteAmpToLength
            ,0. ,1.)*.75
       );
           }
           }
}
        return ret;
    }

                       vec3 heart(vec2 g, vec2 t){
                           g/=gr+1.;
                          // g.x-=.5;
                           t.y*=-1.;
                            g.y*=-1.;
                           vec2 z=g.xy;
                           
                       vec3 h=vec3(0.);
                       const float iterations = 70.;
                           for (float f=0.;f<iterations;f++)if(abs(z.y+z.x)>2.){h=vec3(0.);break;}
                           else {z=vec2(((z.x*z.x-z.y*z.y)-g.x-t.x),(2.0*z.x*z.y-g.y-t.y));//mandelbrot loop factored into real and imaginary components from z<=z^2-g


                           float timesForBottom =1.;
                       if(g.x>.75)     timesForBottom=2.;

                         /*  h+=vec3(
                                  (24.*z.x*z.y)-5.*z.x*timesForBottom,
                                   3.5*(z.x+abs(z.y)*timesForBottom),
                                  (z.y+1.75*abs(z.x)))
                           /length(z)/iterations*.5;//*(1.-length(g));*/
                         h+=vec3(
                                     (6.*z.x*z.y)-2.*z.x*timesForBottom,
                                      3.*(z.x+abs(z.y)),
                                      z.y*timesForBottom+abs(z.x))
                               *(1./length(z))
                              /iterations*twoThirds*timesForBottom;//*(1.-length(g));
                              
                           }
                       return h;
                       }
                                     const    float logStabilizationConstant = 1./log(3.)+(1.-1./log(3.))/2.;

                       
                                                      vec4 gatesOfHeaven( vec2 uv, float noteskew )//Shekina Glory
                                                      {
                                              vec4 o=vec4(0.);

if(uv.x<1./3.&&maxSamp!=0.) //could 1./3. but then the spill over (if any) isn't visible
{
                                                         // uv=uv.yx;
                                                          float sideSegment = mod(mod(3.-uv.y*3.,3.)+noteskew+12.*12.,12.);
                                                
                                                                          //angle=mod(angle,1.);
                                                                          
                                                          float frAmp=0.;
                                                          //return vec4(angle);
                                                       //   const float octBoost = 17.;
                                                        //  float b =nyq*pow(2.,angle+octBoost);
                                                  //starts -3, full -2
                                                  //float brightness=0.;
                                                  float noteOfSide = (sideSegment-2.+.5)/12.+twistStar*flipStar*divideByMultiplyingPi2;
                                                  float notesIncludedInPixel = 0.;
                                                 /*  for (float n = -1.; n<11.;n+=1.)//the range seems small
                                                         // if(b>=.5/nyq&&b<sampleRate/2.)
                                                  //not sure why it has negative range
                                                          //if (twistStar<24.)
                                                           {
                                                                float b =1./sampleRate*pow(2.,noteOfSide+n)*concertKeyTuning;//this seems to be missing a 440, also missing in other pixelStar calculations
                                                                float frampBuffer = texture2D(micIn, vec2(b,0.)).r;
                                                    // if(mod(rnd((noteOfSide)*12.),12.)==1.)
                                                     
                                                         frAmp += frampBuffer;
                                                                  notesIncludedInPixel++;
                                                                  
                                                                 // brightness +=(n+3.+1.)*frampBuffer;
                                                                 
                                                          }*/
                                                                      //    if(rnd(mod(noteOfSide,1.)*12.)==1.)   
                                                                            frAmp = texture2D(radialFrequenciesSummed, vec2(mod(noteOfSide+10.-1./12.,1.),0.)).r;

                                                //        frAmp-=minSamp;
                                              //  frAmp/=notesIncludedInPixel;
                                         //  frAmp/=255.;
                                         
                                         // frAmp*=2.;
                                          frAmp/=32.*min(resolution.x,resolution.y)/max(resolution.x,resolution.y     );
 //if(maxSamp!=0.) frAmp/=(maxSamp);//-minSamp);
float threshSide = 1.-(frAmp)//pow(frAmp,1.75)/1.75
*((1.-
  uv.x*3.))*min(resolution.x,resolution.y)/max(resolution.y,resolution.x);//the corners don't seem to match on adjacent sides
/*
if(min(resolution.x,resolution.y)==resolution.x)threshSide=uv.x;
else threshSide=uv.x;
 */
  
                                                         //  brightness/=10.;
                                                     //    if(rnd(mod(noteOfSide+12.*12.,12.))==-3.)
             
                                                                if(threshSide>1./log(3.))           o=vec4(1.);
                                                                if(threshSide>logStabilizationConstant)
                                                                                                     o=vec4(.5);
                                                       
                                                      float sideSegmentMediated = mod(noteOfSide*12.+12.*12.+.5,12.)-.5;
                                                      
                                                      // if(abs(sideSegmentMediated-1.)<.5)o*=-1.;
                                                      // else if(abs(sideSegmentMediated-11.)<.5)o*=-1.;
                                                      // else
                                                       if(abs(sideSegmentMediated-0.)<.5)o*=-1.;
                                                       else if(abs(sideSegmentMediated-2.)<.5)o*=-1.;
                                                       else if(abs(sideSegmentMediated-5.)<.5)o*=-1.;
                                                       else if(abs(sideSegmentMediated-7.)<.5)o*=-1.;
                                                       else if(abs(sideSegmentMediated-10.)<.5)o*=-1.;
                                                     //  if(mod(rnd(noteOfSide*12.)+12.*12.,12.)==0.)  return o;

}
                                                        return o;//vec4(0.);//o;//

                                                       
                                                         }
                                                      
    vec3 heartsRibs(vec2 g, vec2 t){
        g/=gr+1.;
        //g.x-=.5;
        g.y*=-1.;
        t.y*=-1.;
        vec2 z=g.xy;
    vec3 h=vec3(0.);
    const float iterations = 40.;
        for (float f=0.;f<iterations;f++)if(abs(z.y+z.x)>2.){h=vec3(0.);break;}
        else {z=vec2(((z.x*z.x-z.y*z.y)-g.x+t.x),(2.0*z.x*z.y-g.y+t.y));//mandelbrot loop factored into real and imaginary components from z<=z^2-g
          h+=(vec3(z.x*z.y,(1.-z.y)/z.x,(1.-z.x)/z.y)
                                    )/length(z)/iterations;}
return h;
}
                  vec4 faceBlackAndWhite(vec2 g, vec2 t, bool wink, int overrideEyes, bool WayTruthLight, float noteOfEye){
                if(elderHorns==2&&(overrideEyes==100||overrideEyes==-1)){
                    float squareUp=4./3./log(3.);
                    g.y*=squareUp;
                    t.y*=squareUp;}
bool twelveLots = true;
bool A=false,Bf=false,C=false,D=false,E=false,Fs=false,G=false;
bool isB=false, isF=false;
                              t/=2.5;
                              //g/=4.;
                              int eyeType = 0;
                              if (overrideEyes==-1)eyeType=holyeyes;
                              else eyeType = overrideEyes;
                              if(eyeType==1) t.x*=-1.;
                              else if(eyeType==3)t*=-1.;
                              vec2 p = (vec2(g.x,g.y)-vec2(t.x,-t.y));//vec2(g.x,-g.y);

                              bool bfeye= false;
                              bool notEars= false;
                              float adjustedNote=0.;
                              if (noteOfEye<0.)
                              {
                              if (wink)adjustedNote = mod(note+twistStar*divideByMultiplyingPi2*12.,12.);
                              }
                              else{
                                float toDeShift=0.;
                                float reorient = 0.;
                                                           //         toDeShift=mod(note,1.);

                                if(major<=2)
                                {
                                   // toDeShift=mod(note,1.);
                                    reorient=6.-1.;
                                    }
                                //else if (major==3)
                              
                              
                              adjustedNote=mod(rnd(noteOfEye+toDeShift)+reorient+12.*100.,12.);
                    
                           //   if(mod(rnd(note)-adjustedNote,12.)!=0.)
                            //  adjustedNote=-1.;
                              
                              }
                              vec4 lowColor=vec4( hsv2rgb( vec3(mod((lownote+6.*brelued-2.)/12.+100.,1.) ,.5,1. )),.5);
                              vec4 pitchColor=vec4(1.);
                              if (volume!=1.)pitchColor=vec4( hsv2rgb( vec3(mod((-note*brelued-2.)/12.,1.) ,.5,1. )),.5);
                              
                        vec4 l = vec4(0.);
                        if(brelued<0.)p.y*=-1.;
                        if(flipStar<0.)p.y*=-1.;
                        float angleColorShift = 0.;
                        if(MannyONtrail>0)
                        angleColorShift=(-atan(d.x,d.y)*flipStar+PI);

                        
                        vec2 z=g.xy;
                        // if(g.x*g.x+g.y*g.y<40.)
                        //if(abs(g.y)<9.)
                        float isEscaped = 0.;
                        if(abs(g.y)<4.&&g.x<2.)for (int f=0;f<27;f+=1)if(abs(z.y)>17.7&&(f>3||f==1)){
                            if (f==1){l=vec4(0.);break;}

                            if(!wink){
                                    l= vec4(vec3(-1.*(z.y)*sign(g.y)),1.);
                                    isEscaped=-2.;//length(z)/40.;//clouds and face
                                    break;

                           }
                            
                            
                        }
                        else{
                            z=vec2(-1./(z.x*z.x-z.y*z.y-g.x+t.x),2.0*z.x*z.y-g.y-t.y);
                            
                           if(!wink&&
                              f==16&&z.x<0.)l=vec4(pitchColor.xyz*(1.-abs(z.y)*6.),.25);//smooths middle horn, removes some clouds
                               
                            vec2 s=z;//vec2(z.x,-z.y);
                            
                            if(f==7&&s.x<0.)notEars=true;
                            else if(wink);
                            else if((f==16)&&p.x>0.&&s.x<0.&&!notEars&&p.x<.35){l=lowColor;break;}
                            else if((f==17)&&p.x>0.&&s.x<0.&&!notEars&&p.x<.35){l = lowColor;break;}
                            else if((f==14)&&s.x<-1.){l=vec4(vec3(.5),.5);
                                                     break;}
                            /*should be restored?!
                            if( (f == 13||f==14)&&s.x<.0&&abs(p.y)>.68&&p.x>0.){l=vec4(vec3(.5),1.);break;}
                            else if(f<=15&&z.x>-.1){
                                l=vec4(vec3(-z.x),1.);
                               // if( f == 15&&z.x>-.10&&abs(p.y)>.75){l=vec4(vec3(z.x),.5);break;}
                            }
                             */
                            if(eyeType==0&&!wink);
                            else if(eyeType==2&&!wink)
                            {
                              if (f==17&&s.x<0.&&p.x>0.){
                                  l=vec4(.5);
                                  break;
                                    }
                                else if (eyeType==2&&f==19&&abs(p.y)<1.&&s.x>-.1&&abs(s.y*s.y/s.x)>144.){
                                    l=vec4(.5);
                                    break;
                                    }
                              
                                  }
                            if((eyeType==0||eyeType==2)&&!wink);

                    else   if((twistStar == 0.||wink)&&s.x<0.){
                                    float eyeColorCycler = 0.;
                                    float eyeColorCyclerReversed = 0.;

                           if (eyeType==1)
                           {eyeColorCycler=1.;
                               eyeColorCyclerReversed=1.;
                               }


                               if (f==12 &&p.x<.0){
                               bfeye=true;
                           }
                         // else if(true);
                         else if(f>=20&&abs(p.x)<.5){
                             float winkWhite = -1.;
                             if(!C&&!D&&p.x>0.&&p.y<0.){
                             if(wink&&rnd(adjustedNote)==5.)
                                l=vec4(vec3(winkWhite),0.);

                             else if(!wink)
                             if (holyeyes==1)
                             l=vec4(eyeColorCyclerReversed/2.+.5,1.-eyeColorCyclerReversed, eyeColorCyclerReversed/2.,.75);
                                else if (holyeyes==3)
                                 l=vec4( eyeColorCyclerReversed/2.,1.-eyeColorCyclerReversed,eyeColorCyclerReversed/2.+.5,.75);

                             break;
                             
                             }
                             else if (!E&&!D&&p.x>0.&&p.y>0.)
                             {
                                 if(wink&&rnd(adjustedNote)==7.)
                                       l=vec4(vec3(winkWhite),0.);
                                       else if(!wink)
                                       
  if (holyeyes==3)
                             l=vec4(eyeColorCyclerReversed/2.+.5,1.-eyeColorCyclerReversed, eyeColorCyclerReversed/2.,.75);
                                else if (holyeyes==1)
                                 l=vec4( eyeColorCyclerReversed/2.,1.-eyeColorCyclerReversed,eyeColorCyclerReversed/2.+.5,.75);
                                 break;
                                 }
                             else if(!G&&!A&&abs(p.x)>abs(p.y)&&p.x<0.){
                                 
                                        if(wink&&(rnd(adjustedNote)==12.||rnd(adjustedNote)==0.))
                                           l=vec4(vec3(winkWhite),0.);
                                        else if(!wink)
                              l = vec4( 1.-eyeColorCyclerReversed,eyeColorCyclerReversed,1.-eyeColorCyclerReversed,.75);
                             break;
                             }
                             else if(!A&&!Bf&&(abs(p.x)<abs(p.y)&&p.x<0.&&p.y>0.||((isB&&!wink)||(isF&&wink)))){
                                 
                                        if(wink&&rnd(adjustedNote)==9.)
                                           l=vec4(vec3(winkWhite),0.);
                                        else if(!wink)
                                        l = vec4(1.-eyeColorCyclerReversed,.5, eyeColorCyclerReversed,.75);
                                 break;
                                 }
                             
                             else if(!G&&!Fs&&(abs(p.x)<abs(p.y)&&p.x<0.&&p.y<0.||((isF&&!wink)||(isB&&wink)))){
                                 
                                 if(wink&&rnd(adjustedNote)==3.)
                                           l=vec4(vec3(winkWhite),0.);
                                        else if(!wink)
                                        l = vec4(eyeColorCyclerReversed,.5, 1.-eyeColorCyclerReversed,.75);
                                 break;
                                 }




                             }
                               else if (f==16 &&p.x<.35){
                                if (p.x>.0) {
                          
                                    if(p.y<0.)
                                    {
                                        if(wink)
                                        {
                                           if( rnd(adjustedNote)==4.||(!WayTruthLight&&(floor(adjustedNote)==4.||ceil(adjustedNote)==4.)))
                                           {
                                           l=vec4(vec3(1.),0.);
                                           }
                                           }
                                        else l = vec4( 1.-eyeColorCycler,eyeColorCycler,eyeColorCycler,.5);
                                    }
                                    else
                                    {
                                        if(wink)
                                        {                                           if(rnd(adjustedNote)==8.||(!WayTruthLight&&(
                                            ceil(adjustedNote)==8.||floor(adjustedNote)==8.)))
                                            {
                                            l=vec4(vec3(1.),0.);
                                            }
                                            }
                                       else l = vec4( eyeColorCycler,eyeColorCycler,1.-eyeColorCycler,.5);
                                    }
                                    break;
                                }
                                else if(p.x>-.3){
                                    //squircle eyes orange and steel blue
                                    if(p.y<0.)
                                    {
                                        if(s.x>-.1){
                                        if(wink)
                                        {            if((!WayTruthLight&&ceil(adjustedNote)==3.)||rnd(adjustedNote)==2.)

                                            l=vec4(vec3(1.),0.);
                                            break;

                                            }
                                       else
                                       {
                                           l = vec4( 1.-eyeColorCycler,.5,eyeColorCycler,.5);                                        break;
                                        }
                                       Bf=true;
                                       }
                                        else isB=true;

                                       }
                                    else {
                                        if(s.x>-.1){
                                        if(wink)
                                        {           if((!WayTruthLight&&floor(adjustedNote)==9.)||rnd(adjustedNote)==10.)

                                            l=vec4(vec3(1.),0.);
                                            break;

                                            }
                                        else
                                        l = vec4( eyeColorCycler,.5,1.-eyeColorCycler,.5);                                        break;
                                        Fs=true;
                                        }
                                        else isF=true;

                                }
}
                            }
                            
                      else if (f==17 &&p.x>.0&&p.x<.5&&s.x>-.2){
                        float noseIncludesCheeks = 1.;
                        if(!WayTruthLight)noseIncludesCheeks=1.5;
                          if(wink)
                          {                                           if(abs(p.y)<p.x&&rnd(abs(adjustedNote-6.)/noseIncludesCheeks)==0.)                                            l=vec4(vec3(1.),0.);
                              }
                          else

                          l = vec4( 1.-eyeColorCycler,eyeColorCycler,1.-eyeColorCycler,.5);//green nose
                          break;
                      }
                      else if ((f==15)&&p.x>-.3&&p.x<0.&&s.x<-5.)
                      {

                          if(bfeye||wink)
                                {
                                    //diagonal diamond eyes
                                    if(wink)
                                    {
                                        if(p.y>0.){
                                         if(rnd(adjustedNote)==11.||(!WayTruthLight&&floor(adjustedNote)==11.))                                            l=vec4(vec3(1.),0.);
                                         }
                                        else  {  if(rnd(adjustedNote)==1.||(!WayTruthLight&&ceil(adjustedNote)==1.))  l=vec4(vec3(1.),0.);}

                                         
                                    }
                                    else if(!wink){
                          if(p.y*(.5-eyeColorCycler)>0.)
                          l=vec4( eyeColorCycler/2.,1.-eyeColorCycler,eyeColorCycler/2.+.5,.5);
                      else l=vec4(eyeColorCycler/2.+.5,1.-eyeColorCycler, eyeColorCycler/2.,.5);
                      }
                                }
                          else {
                              //opening side eyes

                                    if(p.y>0.)l = vec4( 1.-eyeColorCycler,.5,eyeColorCycler,.5);
                                    else l = vec4( eyeColorCycler,.5,1.-eyeColorCycler,.5);
                          }
                      break;
                      }
                                
                                
                                
                                
                      
                        }
                            //eyesopposite
                      else if((eyeType==1||eyeType==3)&&s.x<0.)
                      {
                           float eyeColorCycler = -3./12.+(twistStar+angleColorShift)*divideByMultiplyingPi2*brelued+10.;
                               if (eyeType==3)eyeColorCycler+=.5;

                               if (f==12 &&p.x<.0){
                               bfeye=true;
                           }
                         // else if(true);
                               else if (f==16 &&p.x<.35){
                                if (p.x>.0) {
                                    if(p.y<0.)l = vec4( hsv2rgb( vec3(mod(9./12.+eyeColorCycler,1.) ,.5,1. )),.5);
                                    else l = vec4( hsv2rgb( vec3(mod(5./12.+eyeColorCycler,1.) ,.5,1. )),.5);
                                }
                                else if(p.x>-.3){
                                    //squircle eyes orange and steel blue
                                    if(p.y>0.)l = vec4( hsv2rgb( vec3(mod(4./12.+eyeColorCycler,1.) ,.5,1. )),.5);
                                    else l = vec4( hsv2rgb( vec3(mod(10./12.+eyeColorCycler,1.) ,.5,1. )),.5);
                                
                                }
                                break;
                            }
                      else if (f==17 &&p.x>.0&&p.x<.5&&s.x>-.2){
                          l = vec4( hsv2rgb( vec3(mod(7./12.+eyeColorCycler,1.) ,.5,1. )),.5);//green nose
                          break;
                      }
                      else if ((f==15)&&p.x>-.3&&p.x<0.)
                      {

                                    if(bfeye)
                                {
                                    //diagonal diamond eyes

                          if(p.y>0.)l=vec4( hsv2rgb( vec3(mod(2./12.+eyeColorCycler,1.) ,.5,1. )),.5);
                      else l=vec4( hsv2rgb( vec3(mod(0./12.+eyeColorCycler,1.) ,.5,1. )),.5);
                                }
                          else {
                              //opening side eyes

                                    if(p.y<0.)l = vec4( hsv2rgb( vec3(mod(4./12.+eyeColorCycler,1.) ,.5,1. )),.5);
                                    else l = vec4( hsv2rgb( vec3(mod(10./12.+eyeColorCycler,1.) ,.5,1. )),.5);
                          }
                      break;
                      }
                      }
                      
                            
                        }
                        if((l.r<.0||l.g<0.||l.b<0.)&&isEscaped!=-2.&&!wink)l=vec4(0.);
                            if(g.y==0.&&t.y==0.&&!wink)
                            {if(g.x<0.)
                            l=vec4(-2.);
                            else l = vec4(2.);
                            }
                           vec4 ret = vec4(0.);
                          if(l.w==1.||l.w==.25)
                        ret= -l;
                        else if(l.w==.5||l.w==.75)ret= l;
                        else ret= l;
                        return ret;
                        }




      vec3 face(vec2 g, vec2 t){
            t/=2.5;

            
      float l = 1.;
      vec2 z=g.xy;
      // if(g.x*g.x+g.y*g.y<40.)
      if(abs(g.y)<9.)
      for (int f=0;f<21;f+=1)if(abs(z.y)>17.7&&(f==1||f>3)){
          if (f==1){l=1.;break;}
          l=length(z)/40.;//clouds and face
          break;}
      else{
          z=vec2(-1./(z.x*z.x-z.y*z.y-g.x-t.x),2.0*z.x*z.y-g.y-t.y);//this used to be +t.x\-t.y and other code may use those values, I think -t.x\-t.y works well with opposite rainbow eye colors
          l=abs(z.y)*6.;//smooths middle horn, removes some clouds
          if(z.x>-.1)l=z.x*100.;}//face with closed small holes
      return vec3(1.-l);
      }
    
      vec3 clouds(vec2 g, vec2 t){
            t/=2.5;
      float d = 0., negator = 1.;
      vec2 z=g.xy;
      //if(g.x*g.x+g.y*g.y<40.)
      if(abs(z.y)<17.7)
          z=vec2(-1./(z.x*z.x-z.y*z.y+g.x),2.0*z.x*z.y-g.y);
      if(abs(z.y)>17.7) {
         // z=vec2((z.x*z.x-z.y*z.y-g.x),2.0*z.x*z.y-g.y);
          d=length(z)*441.144;
          }
      else negator = 0.;
     return vec3(-sin(d +time*3.+PI2/3.),-sin(d+time*3.+PI2*twoThirds),-sin(d+time*3.))*negator;

      }

 vec3 shiny(vec2 p,vec2 t){
            t/=2.5;

     vec2 s = p;
     
     float l=0., d = 0., negator = 1.;
         for (int f=0;f<21;f+=1)
         if(abs(s.y)>17.7&&(f==1||f>2)){
             l=1.-length(s)/40.;
             if (f == 1)
                     negator=0.;
             else
                     d+=length(s)/10.;
             break;
         }
         else{
             s=vec2(-1./(s.x*s.x-s.y*s.y-p.x+t.x), 2.0*s.x*s.y-p.y-t.y);
             l=abs(s.y)*3.5;//refines middle horn, optional
             if(s.x>-.1)l=s.x*50.;//closes small holes
             d+=length(s)/10.;
         }
         if (l>.54) negator = 0.;
         return vec3(-sin(d *3.+PI2/3.+time2dance),-sin(d*3.+PI2*5./3.+time2dance),-sin(d*3.+time2dance))*5.*negator;
 }

    
vec3 faceHeights(vec2 g, vec2 t){
           // t/=gr;
vec2 n=vec2(0.);
//n=spin2(vec2(1.,0.),mod(atan(d.y,d.x)+1000.*PI2,PI2));
//if(clvrVariant4==0.)n= coords.yx/2.;
//else if(clvrVariant9)n= coords.yx*1.5;

float l = 1.;
g*=4.;
g=g.xy;
vec2 z=g;
float coreSlide = 1.;
float coreShift=1.;


           if(clvrVariant8){
            coreSlide = abs(coords.x);
            coreShift = .5;
g.y*=coreSlide;
}
//g.x*=coords.y;

float corebase = log(zoom/coreSlide)/log(.3247)*coreShift+coreShift;

           if(clvrVariant9)
           {z.x= -1./(z.x);
            corebase*=abs(z.x)/4.;
           }

int core = 9+6*int(corebase);
for (int f=0;f<102;f+=1)
if(f==core//&&zoom!=1.
)break;
else if(abs(z.y)>17.7&&(f==1||f>3)){
    //if (f==1){l=0.;break;}
    l=1.-length(z)/40.;//clouds and face
    break;}
else{
    z=vec2(-1./(z.x*z.x-z.y*z.y-g.x-t.x/3.-n.x),2.0*z.x*z.y-g.y+t.y/3.+n.y);//also try without coords for more classical
    if(!clvrVariant8) l=abs(z.y)*5.;//smooths middle horn, removes some clouds
    if(z.x>-.1)l=z.x*50.;}//face with closed small holes
return vec3(clamp(1.-l,0.,1.));
}
    
vec3 faceFORWARD(vec2 p,vec2 t){
    //t*=2.;
    t=vec2(3.*t.x,2.*(t.y));
    vec2 s=p;
        float l=0.;
        for (int f=0;f<3+6*52;f+=1)
            if( ((f<3+6*int(log(zoom)/log(.3247))&&musicAngelMan==0)||(musicAngelMan>0&&f<3)))//turn f<15 or f<21 for alternative just seven eyedfullness
                s=vec2(-1./(s.x*s.x-s.y*s.y-p.x+t.x), 2.0*s.x*s.y-p.y-t.y);//this is {s=s^2-p;s.real=-1./s.real}
            else break;
               
        float centralPowerInverter=(s.x/s.y)*sign(s.x)*sign(s.y);
            //I was studying this function without the face and a power short ocurred and on firefox window restore and caused a semi-reversion hybridization
            if(Character==3||musicAngelMan==1)centralPowerInverter*=.5;
            else if(Character==4||musicAngelMan==2)centralPowerInverter+=s.x;//-abs(s.x);
        l=
            centralPowerInverter;

            if(musicAngelMan>0){
                if((Character==3||musicAngelMan==1)&&l<.01)l=1.;
                else if((Character==4||musicAngelMan==2)&&abs(l)<abs(p.x)*abs(p.y)/15.)l=0.;
                }
            else
            {
                    if(Character==3&&l<.04)l=1.;
                    else if(Character==4&&l< .16)l=0.;
            }
            vec3 ret = vec3(0.);
            if (l>1.)l=1.;
            if(abs(p.y/p.x)*sign(p.x)>-2.2&&p.x<0.&&p.x>-1.&&l<.50&&l>0.)l=0.;//remove black from behind mny's squircle eyes (removed due to causing a wing to be cut in two on some androids, also seems more consistent between the eyes
               if((Character==3||musicAngelMan==1))
               {
                   if(p.y==0.&&p.x>0.&&t.y==0.)l=0.;
                   ret=vec3(1.-l);
               }
               else if((Character==4||musicAngelMan==2))
               {
                   if(p.y==0.&&p.x>0.&&t.y==0.)l=0.;
                   ret=vec3(l);
               }
         return ret;//return red if run in  error
    }
    vec3 faceFORWARDstatic(vec2 p,vec2 t){
        if(musicAngelMan==0)
        {t.y*=-.5;
            t/=1.;}
        vec2 s=p;
        vec3 rainbowManny =vec3(0.);
            float l=0.;
            for (int f=0;f<3+6*2;f+=1)if(musicAngelMan==0||f<3)
            { if(f==10&&mod(float(holyeyes),2.)==0.)rainbowManny=vec3(
                                         (abs(s.x)*(-s.y)*5.),
                                         (s.x*abs(s.y)),//toggle sign on green for reverse colors
                                       abs(s.x)*6.+7.*s.x*s.y-s.x*8.88)/-length(s)
                                   ;
        
                s=vec2(-1./(s.x*s.x-s.y*s.y-p.x+t.x), 2.0*s.x*s.y-p.y-t.y*2.);//this is {s=s^2-p;s.real=-1./s.real}
                }
                           else break;
            float centralPowerInverter=0.;
                //I was studying this function without the face and a power short ocurred and the firefox window restored and caused a semi-reversion hybridization
                
                if(Character==3||musicAngelMan==1)
                {
                    centralPowerInverter=(pow(abs(s.x),1.25)/s.y)*sign(s.y);
                     centralPowerInverter*=.5;
                     }
                else if(Character==4&&musicAngelMan!=2){
                    centralPowerInverter=(pow(abs(s.x),.7)/s.y)*sign(s.y);

                centralPowerInverter+=s.x*2.;}
                    else if(musicAngelMan==2) {
                        centralPowerInverter=(pow(abs(s.x),.7)/s.y)*sign(s.y);
                        centralPowerInverter+=s.x;

                    }

            l=
                centralPowerInverter;
                //l*=l*l;
                
                    if((Character==3||musicAngelMan==1)&&l<.01)l=1.;
                    else if((Character==4||musicAngelMan==2)&&l<abs(p.x)*abs(p.y)/15.)l=0.;
                    
                if (l>1.)l=1.;
                vec3 ret = vec3(0.);
                   if((Character==3||musicAngelMan==1))
                   {
                       if(p.y==0.&&t.y==0.)l=0.;
                       ret= 1.-l+rainbowManny;
                   }
                   else if((Character==4||musicAngelMan==2))
                   {
                       if(p.y==0.&&t.y==0.)l=1.;
                       ret= l+rainbowManny;
                   }
            return ret;
        }


                vec2 freed(vec2 p){
                    if(free){
                        float shift = 3.;
                        p+=shift/2.;
                        p=(mod(abs(p),shift));
                        p-=shift/2.;
                    }
                    return p;
                    }
vec2 spinningArms(vec2 g, vec2 t, float angle,float amp, bool HandOfGod, float finger1 ,float finger2,float finger3 ,float finger4 ,float finger5 ,float finger6,float finger7,float finger8,float finger9 ,float finger10){
t*=0.;//should be conditionallized
            float b = (0.);

float arm = 0.;
              vec2 elbow =vec2(-.5,1.)*1.25;
                    float angleOffset1=0.,angleOffset2=0., angleDirection=1.;

                    if(armsSpinning==0){
                        //t=vec2(0.);
                        //angle*=-1.*sign(-g.y);
                        
                    }
                   // else if(armsSpinning==2){angle*=-1.*sign(g.y);}
                   // else if(armsSpinning==3){angle=-abs(angle)*sign(-g.y);}
                    //angle+=PI/2.;
                                        //angle+=PI/2.;//-pi/4.;
                                       else if(armsSpinning==1)
                                        {
                                                angleOffset1 =  PIdiv2;
                                                angleOffset2=angleOffset1+PI;
                                                
                                            }
                                        else if(armsSpinning==2)
                                        {

                                                angleOffset1 = -PIdiv2;
                                                angleOffset2=angleOffset1+PI;
                                            }
                                        else if(armsSpinning==4)
                                        {
                                            angleDirection=-1.;
                                            angle=-abs(angle)+PIdiv2;
                                        }

                                        vec2 nabaoth = (g);
                                     if(HandOfGod) 
                                      {
                                        nabaoth*=2./(2.-pow(length(nabaoth),2.)*1.);
                                        t*=0.;
                                     //   nabaoth=nabaoth*sign(note-lastNote);
                                     //   angle*=sign(note-lastNote);
                                      }
                                      else nabaoth-=elbow;

                                      
                    vec2 spinningArm=spin2((nabaoth)/amp,angle+angleOffset1//(atan(d.x,d.)
                                           )/vec2(4.,2.);//-spin2(elbow,angle);
                                          // if(!HandOfGod)

                                       spinningArm+=elbow;
                                 //     spinningArm.y+=elbow.y;

        


           float growng5= finger9;
           vec2 thumbJoint = vec2(-.625,1.75);
	   if(spinningArm.x>thumbJoint.x&&spinningArm.y>thumbJoint.y&&spinningArm.y<2.5)
       {
                thumbJoint.y+=.15;

        spinningArm=(spinningArm-thumbJoint)/(1.+growng5)+thumbJoint;//g/=growng5;

       }
                   vec2 z=spinningArm;

	    		   vec2 growng=z;
	    
		vec2 lastZ = z;
		   	vec2 h = z;


           vec2 growng1= spinningArm*finger1;
           vec2 growng2= spinningArm*finger3;
           vec2 growng3= spinningArm*finger5;
           vec2 growng4= spinningArm*finger7;


                          //if(HandOfGod)

                   float armSlice = abs(spinningArm.y)*pow(abs(spinningArm.x),1./.75);
              if( armSlice>sqrt2/2.&&spinningArm.y>0.&&(spinningArm.x)<1.&&(spinningArm.x)>-1.)
                    {
                    for(int f=0;f<12;f+=1)
                    {
	    
		 lastZ = z;
		   	 h = z;

	//   if(g.x<1.25&&g.y<-3.75)  
	   
	      if(f>3&&f<8)
	      {
                                  if(f==4)   growng=growng4;
                                  if(f==5)   growng=growng3;
                                  if(f==6)   growng=growng2;
                                  if(f==7)   growng=growng1;

		          h=2.*vec2(-1./(h.x*h.x-h.y*h.y+growng.x+t.x),(2.0*h.x*h.y+growng.y+t.y));//z<=z^2-g; z.real<=-1/z.real; z*=2;
		          h.x=sqrt(abs(h.x));
	      }
 if((abs(h.y)>52.&&f>3))
	   {
        arm=1.;
		   b=abs(h.y)/77.;
		   break;		   
	   }


z=2.*vec2(-1./(z.x*z.x-z.y*z.y+spinningArm.x+t.x),(2.0*z.x*z.y+spinningArm.y+t.y));//z<=z^2-g; z.real<=-1/z.real; z*=2;
z.x=sqrt(abs(z.x));


	   if((abs(z.y)>52.&&f>3))
   {
        arm=1.;

	  b=abs(z.y)/77.;
	   break;
   }
}
}
                    
                    elbow =vec2(-.5,-1.)*1.25;
            //    g=p;
                    // angle = atan(d.x,d.y);//-PI*4./3.;



                    

      nabaoth = (g);
                                                    

                                     if(HandOfGod) 
                                      {
                                        nabaoth.y*=-1.;
                                                    angle*=-1.;
                                                    angle+=PI;

                                        nabaoth*=2./(2.-pow(length(nabaoth),2.)*1.);
                                        t*=0.;
                                     //   nabaoth=nabaoth*sign(note-lastNote);
                                     //   angle*=sign(note-lastNote);
                                      }
                                      else nabaoth-=elbow;



                     spinningArm=spin2((nabaoth)/amp,angle*angleDirection+angleOffset2//
                                           )/vec2(4.,2.)+elbow;//-spin2(elbow,angle);

//



            growng5= finger10;
            thumbJoint = vec2(-.625,-1.75);
           
	   if(spinningArm.x>thumbJoint.x&&spinningArm.y>thumbJoint.y&&spinningArm.y<2.5)
       {
        thumbJoint.y-=.15;
        spinningArm=(spinningArm-thumbJoint)/(1.+growng5)+thumbJoint;//g/=growng5;
       }


                    z=spinningArm;

	    		    growng=z;
	    
		 lastZ = z;
		   	 h = z;


            growng1= spinningArm*finger2;
            growng2= spinningArm*finger4;
            growng3= spinningArm*finger6;
            growng4= spinningArm*finger8;




                     armSlice = abs(spinningArm.y)*pow(abs(spinningArm.x),1./.75);

                if(armSlice>sqrt2/2.&&spinningArm.y<0.&&(spinningArm.x)<1.&&(spinningArm.x)>-1.)
                              {
                    for(int f=0;f<12;f+=1)
                    {
	    
		 lastZ = z;
		   	 h = z;

	//   if(g.x<1.25&&g.y<-3.75)  
	   
	      if(f>3&&f<8)
	      {
                                  if(f==4)   growng=growng4;
                                  if(f==5)   growng=growng3;
                                  if(f==6)   growng=growng2;
                                  if(f==7)   growng=growng1;

		          h=2.*vec2(-1./(h.x*h.x-h.y*h.y+growng.x+t.x),(2.0*h.x*h.y+growng.y+t.y));//z<=z^2-g; z.real<=-1/z.real; z*=2;
		          h.x=sqrt(abs(h.x));
	      }
 if((abs(h.y)>52.&&f>3))
	   {
        arm=1.;
		   b=abs(h.y)/77.;
		   break;		   
	   }


z=2.*vec2(-1./(z.x*z.x-z.y*z.y+spinningArm.x+t.x),(2.0*z.x*z.y+spinningArm.y+t.y));//z<=z^2-g; z.real<=-1/z.real; z*=2;
z.x=sqrt(abs(z.x));


	   if((abs(z.y)>52.&&f>3))
   {
        arm=1.;

	  b=abs(z.y)/77.;
	   break;
   }
}
}

                return vec2 (b,arm);
}
                    vec4 torso(vec2 g, vec2 t,bool spinning){
                      
                                              if(armsSpinning==0)spinning=false;
                                              
                                              g.x*=-1.;
                                              t*=-1.;
                    float b = 0.;
                    vec2  z=g.xy;
                    float arm =0.;
                                  float  armSlice = abs(g.y)*pow(abs(g.x),4./3.);

                    if((armSlice<1./sqrt2||!spinning)&&g.x<0.)

                    {
                    if(g.x*g.x+g.y*g.y<40.)
                    for(int f=0;f<12;f+=1)if(abs(z.y)>52.&&f>4){b=abs(z.y)/77.;break;}
                    else{
                        z=2.*vec2(1./(z.x*z.x-z.y*z.y+g.x+t.x),(2.0*z.x*z.y+g.y+t.y));
                       //if(z.x>0.)//likely clipped off headbody
                        z.x=sqrt(abs(z.x));}
                    
                    }
     vec4 arms = vec4(0.);
     vec2 h = vec2(0.);
       if(spinning){                    float angle =atan(d.x,d.y);

        float finger1 = texture2D(pitchHandsFingers,vec2(0.5/10.)).r*4.;
        float finger2 = texture2D(pitchHandsFingers,vec2(1.5/10.)).r*4.;
        float finger3 = texture2D(pitchHandsFingers,vec2(2.5/10.)).r*4.;
        float finger4 = texture2D(pitchHandsFingers,vec2(3.5/10.)).r*4.;
        float finger5 = texture2D(pitchHandsFingers,vec2(4.5/10.)).r*4.;
        float finger6 = texture2D(pitchHandsFingers,vec2(5.5/10.)).r*4.;
        float finger7 = texture2D(pitchHandsFingers,vec2(6.5/10.)).r*4.;
        float finger8 = texture2D(pitchHandsFingers,vec2(7.5/10.)).r*4.;
        float finger9 = texture2D(pitchHandsFingers,vec2(8.5/10.)).r*4.;
        float finger10 = texture2D(pitchHandsFingers,vec2(9.5/10.)).r*4.;

         h = spinningArms(g,t,angle,1.,false,finger1,finger2,finger3,finger4,finger5,finger6,finger7,finger8,finger9,finger10);
         b+=h.x;
         arm+=h.y;
       }
       

       float extrArms = 0.;
       if (armStar&&arm==0.&&armsSpinning!=0&&spinning&&volume!=1.)
       {
        

        float finger1 = texture2D(firstHandsFingers,vec2(0.5/10.)).r*4.;
        float finger2 = texture2D(firstHandsFingers,vec2(1.5/10.)).r*4.;
        float finger3 = texture2D(firstHandsFingers,vec2(2.5/10.)).r*4.;
        float finger4 = texture2D(firstHandsFingers,vec2(3.5/10.)).r*4.;
        float finger5 = texture2D(firstHandsFingers,vec2(4.5/10.)).r*4.;
        float finger6 = texture2D(firstHandsFingers,vec2(5.5/10.)).r*4.;
        float finger7 = texture2D(firstHandsFingers,vec2(6.5/10.)).r*4.;
        float finger8 = texture2D(firstHandsFingers,vec2(7.5/10.)).r*4.;
        float finger9 = texture2D(firstHandsFingers,vec2(8.5/10.)).r*4.;
        float finger10 = texture2D(firstHandsFingers,vec2(9.5/10.)).r*4.;
          float angle =atan(loudestFret1.x,loudestFret1.y);
                h = spinningArms(g,t,angle,volumeFret1*4./3.,false,finger1,finger2,finger3,finger4,finger5,finger6,finger7,finger8,finger9,finger10);
extrArms+=h.x;
                 arm+=h.y;


         finger1 = texture2D(secondHandsFingers,vec2(0.5/10.)).r*4.;
         finger2 = texture2D(secondHandsFingers,vec2(1.5/10.)).r*4.;
         finger3 = texture2D(secondHandsFingers,vec2(2.5/10.)).r*4.;
         finger4 = texture2D(secondHandsFingers,vec2(3.5/10.)).r*4.;
         finger5 = texture2D(secondHandsFingers,vec2(4.5/10.)).r*4.;
         finger6 = texture2D(secondHandsFingers,vec2(5.5/10.)).r*4.;
         finger7 = texture2D(secondHandsFingers,vec2(6.5/10.)).r*4.;
         finger8 = texture2D(secondHandsFingers,vec2(7.5/10.)).r*4.;
         finger9 = texture2D(secondHandsFingers,vec2(8.5/10.)).r*4.;
         finger10 = texture2D(secondHandsFingers,vec2(9.5/10.)).r*4.;
         
           angle =atan(loudestFret2.x,loudestFret2.y);
               h = spinningArms(g,t,angle,volumeFret2*4./3.,false,finger1,finger2,finger3,finger4,finger5,finger6,finger7,finger8,finger9,finger10);
extrArms+=h.x;
                 arm+=h.y;

         finger1 = texture2D(thirdHandsFingers,vec2(0.5/10.)).r*4.;
         finger2 = texture2D(thirdHandsFingers,vec2(1.5/10.)).r*4.;
         finger3 = texture2D(thirdHandsFingers,vec2(2.5/10.)).r*4.;
         finger4 = texture2D(thirdHandsFingers,vec2(3.5/10.)).r*4.;
         finger5 = texture2D(thirdHandsFingers,vec2(4.5/10.)).r*4.;
         finger6 = texture2D(thirdHandsFingers,vec2(5.5/10.)).r*4.;
         finger7 = texture2D(thirdHandsFingers,vec2(6.5/10.)).r*4.;
         finger8 = texture2D(thirdHandsFingers,vec2(7.5/10.)).r*4.;
         finger9 = texture2D(thirdHandsFingers,vec2(8.5/10.)).r*4.;
         finger10 = texture2D(thirdHandsFingers,vec2(9.5/10.)).r*4.;

           angle =atan(loudestFret3.x,loudestFret3.y);
                h = spinningArms(g,t,angle,volumeFret3*4./3.,false,finger1,finger2,finger3,finger4,finger5,finger6,finger7,finger8,finger9,finger10);
extrArms+=h.x;
                 arm+=h.y;


         finger1 = texture2D(fourthHandsFingers,vec2(0.5/10.)).r*4.;
         finger2 = texture2D(fourthHandsFingers,vec2(1.5/10.)).r*4.;
         finger3 = texture2D(fourthHandsFingers,vec2(2.5/10.)).r*4.;
         finger4 = texture2D(fourthHandsFingers,vec2(3.5/10.)).r*4.;
         finger5 = texture2D(fourthHandsFingers,vec2(4.5/10.)).r*4.;
         finger6 = texture2D(fourthHandsFingers,vec2(5.5/10.)).r*4.;
         finger7 = texture2D(fourthHandsFingers,vec2(6.5/10.)).r*4.;
         finger8 = texture2D(fourthHandsFingers,vec2(7.5/10.)).r*4.;
         finger9 = texture2D(fourthHandsFingers,vec2(8.5/10.)).r*4.;
         finger10 = texture2D(fourthHandsFingers,vec2(9.5/10.)).r*4.;


           angle =atan(loudestFret4.x,loudestFret4.y);
               h = spinningArms(g,t,angle,volumeFret4*4./3.,false,finger1,finger2,finger3,finger4,finger5,finger6,finger7,finger8,finger9,finger10);
extrArms+=h.x;
                 arm+=h.y;

        
       }
       arm=clamp(arm,0.,1.);
                    return vec4(b,b/2.5,0.,arm)+vec4(vec3(extrArms,extrArms*.99,extrArms)*.75,0.);
                    }
    
                    vec3 musculature(vec2 g, vec2 t){
                    float m=0.;
                    g.x+=.5;
                    vec2 z=g.xy;
                    if(abs(g.y)<2.5)for(int f=0;f<21;f+=1)if(abs(z.x*1.5+z.y)>11.&&f>8){m=abs(z.y)/20.;break;}
                    else{
                    z=1.3*vec2(-1.5/(1.*z.x*z.x-2.*z.y*z.y-g.x+t.x),1.9*z.x*z.y-1.87*g.y+t.y);
                          z.x=pow(abs(z.x),.57 );}
                    return vec3(m,m,m/2.);
                    }
                    vec3 robe(vec2 g, vec2 t){
                    float r=0.;
                    g.x+=.05;
                    g.y/=1.14;
                    vec2 z=g.xy;
                    if(abs(g.y)<3.)for(int f=0;f<70;f+=1)if(abs(z.y)>11.&&f>7){r=clamp(1.7-abs(g.x-2.3)
                                     //*(1.-abs(g.y*g.x))-.07//(un)comment this line to toggle sleeves
                                    ,0.,1.);break;}
                    else{
                        z=1.1*vec2(-2./((z.x*z.x-1.8*z.y*z.y)-g.x),(3.*z.x*z.y-1.3*g.y+t.y));;
                        z.x=pow(abs(z.x),.8);}
                    return vec3(r);
                    }
                    vec3 legs(vec2 g, vec2 t){
                    float b=0.;
                    g/=2.;
                    vec2 z=g.xy;
                    if(g.x>.75&&g.x<1.7&&abs(g.y*g.x)<.58)for(int f=0;f<18;f+=1)if(abs(z.x)>52.&&f>1){b=abs(z.x)/70.;break;}
                    else{
                        z=3.*vec2(-1./(z.x*z.x-z.y*z.y-g.x+t.x*sign(-g.y)),77.*z.x*z.y-g.y+t.y);
                        z.y=-1./z.y;}
                    return vec3(b,b/2.,0.);
                    }

    /*
    vec3 hsv2rgb (vec3 hsv) {
      // from HSV to RGB color vector
      hsv.yz = clamp (hsv.yz, 0.0, 1.0);
      return hsv.z * (1.0 + 0.63 * hsv.y * (-cos (2.0 * 3.14159 * (hsv.x + vec3 (0.0, 2.0 / 3.0, 1.0 / 3.0))) - 1.0));
    }//^^^^^^above from https://shadertoy.fandom.com/wiki/Color_Processing^^^^^
*/
    
    
    
    
                       
                                             
    vec3 balloons(vec2 p){
        vec3 balloon=vec3(0.);
        vec2 vUvCentered =(vUv-.5)*resolution/min(resolution.x,resolution.y);
        float sizeReset = 480.;
        if (balloonsONexponential!=0.)
        sizeReset = 960.;
          float x =  length(vUvCentered);
          float increment =0.;
         // vec2 spinningSpiraloon  =  spin2(vUvCentered,time*PI*4.);
         float bruedCorrection =0.;
         if(brelued==-1.)
         {
             if(balloonsON!=0.)bruedCorrection=1.;//a bit awkward
             else if (balloonsONexponential!=0.)bruedCorrection=4.;
             }
          if(balloonsON!=0.) increment =((-note)*balloonsON//-(-3.+4.*balloonsON)*brelued+bruedCorrection
                                         +480.  - x*48.);
          else if(balloonsONexponential!=0.)
              increment= (-note)*balloonsONexponential+log(x*24.)/log(pow(2.,1./12.))-.25*balloonsONexponential;
        
               
                   if(abs(mod(increment+atan(vUvCentered.y,vUvCentered.x)*balloonsONexponential*divideByMultiplyingPi2,1.))<1./(increment+sizeReset)*280.)
                          {
                       if(balloonsON!=0.)
                       balloon=hsv2rgb(vec3((mod((4.*balloonsON+bruedCorrection*balloonsON+increment*brelued)*balloonsON+24.,12.))/12.,.5,1.));
                       else if(balloonsONexponential!=0.)
                       balloon=hsv2rgb(vec3((mod((-2.-balloonsONexponential+bruedCorrection+increment*balloonsONexponential)*brelued+24.,12.))/12.,.5,1.));
                       }
        return balloon;
    }
    
                                     
                                     vec3 lamb(vec2 p) {
                                        vec3 ret = vec3(0.);
                                       vec2 s = p.yx;
                                         p=p.yx;
                                       float d = 0.0, l;
                                                 float flip=-sin(3.14/2.+rate*time);
                                         if (flip<0.) p = -p;
                                         const int ITERATION = 21;
                                         const float b = pow(2.,2.);
                                          float golden_mean = gr;
                                       for (int t = 0; t < ITERATION; t++) {
                                         s = vec2(((s.x * s.x - s.y * s.y) +flip* p.x), (2.0* s.x * s.y + flip*p.y));
                                           
                                           //this is a reorientation and riff
                                           // off of (read inspired by) the feedback loop x <= 1/(1/x-x).  This pattern starts false and generates increasingly many solutions.
                                           //. essentially the image is the Mandelbrot set only with 1/real-imag in place of the standard complex number as x's argument.
                                           // 1/real-imag turns out to equate to essentially an identical image to real-1/imag which seems more elegant
                                           // remove the below line to see that it is the only core difference in the equations of the Mandelbrot and This image.
                                           if(b==2. ||rate == 0.)
                                           s.x = -1./s.x;
                                          else
                                           s.x = pow(s.x,flip)*sign(s.x*flip);



                                          
                                           
                                           l = 3.+length(s*golden_mean/3.5);
                                                       d += golden_mean*.0777;
                                         
                                         float activate = 8.+-sin(-time)*6.;
                                           float colorshift = .5+-abs(sin(-time/2.+3.14*.25))/2.;
                                           float colorshift1 = .5+-abs(sin(-time/2.-3.14*.25))/2.;
                                           float colorshift2 = .5+-sin(-time-3.14/3.);
                                           if (l >35.0-activate)
                                                       if (t != 1 || (p.x>-.1 || abs(p.y)<.3))
                                             if (t > 3)
                                                  {
                                                 ret=2.*colorshift2*colorshift2*vec3(.5+sin(float(t) * 0.05)-.5,.5-sin(float(t) * 0.2)-.5,sin(d * 0.01)-.5)
                                             
                                                 +2.*colorshift1*colorshift1*vec3(10.)+
                                                             -2.*colorshift*colorshift*vec3(10.)+
                                                 2.*vec3(-sin(d+golden_mean +time*1./golden_mean*.7),-sin(d*1. +time*golden_mean*.7),-sin(d+1./golden_mean +time*.7));
                                                break;
                                                }
                                                 else if( abs(p.y)>2.||( ( p.x>(.8+activate/10.)||p.x<1.)) || rate != 0.0 )
                                             {
                                         s = vec2(((p.x * p.x - p.y *p.y) +flip* p.x), (2.0* p.x * p.y + flip*p.y));
                                                       l = 3.+length(s*golden_mean/3.5);
                                              ret=
                                             // (vec3(1.-sin(100.*d *1.618+time*.618),1.- sin(10.*d *1.0+time*1.618),1.-sin(50.*d * 0.618+ti)me*1.)) )
                                             vec3(1.-(sin(333.*golden_mean/l*-sin(time*1./golden_mean/5.)*-sin(time*-golden_mean/5.+1.57))-sin(1.1*1./golden_mean*-time))/2.,
                                                  1.- (sin(333./golden_mean*-l*(-sin(time*-golden_mean/5.+1.57)*-sin(time*golden_mean/5.+1.57/2.)*+2.))-sin(.1*time*golden_mean))/2.
                                                  ,1.-(sin(333.*l* -(sin(time*golden_mean/5.+1.57/2.)*-sin(time*1./golden_mean/5.)+2.))-sin(1.1* golden_mean*-time))/2.
                                                 )/2.;
                                                 break;
                                             }
                                           
                                           else     if (1.-p.x<-.12){
                                               //blood from being slain and pierced
                                                                       ret= vec3(1.,0.,0.)/p.x/p.x/p.x*8.*(abs(-sin(-time/2.+3.14/2.))-.5);
                                          break;
                                                                    }
                                                                       //firebreath! vvvv

                                                   //return     vec3((1.-.5*sin(p.x/2.)),(1.-.9*sin(p.x*1.)),(.1-.7*sin(p.x*2.)))/p.x/p.x/p.x*5.;
                                                 }
                                         
                                                 if(ret.x==0.&&ret.y==0.&&ret.z==0.)
                                       ret=vec3(flip*((-sin(time)-1.)/2.));
                                       return ret;
                                     }
                                     //FRACTALIZE function mostly by c03moz
                                     vec2 FRACTALIZE(vec2 p) {
                                         float timeDilated = time*1000.;
                                         float s = 0.;
                                         float cs = (-cos(timeDilated));
                                         float sn = (sin(-timeDilated*1.618));
                                         mat2 rot = mat2(cs, sn, -sn, cs);
                                         for (int i = 0; i < 8; i++) {
                                             p = abs(p) / dot(p, p) - s;
                                             p *= rot;
                                             s += .5-abs(sin(-timeDilated*sin(timeDilated)+1.))/2.;
                                         }
                                         return p;
                                     }

    //['y/((y/(y*x))-y)+1/(1-(1/(y*x)))', '1/(1-(y/(y-x)))-y/(1-(y/y))', 'y/(y-(y/(y*x)))+1/((1/(y*x))-1)', '1/(1-(y/x))+1/((y/x)-1)', 'y/((1/x)-y)+1/(1-(1/(y*x)))', '1/(x+(1/y))+1/(1-(y/y))', '1/((y/x)-1)+1/(1-(y/x))', 'y/(y-(1/x))+1/((1/(y*x))-1)', 'y/((y/y)+y)-y/((1/(y*x))-1)'] tree of life 5 results
                                     
    vec3 sparkles(vec2 p){
        vec4 starship = vec4(0.);
        float recenter = 0.;
        float rescale = 1./3.;
        vec2  starshipLOOKUP = ((vUv-.5)+vec2(0.,recenter))*rescale+.5;//starship may not be an improvement, try with disabled below
         /* if (starshipLOOKUP.x<1.&&starshipLOOKUP.y<1.&&starshipLOOKUP.x>0.&&starshipLOOKUP.y>0.)starship = texture2D(STAR,starshipLOOKUP);
          if (starship.x==0.&&starship.y==0.&&starship.z==0.)starship=vec4(1.);//s
          */
        float timeDilated = time/10.;
         p=(mod(timeDilated,1.)-.5)*abs(p)+length(vec2(length(starship.xy),starship.z));
            p=vec2(p.x,abs(p.y));
            vec2 s=p;

        float l=0.;
          float love1 =  mod(timeDilated*(-1.-leaf),.25)+.5;
                  float love2 =  mod(timeDilated*(gr-1.),.25)+.5;              float love3 =  mod(timeDilated,.25)+.5;
        for (int f=0;f<15;f+=1){//turn f<21 for just seven eyed
                    s=love2*vec2(-1./(s.x*s.x-s.y*s.y-p.x), 2.0*s.x*s.y-p.y);//this is {s=s^2-p;s.real=-1./s.real}
            s=-vec2(s.y/((s.y/(s.y-s.x)*love3-(s.y))), -pow(abs(s.y/(s.y/(s.x-s.y)*love3-s.y*love2)),2.*1./love3));//this is {s=s^2-p;s.real=-1./s.real}
            //  s           *= vec2(s.y,s.x);
                  }
                s=-vec2(s.y/((s.y/(s.y-s.x)*love3-(s.y))), -pow(abs(s.y/(s.y/(s.x-s.y)*love3-s.y*love2)),2.*1./love3));//this is {s=s^2-p;s.real=-1./s.real}
        float centralPowerInverter=(s.x/s.y)*sign(s.x*s.y)*(gr+1.);
            //I was studying this function without the face and a power short ocurred and on firefox window restore and caused a semi-reversion hybridization
        l=1.;// / //1.-
           // centralPowerInverter;
        return vec3(vec2((s.x*love1),abs(s.y*love2)),vec2(s.x*s.x*love1)*l);
    }
vec3 kissingEagles(vec2 p){
                          vec2 g=p*.5;
                          vec2 s=g;
                          float l=0.;
                          g = -p;
                                  g.x+=.25;
                          s=g;
                                              float q = 0.;
                          for (int f=0;f<10;f+=1)if(abs(s.x)+abs(s.y)>20.&&f>3){q/=2.;}
                              else {s=vec2(-1./((s.x*s.x-s.y*s.y)-g.x),(2.0*s.x*s.y-g.y)); s.x=pow(abs(s.x),s.x); q+=.1;}

                          
                                  return vec3(q);
                              }
                          
                          vec3 faceFORWARDTWO(vec2 p,vec2 t){//tuner crab Rangoon
                                              if(p.x<-1.25)p.x-=2.;
                              vec2 s=p;
                              
                                  for (int f=0;f<2;f+=1) s=vec2(-1./(s.x*s.x-s.y*s.y-p.x+t.x), 2.0*s.x*s.y-p.y-t.y*2.);//this is {s=s^2-p;s.real=-1./s.real}
                                  float l=(s.x/s.y)*sign(s.x*s.y);
                                      //I was studying this function without the face and a power short ocurred and on firefox window restore and caused a semi-reversion hybridization
                         //if(l<abs(p.x)*abs(p.y)/15.)l=0.;
                                          
                                      if (l>1.)l=1.;
                                      //if ( l<.5&&l>0.0)l=-0.;
                                      if (l<.125)l=-0.;
                                             if(p.y==0.&&t.y==0.)l=1.;
                                             return vec3(l);
                                         
                              }


                          
vec3 sealedMan(vec2 p,vec2 t)
{
p.x+=2.;
float r=.0, b=.0, l=.0, h=0.;
//person--a body derived to have a head of its own
vec2 z=p;
for(int f=0;f<20;f+=1)if(abs(z.y)>50.&&f>4){l=1.;break;}
else{z=2.*vec2(1./(z.x*z.x-z.y*z.y-p.x+t.x),2.0*z.x*z.y-p.y+t.y);
     z.x=pow(abs(z.x),.59);}
    
//robe--came from the body as soon as I looked for clothing
vec2 g=p;
g.x+=.05;
g.y/=1.14;
z=g;
if(g.x>.5)for(int f=0;f<70;f+=1){if(abs(z.y)>11.&&f>7){r=clamp(1.44-abs(g.x-2.3)
                             *(1.-abs(g.y*g.x))-.07
                            ,0.,1.);
                            break;}
else{
z=1.1*vec2(-2./((z.x*z.x-1.8*z.y*z.y)-g.x+t.x),(3.*z.x*z.y-1.3*g.y+t.y));
z.x=pow(abs(z.x),.8);}}
//horse
g=p;
g.x-=3.5;
g.y/=1.14;
z=g;
if(g.x*g.x+g.y*g.y<3.)for(int f=0;f<23;f+=1){if(abs(z.y)>11.&&f>7){h=1.;break;}
else{
z=1.0*vec2(1./((z.x*z.x-3.*z.y*z.y)-g.x+t.x),2.*(z.x*z.y-g.y+t.y));
z.x=pow(abs(z.x),.8);}}
//legs--I found these about hours before finding the body but left them, recovering them from memory
g=p/2.;
z=g;
if(g.x>.75&&g.x<1.7&&abs(g.y*g.x)<.54)for(int f=0;f<8;f+=1){if(abs(z.x)>52.&&f>1)b=abs(z.x)/100.;
else{
z=3.*vec2(-1./(z.x*z.x-z.y*z.y-g.x+t.x),77.*z.x*z.y-g.y+t.y);
z.y=-1./z.y;}
}
return vec3(l+b+r+h);}
    vec3 sealedWoman(vec2 p,vec2 t){
                 p.x+=1.;
                    
                   vec2 g=p/2.2;
                   vec2 s=g;
                   float l=0.;
                   float n=.0, c=.0, r=.0, x=.0;
                   //vv legs vv
                   
                   if (g.x<1.8 &&g.x>.5 &&abs(g.x*g.y)<.5)for (int f=0;f<10;f+=1)if(abs(s.x+s.y)>200.&&f>4){c=1.;break;}
                     else {s=vec2(-1./((s.x*s.x-s.y*s.y)-g.x+t.x),(67.0*s.x*s.y-.7*g.y+t.y));s*=3.; s.y = -1./s.y; }
                                  
                    g = p;
                   s=g;
                                  
                   if((g.x*g.x+g.y*g.y*4.<2.||g.x>0.)&&abs(g.y)<2.){
                   //vv body vv
                       for (int f=0;f<21;f+=1){if(abs(s.x+s.y)>12.&&f>7){l=1.;break;}
                          else {s=vec2(-1.5/((s.x*s.x-2.*s.y*s.y)-g.x+t.x),(1.7*s.x*s.y-1.2*g.y+t.y));s*=1.3; s.x=pow(abs(s.x),.6125 );  }
                          }
                g=p;
                        s=g;
                   //vv body vv
                   
                     if(abs(g.y)<2.)  for (int f=0;f<10;f+=1){if(abs(s.x)+abs(s.y)>20.&&f>4){x=1.;break;}
                       else {s=vec2(-1.5/((s.x*s.x-2.*s.y*s.y)-g.x+t.x),(1.7*s.x*s.y-1.34*g.y+t.y));s*=1.7; s.x=pow(abs(s.x),.549 );  }
                       }
                     }
                         //vv robe vv
                                  
                   g=p;
                   g.x+=-.3;
                   s=g;
                   if (abs(g.y)<2.&&g.x>.50)for (int f=0;f<20;f+=1){if(abs(s.x+s.y)>11.&&f>7){r=clamp(1.4-abs(g.x-2.3)
                                                                                         *(1.-abs(g.y*g.x))-.07
                                                                                        ,0.,1.);
                                                                                        break;}
                   else {s=vec2(-2./((s.x*s.x-2.4*s.y*s.y)-g.x+t.x),(3.*s.x*s.y-1.3*g.y +t.y));s*=1.11; s.x=pow(abs(s.x),.8 );
                       }
                   }
                                  vec3 o =vec3(clamp(l+x+r+c,0.,1.));
                   return o;
               }
            
                                  

                              
                             vec2 starBirth(vec2 p){
                              bool originalClover = true;
                              //if(constellation)
                              const int constellationSize = 49;
                              for(int cd = constellationSize;cd>=1;cd--)
                              {
                               /*   float cdcs=cd/constellationSize;
                              float y =texture2D(constellationDynamic,vec2(cdcs,0.)).x;//thought the y argument would be 0, seems to be 1
                              float x =texture2D(constellationDynamic,vec2(cdcs,.5)).x;
                              */
                              vec2 xy = constellationDynamic[cd];
                              float x = -xy.x;
                              float y=xy.y;

                             if(originalClover&&(x!=0.||y!=0.))
                             {
                                 float atanConstellation = atan(y,x)-PIdiv2;
                              p=spin2(p,atanConstellation);
                               float farness=length(vec2(x,y));
                               vec2 newClovers = p;
                               if(p.x>0.)newClovers=vec2(p.x-sign(p.x)*farness,p.y);

                              // if(length(p)<twoThirds)
                              //   p -= vec2(farness,0.);
                          if(length(newClovers)<twoThirds)
                          {
                                 if(newClovers.x>0.)originalClover=false;
                                 p = newClovers;
                          }
                             if(originalClover)  p=spin2(p,-atanConstellation);
                             }
                              }
                              return p;
                            }
                              
                              vec4 roundEyes(vec2 ff,vec2 moveDynamic){
float leafDivGR=leaf/gr;

                                     vec4 insideOut=vec4(0.);                                          vec2 arndEyes = ff;
                                                                        if( length   (arndEyes)<-leaf*gr)                {
                                                                            float outerMargin =atan(arndEyes.y,arndEyes.x);
                               insideOut=faceBlackAndWhite(
                                                           //(-leaf-length(arndEyes))*
                                                         
                                                           (-vec2(-sin(outerMargin),-cos(outerMargin)).yx/-leafDivGR-arndEyes*-leafDivGR)
                                                           
                                                           ,vec2(moveDynamic.x,-moveDynamic.y*2.5)/2.,false, -2,false,1.);

                         }
                              return insideOut;
                              
                                                                        }
vec4 tol(vec2 p, vec2 t){



 //should be activated many ways

    float petalNumber = petals+6.;

  //  if(mod(atan(p.x,p.y)/PI2+1.,1.)<.25)p=vec2(0.);
  if(petalNumber<=6.) p /=squirgleDynamic[int((mod((atan(p.y,p.x)*6./petalNumber//
                                            +PI2*4.
           +PI/petalNumber/2.
                                            )/PI2
                                            ,1.
                                            )*petalNumber*2.))];
                                           
    //float angleToLittleClover = PI2/12.;
    //if (length(p-vec2(-sin(-angleToLittleClover),cos(angleToLittleClover))*1.25)
     //   <(.25))p=vec2(0.);
  //  p+=vec2(-sign(p.x),-sign(p.y));//two by two division;

    /*centered and divides right
     if(originalClover)
     {
     float farness=length(vec2(x,y));
       p -= vec2(farness,0.);
   p = (vec2(p.x-sign(p.x)*farness,p.y));
     }
     */
    
    /*fully functional?
     if(originalClover)
     {
    //   if(x!=0.&&y!=0.)  p=spin2(p,atan(y,x));
    if(x!=0.&&y!=0.)  p=spin2(p,atan(y,x));

       float farness=length(vec2(x,y));
         p -= vec2(farness,0.);
         if(p.x>0.&&p.y>0.)originalClover=false;

     p = (vec2(p.x-sign(p.x)*farness,p.y));

     if(x!=0.&&y!=0.)  p=spin2(p,-atan(y,x));

    // if(p.x<x&&p.y<y)originalClover=false;

   //  p += vec2(farness,0.);

    // if(x!=0.&&y!=0.&&originalClover)  p=spin2(p,-atan(y,x));

     }
     */
        for(float x=2.; x<102.;x+=1.)
        {
            if (float(nGenesis)+2.>x)
        {
        float regenerativeshift = 1./x;
    p.x-=regenerativeshift;
    p= vec2(p.x-sign(p.x)*regenerativeshift,p.y);
          p= vec2(p.x-sign(p.x+regenerativeshift)*regenerativeshift,p.y);
            p.x+=regenerativeshift;
            }
        else break;
        }
        if(constellation)p=starBirth(p);
    p*=pow(length(p),squeezeN-1.);//may cause conflict with constellation
   //tricellular division core unstable
               
//p.x+=.5;
          //p=//abs(
          //      (vec2(p.x+sign(p.x)*.5,p.y));
          
                         bool inMainSpoke = false;
                        vec2 resCale = (resolution.yx/max(resolution.x,resolution.y));
                     vec3 uber    = texture2D(uberDuper,(
                        ((vUv-.5)/resCale*zoom/duperZoom
                         -coordSHIFT/duperZoom)*resCale+.5
                                              )
                        ).xyz;
                        
                        
          
                        
               float distributorFACTOR=PI/gr;
                         float distributorFACTORlove= distributorFACTOR/leaf;//*sqrt(2)
                        
               float distributorFACTORorth=PI/6.;
                         float distributorFACTORloveORTH= distributorFACTORorth;//*sqrt(2)
                        
                        
                        
                        //if(clvrVariant4!=0.)
                        p/=1.25;
                        if(externalCores==0.)p/=1.25;
                   
                       // if(cloverso) p=(2./3.-length(p))*p;

                         vec2 pWithoutChiralizer = p;
                         
      float chiralAdjustment = 0.;

                         if(chirality==-1&&twelveGates){
                         chiralAdjustment=-PI2/24.;
                         p=spin2(p,-chiralAdjustment);}
                         else if(chirality==-1){
                         chiralAdjustment=-PIdiv2;
                         p=spin2(p,-chiralAdjustment);}
                         if(cloverOffset!=0.)p=spin2(p,cloverOffset*PI2);
                    
                    bool gated = false;
                    bool unSwitch=false;
                    bool unSwitch2=false;

                    
                                                                                              float angle = atan(p.y,p.x);

                                                             /*   if( morph==0.&&mod(angle+PI2-PI2/12.,PI2/3.)<PI2/6.) //p*=0.;
                                                                {
                                                                    p=spin2(p,PI);//balances inherited colors
                                                                    unSwitch= !unSwitch;
                                                                }
                                                                
*/

                                                             /*       
                                                              if(abs(angle)>5.*PI/6.||abs(angle)<PI/6.)
                                                              {
                                                                    p*=0.;
                                                                    p=spin2(p,PI/3.);//balances inherited colors
                                                                //    unSwitch= !unSwitch;
                                                                }
                                                                */
                                                                
                         if(twelveGates)
                         {


                         if(mod((angle*divideByMultiplyingPi+2.)*6.+.5,2.)>1.){p=spin2(p,PI/6.);
                                gated=true;

                                }
                                }


                         vec2 colorAccumulator =vec2(1.);

                         float bubble =0.;

                         vec3 heartColors = vec3(0.);
float lfc = length(freed(constellationCoord));

   
   
float precores = .25*LogHalfReciprocal;
//if(clvrVariant4!=0.&&cloverSlide) precores=precores-.25*LogHalfReciprocal;
//else if(clvrVariant4!=0.)precores=0.;
if(morph!=0.)precores-=5.*LogHalfReciprocal;

if(refactorCores!=1.)precores=-.0;

float cored =0.;
if(MetaCored)cored= log(zoom)/-log2+precores;
else cored = centralCores;
cored*=squeezeN;
float loops=0.;
if(cloverSlide)loops=-1.;

if(refactorCores>1.)
    {
        if(cloverSlide)p/=2.;
        p/=2.;
    }
else if (refactorCores==0.) p/=3.;
    float lengthP = length(p);

   // for(float floop = 0.; floop<2.;floop++)

  
vec2 s=p;

                    
        if(seventhEYE>0.&&seventhEYE!=3.&&(lengthP<twoThirds&&length(s)<twoThirds)&&zoom<.5
 //&&lfc>zoom
 )
{
    s=1.5/(2.5-vec2(-s.x,abs(s.y)+budge//plus one third is optional
    ));//this needs some exploration//here needs activation and new hotkey
    if(seventhEYE==2.)s=vec2(s.y,abs(s.x));//more sign checks may help
   // try signs and swizzle!
}
            
                                /*makes for a pretty fractal with odd symmetry
                                if(true)
                                {
                                    s=vec2((s.x+sign(s.x))/2.,(s.y+sign(s.y))/2.);
                                    
                                }
                                 */
float c = length(s);
float scale = 1.;
float coresIn = 0.;
const float crs = 64.;//this is the mandelclover and original inheritance colormode core range
// if(c>4./3.){s/=2.;c/=2.;}//Engage one UpCore, the rest of zoom cycle in StarshipMod.js
 float centerslide = 0.;
 float lfcOverZoom = lfc/zoom;
// if(lfc>zoom&&seventhEYE!=3.)
 for(int i=0;i<int(crs);//crs+3=63
                  i++)if(c<twoThirds
                         &&loops+centerslide<cored//&&(lfcOverZoom>twoThirds||seventhEYE!=3.)
                         )
                        {
                         
  if(i>1||!cloverSlide){s*=2.;c*=2.;scale*=2.;}

  if (cloverSlide)
    {
        
        /*if(refactorCores>0.)
        {
        if(loops+centerslide>cored-1.)
        
            centerslide-=c*2.;
        else
        centerslide-=c/4.;
        }
        else if()        centerslide-=c*2.;

         */
        centerslide-=c/2.;

        }

                      loops++;coresIn++;
                        }
                  
 else break;
 float lfcCenterCored=lfc*scale;

       if(seventhEYE==3.&&(lengthP<twoThirds)&&zoom<.5
 //&&lfc>zoom
 )
{
    s/=4.;
    s=1.5/(2.5-vec2(-s.x,abs(s.y)+budge//plus one third is optional
    ));//this needs some exploration//here needs activation and new hotkey
    if(seventhEYE==2.)s=vec2(s.y,abs(s.x));//more sign checks may help
   // try signs and swizzle!
}


 bool inCenterCore =c<twoThirds;
 if(cloverso)
 {
     float outerMargin =atan(s.y,s.x);

     s=
(-vec2(-sin(outerMargin),-cos(outerMargin)).yx*2.-(s));

}
// if(refactorCores!=1.){s*=(1.+lfc/2.);c*=(1.+lfc/2.);}

if(refactorCores>1.){
    float shift = (1.25+.5*zoom/(zoom+lfc));//centered at 1.5, just a guess really
    s*=shift;c*=shift;
}
else if (refactorCores==0.){//for double slide core
    s*=1.5;c*=1.5;
}

   //if(0==1&&seventhEYE>0.&&zoom<.5&&(lengthP<2./3.))
 //   s=1.5/(2.5-vec2(-s.x,abs(s.y)+1./3.));//this needs some exploration//here needs activation and new hotkey
    

if(fieldPowerBoost){
    float powerBoost =eConstant*(log(.5)/length(s));
    s*=pow(length(s),powerBoost);
}

 coresIn+=upCoreCycler;
//  else if(zoom>1.)for(int i=0;i<int(crs); i++)if(c>4./3.&&loops<-cored){s/=2.;c/=2.;loops++;coresIn++;}else break;//UpCore not in use here, but rather in the starshipMod
//for(int i=0;i<int(crs); i++)if(c<twoThirds&&loops<cored){s*=2.;c*=2.;loops++;coresIn++;}else break;

if(SPHEREofTheLORD)s *= (length(s)-zoom/lfc/2.);

if(squareClover)s/=vec2(sqrt(2.-s.x*s.x),sqrt(2.-s.y*s.y))/s;

float dstnce = length(s);//"distance" may be reserved keyword


vec2 pCenterCored=s;


   float lpcc=length(pCenterCored);
   float lpcc2=lpcc*lpcc;

vec2 pcs=vec2(0.);
if(clvrVariant7)pcs=vec2(
           pCenterCored.x*pCenterCored.x*pCenterCored.x  - 3.*pCenterCored.x*pCenterCored.y*pCenterCored.y,
          -pCenterCored.y*pCenterCored.y*pCenterCored.y+ 3.*pCenterCored.x*pCenterCored.x*pCenterCored.y
          );





//float CORE_DELIMITER=1./1.3247179572447460;// /(1.618033988749+.618033988749);

   /*if(morph<.5)
   CORE_DELIMITER=1./1.32471795724474;//try different truncations of  -1.3247179572447460259609088544780973407344040569017333645340150503028278512455475940546993479817872803299109209947422074251089026390458977955943147570967234717541668390388674187517369315842535499082466223545337273504589879909568150627745509802486213012169894157524574548625075626524610368938904839932269952074975962828868556908150704513696109853352577281586033441141927828273765296032993584674231028483241695239006108543338219;
else {
CORE_DELIMITER=twoThirds;//t*=1.5;
}
*/
loops=0.;
float hyperCore=0.;







//.9551195 is based on 1./log(3.)==0.910239 So (1.-.910239)/2+.910239=.9551195 May be incorrect but is close to right.
//log stabalization constant seems to be 1./log(3.)+(1.-1./log(3.))/1.5 from 1./log(3.)+(1.-1./log(3.))/2.
//if(morph!=0.)cored*=3./2.;//stabilize morph dance collaboration

//2.47805268028830 and 3 are solutions to x=log3(x**3)
//float  CORE_DELIMITER=texture2D(coreTextureSampler,vec2(floor(hyperCore)/40.,0.)).x;




   float dif = 1.;//3.-(1.-.47805268028830)/3.;
if(MetaCored)hyperCore=
   cored* 
   //(-cored*gr*leaf)//this is the core slider this dilates central core across metacore//here could use a hotkey//does it do anything useful?
   twoThirds/squeezeN+log(lfc*squeezeN)*logStabilizationConstant;
else hyperCore=externalCores;//hyperCore is really better thought of as hyperMetaCore

//cored/1.5+log(length(coordSHIFT))*logStabilizationConstant+uber.z;
//float  CORE_DELIMITEReq=texture2D(coreTextureSampler,vec2(floor(0.)/40.,0.)).x;
float equilibriator = 1.;
if(dilate){//should be re-enabled after checks
if(lfc/zoom>1.5)
equilibriator=lfc/(lfc-zoom/dif)*dif;
   //this is to allow top level core freeze for original clover
 
   hyperCore*=equilibriator;
   }
   
    // hyperCore-=.441*LogHalfReciprocal/equilibriator;
     
    // hyperCore-=coreDilation;
  //  if(cloverSlide&&wheel)hyperCore+=1.75*LogHalfReciprocal;

 //if(chop) hyperCore-=.25*LogHalfReciprocal;//1./(7.*log(.5));
 if(feedTheLamb)  {
     hyperCore-=.25*LogHalfReciprocal;
     }
    // if(distributor)     hyperCore+=.25*LogHalfReciprocal;


   if(clvrVariant4!=0.&&OrthoEvery==0.)
   {
       if(!feedTheLamb) hyperCore-=.4*LogHalfReciprocal;//1./(7.*log(.5));
    if(cloverSlide)hyperCore+=.5*LogHalfReciprocal;
    //if(wheel)hyperCore-=0.*LogHalfReciprocal;
   // if(morph!=0.)hyperCore+=2.5*LogHalfReciprocal;

}
   else {
    if(cloverSlide)hyperCore+=.5*LogHalfReciprocal;
    if(wheel)hyperCore-=1.*LogHalfReciprocal;
    if(morph!=0.) hyperCore-=1.*LogHalfReciprocal;
    if(Spoker&&spokelover&&dilate) hyperCore-=.0*LogHalfReciprocal;
    //else if (dilate)hyperCore-=.5*LogHalfReciprocal;
    if(clvrVariant2)hyperCore+=1.*LogHalfReciprocal;

}
      // if (dilate)hyperCore-=LogHalfReciprocal/2.5;//for freed dilation
   //  if(OrthoEvery!=0.) hyperCore+=1./OrthoEvery;//for freed dilation

   if(multiplicatorNexus)hyperCore-=.5*LogHalfReciprocal;
   if(continuumClover!=0)hyperCore+=.25*LogHalfReciprocal;
  /*if(polyNomialStretch&&OrthoEvery==0.)
   {
   if(!(seventhEYE>0.)||lengthP>2./3.    )   hyperCore-=.5*LogHalfReciprocal;
    else
     hyperCore-=.125*LogHalfReciprocal;//for central polynomial

   }
   */
if(polyNomialStretch&&OrthoEvery==0.)
{
   if(budge==1./3.)//I was flying into what I think was the top of the center clover around commit 8c6a4aae1986bddb05af5d8026505c63dd0ed8be when I had a feeling like faith was shaping the clover, then a black and blue biogenesis clover (I wasn't in biogenesis!)upcored and cored and I flew into it, Then I had a screen full of free floating tripolar clovers that seemed to extend forever in all directions fitting this same type of clover together.  Then after a minute the screen rotated and became half rez and half size.  The zoom in the dimension was a constant 1
   {
   if(seventhEYE==0.||lengthP>twoThirds  )  
   hyperCore-=.5*LogHalfReciprocal;
    else hyperCore-=.125*LogHalfReciprocal;//for central polynomial

   }
   else 
   {
     hyperCore+=.5;
 //  if(seventhEYE>0.||lengthP>twoThirds)hyperCore+=1.;
  // //else hyperCore+=lfc/log2;
   }
}

   if(seventhEYE>0.&&lengthP<twoThirds
   )
   {
    if(budge==1./3.)
    hyperCore-=2.25*LogHalfReciprocal;///squeezeN;//for central polynomial
else{
      float squinch =0.;
    if (seventhEYE==3.)
     squinch = pow(lpcc/4.-sqrt(lfc*zoom),1./squeezeN);
     else      squinch = pow(lengthP-sqrt(zoom),1./squeezeN);

 if(squinch>.0) 
   hyperCore-=log(abs(squinch));
   else
  hyperCore+=(8.*log2/squeezeN);
  if(seventhEYE==3.)hyperCore+=(squeezeN)*log2/2.;
  //hyperCore-=.25;
  if(!polyNomialStretch)hyperCore+=log2*1.5;
}

   }

bool spokeloverON=spokelover&&zoom/lfc<1.;//could be 1.5, could be 2/3, one is a compromise
     if(spokeloverON)hyperCore-=log2;



   //if(abs(coords.y)>1.)hyperCore+=1.*LogHalfReciprocal;
 // if(petals!=0.)
    // if(squeezeN>1.)hyperCore-=1.25;


      //  hyperCore-=1.;



//if(fieldPowerBoost)hyperCore+=1.*LogHalfReciprocal;
   
if(outerCoresOff)hyperCore=0.;

if(Spoker)
hyperCore*=4./3./(1./log(3.)+(1.-1./log(3.))/1.75);//engage overstable core if dancing log terms based on logStabilizationConstant may or may not be accurate
 //if(morph>.5&&!wheel)hyperCore+=4.;
 float term=0.;

vec2 m=vec2(0.);

float truncator=1.;
bool truncated = true;
if(zoom!=0.&&lfc!=0.&&truncated)
{
truncator =log((lfcCenterCored))*-leaf/2.;//*100//log((lfc*lfc)/(zoom*zoom))

}
//pow(abs(log(zoom/lfc),2.);//log truncation * factor is not known, may no longer be necesary
//Maendel clover

//this is essentially just p as in the mandelbrot x <== x^2+

                            const float iterations = 40.;//loops all escape delimiter so iterations aren't used unless needed
                            float refractelC=1.5;
                        //  p*=2.*refractelC;
vec3 oo = vec3(0.);
 float continuumCounter=0.;

                            vec4 starship=vec4(0.);
                            vec4 sevenSuns=vec4(0.);
                            
                            float minToMax=min(resolution.x,resolution.y)/max(resolution.x,resolution.y);
                            vec2 dimensionFix=min(resolution.x,resolution.y)/resolution;
vec3 beta =vec3(1.);




//t*=.74;
float coreBooster=0.;
float metaCoreDriveFactor =(((1.-leaf)/truncator)*truncator)/gr;//.324717.... number of places changes appearance
                             float twoGRthreeLeaf=(((-2.*gr-3.*leaf)/truncator)*truncator);
float spoke_factor =metaCoreDriveFactor*twoGRthreeLeaf;//metaCoreDriveFactor*(((-2.*gr-3.*leaf)/truncator)*truncator)
                            // float   grOverLeaf=-((gr/leaf)/truncator)*truncator;//uncertain term
                             float grPlusOneOverLeaf=(((1.+gr)/(-leaf))/truncator)*truncator;
float spoke_factorLarge =spoke_factor*grPlusOneOverLeaf;
                                                      float upSpoke=spoke_factorLarge; //grPlusOneOverLeaf/-pow(spoke_factor/-leaf,-leaf-1.);//somewhat uncertain of a value

                                                      //pow(spoke_factor,(-leaf/gr)/truncator)*truncator)*(((1.+gr)/-leaf)/truncator)*truncator;
                          //   float upSpoke=pow(spoke_factor,((-leaf/gr)/truncator)*truncator)*1.5;//pow(spoke_factor,leaf);//seems to have many likes
                                                      float        oneOverLeafTruncatedFactor=1.;
                           if(  OrthoEvery!=0.)oneOverLeafTruncatedFactor=1./leaf;
                                                      else
                                                      oneOverLeafTruncatedFactor=clvrVariant4;
                                                      
                                                     float oneOverLeafTruncated=(oneOverLeafTruncatedFactor/truncator)*truncator;
                                                      //-0.748693232289164237654969328
                                                      //-0.755558243034340;
                                                     //((1./leaf)/truncator)*truncator;
                                                      //https://www.wolframalpha.com/input?i=a%3D%28%281-%28%281-%28%281-%28%281-%28%281-%28%281-%28%281-%28%281-%28%281-%28%281-a%29%5E2-1%29%29%5E2-1%29%29%5E2-1%29%29%5E2-1%29%29%5E2-1%29%29%5E2-1%29%29%5E2-1%29%29%5E2-1%29%29%5E2-1%29%29%5E2-1%29
            float downSpoke=oneOverLeafTruncated;//1./(((-leaf)*truncator)/truncator)/4.;
                              float spoked =1.;////spoke_factorLarge;
            float   spokedD=upSpoke*spoked;                         
                               float   spokedU=downSpoke*spoked;                         
              //vec2 coordsAltered=coords/gr;
               
                   float variant4Correction=1.;
                                                           if(clvrVariant4!=0.&&OrthoEvery==0.)variant4Correction=(1.-oneOverLeafTruncated);
                                                           float correction = zoom/(zoom-lfc*variant4Correction);

               if(wheel)m =  ((pWithoutChiralizer/lfc)
                                                        -coords.yx*2.*variant4Correction)*abs(coresIn/crs*2.-1.)
                                           *mandelCloverFactor//(1.-1./(leaf/truncator)*truncator)//uncertain term
                                           ;
                         
       //     float logOfSpoke_Factor = 0.;
       //     if (wheel) logOfSpoke_Factor=log(spoke_factor);
                             
float hyperCoreOUTPUT =hyperCore*log2/log(metaCoreDriveFactor)+loops;
float omniboost = (6.+petals)/6.-1.;
if(petals>0.)omniboost=sqrt(omniboost);
                                                       hyperCoreOUTPUT-=omniboost;//upcore for higher omniclover counts, multiplied by two!!

                                                           float hyperCoreBoosted = hyperCoreOUTPUT;//if metaCoreDriveFactor==1.5: hyperCoreBoosted=hyperCore*1.75 else if
                          //   hyperCoreBoosted-=(6.+petals)/6.-1.;//upcore for higher omniclover counts
                        
                             //metaCoreDriveFactor==2.: hyperCoreBoosted=hyperCore;
                                                           
                                                        
float colorShift = 0.;
vec2 multCrossTwist=vec2(0.);
if(multiplicatorNexus&&dstnce!=0.)//doesn't seem to upcore spokes like intended
{
     multCrossTwist=spin2(s,atan(s.x,s.y)*1.5*petals/(6.+petals))*sign(.5-morph)//*equilibriator/CORE_DELIMITER
     /dstnce;
            multCrossTwist*=multCrossTwist;
                          coreBooster=length(multCrossTwist)*LogHalfReciprocal*lfc;

    
}
                          
                          
                          
                             //if(zoom<.00000075)
                             //if(zoom<.00000075)
                        /*  hyperCoreBoosted=uber.z+
                            (
                             log(duperZoom)*LogHalfReciprocal*twoThirds+log(length(coordSHIFT))
                             *4./3./(1./log(3.)+(1.-1./log(3.)  ))/1.75
                             )*log2/log(metaCoreDriveFactor)+loops;
                             */
                             dstnce=length(s);
                                                           
                         //    if(0==1&&dilate){
    /*  float dilation = dstnce*variant4Correction;
                             hyperCoreOUTPUT-=dilation;//dilate clover shift
                             hyperCoreBoosted-=dilation;//maybe times 1.5     */
     //   float sliceanddiceBoost=mod((atan(p.y,p.x)+chiralAdjustment)*divideByMultiplyingPi2*6.+1.5,1.)*log(dstnce);
     //  sliceanddiceBoost=sign(sliceanddiceBoost)*pow(abs(sliceanddiceBoost),2.);
    //hyperCoreBoosted-=sliceanddiceBoost;
   //  hyperCoreOUTPUT-=sliceanddiceBoost;
     
//}
   

                            float initialHyperCoreBoosted = hyperCoreBoosted;
                                       float colorComputationBoost =7.;//increasing number decreases processing and clarity
                                       float baseDelimiter =50.;//colorComputationBoost=7 and baseDelimiter=50
       float delimiter = baseDelimiter;
       if(colorCombo==-1&&Inherited)delimiter=baseDelimiter/colorComputationBoost;
                                                          float base=baseN;
  //if(abs(baseN-2.701002244)<.00001)base=(baseN/truncator)*truncator;
                                                           float loopSolid = 0.;
                                                           //dstnce=length(s);
                                                          /*
                                                        if(clvrVariant2) {
                                                            s/=2.;dstnce/=2.;
                                                            //hyperCoreBoosted++;
                                                            //hyperCoreOUTPUT++;
                                                            }
                                                           */
                  /* if(superStable)
                   {
                              s/=2.;dstnce/=2.;
                                   
                                 
                              }
                   */
                                                      
                                                                                         float  logStabilizationConstantB=0.;
                                                                                         float leafDivGR = 0.;
                                                      float OrthBoost =0.;

                                                                                   if(OrthoEvery!=0.){
                                                      /*  logStabilizationConstantB=logStabilizationConstant+(1.-logStabilizationConstant)/2.;*/
                                                       leafDivGR =leaf/gr;
                                                     // float multiplier = 2.;
                                                   //  if(clvrVariant4!=0.&&1==3)
 //OrthBoost =-leaf;//(1.-1./leaf)*logStabilizationConstant;
 //else
 {OrthBoost=log(3.);//1./logStabilizationConstant;////the values for orthBoost seem incorrectish
                     
                     
                                         hyperCoreBoosted-=4.*LogHalfReciprocal;
                                         hyperCoreOUTPUT-=4.*LogHalfReciprocal;
                     }
                     //log(3.);//4./3./log(3.);
                                                  /*   if(OrthoEvery==1.&&1==3)
                                                     {
                                                     hyperCoreBoosted*=OrthBoost;//1.75/log(3.);
                                                     hyperCoreOUTPUT*=OrthBoost;}*/
                                                      }
                                                      
                                                      bool compensate=false;
                                                    //  float  logStabilizationConstantA=logStabilizationConstant;//+(1.-logStabilizationConstant)/2.;
                                                     // float  logStabilizationConstantC=log(3.);//+(1.-logStabilizationConstant)/2.;
                                                      vec4 eyeScroll= vec4(0.);
                                                      vec2 lastLastS = s;
                                                         vec2 lastS = s;

        hyperCoreBoosted*=squeezeN;
        hyperCoreOUTPUT*=squeezeN;
    float OmniDynamicPetalShift =0.;//texture2D(omniDynamic,vec2((loops+counter)/40.,0.)).x;
     float OmniPetal =OmniDynamicPetalShift*((petalNumber)/6.);
    
  float  CORE_DELIMITER=texture2D(coreTextureSampler,vec2(0.//floor(loops+counter)/40.
  ,0.)).x;
vec2 window =s;
bool gatedPass=false;
float daisifier = 0.;
if(zoom<.00000075*lfc)  s = uber.xy;//engage super duper core!

else      for (float counter=0.;counter<iterations;counter++)if(dstnce<delimiter){

 if(petals>0.&&squeezeN>=2.) 
 {
  hyperCoreBoosted+=pow((petalNumber/6.-1.), 2.)*3.-squeezeN*2.;//coefficient on squeezeN varies

 }

   //      if(multiplicatorNexus)hyperCoreBoosted = hyperCore+coreBooster*dstnce;

                           // if(!true&&morph<.5)CORE_DELIMITER=1./dstnce*pow(2.,4./12.)*equilibriator;
                            
  // if( loopSolid>=hyperCoreBoosted+1.||inCenterCore){//||lengthP<twoThirds){//so it doesn't run until it needs to, hopefully working
  dstnce = length(s);


       if(spirated!=0.&&dstnce<twoThirds)//CORE_DELIMITER)  //works well<(n-1)/n
s*=dstnce*2.*PI/(atan(s.y,s.x)-PI*spirated);


//vvvvbelow should be added at some point
//float whirlpoolMeta=1.;
//if(counter>0.)s=spin2(s,whirlpoolMeta*dstnce*.75/3.*PI);

dstnce = length(s);
if(dstnce<twoThirds){
window = s;
gatedPass=gated;
bubble=dstnce;
}

//}
   colorAccumulator+=s;
   if(Refractelate&&dstnce>refractelC){s/=refractelC;} //refractelC/=4./3.;}
   if((counter==1.&&oppositionalCoreFlop==1)||oppositionalCoreFlop==2)
   {
   // if(mod(counter,2.)==0.)
   //s=spin2(s,PI);
   // else 
       //if(morph==0.&&petals==0.)
//s=spin2(s,PI);

if(morph==0.)  s*=-1.;

else s=spin2(s,PI);
   }
   lastLastS=lastS;
   lastS = s;//before or after flop?

//if(mod(counter,2.)==1.&&colorCombo==0)s =abs(s);//supposed to make clover brighter and nothing else?;
float superUpcorer = 0.;//before or after flop?
if(feedTheLamb){superUpcorer =
    -1.+1./((abs(mod(atan(s.y,s.x)/PI2+1.//+.5/petalNumber
,1./6.)-.5/6.))*petalNumber*6.*2.)+ length(s)/log2*petalNumber/6./2.;
;
if(petals>0.)
{
    float superUpcorerboost=pow(petals,clamp(squeezeN-1.,0.,1.));//was pow(petals,clamp(squeezeN-1.,0.,1.))
  //  if (squeezeN>=2.) superUpcorerboost+=squeezeN;
    superUpcorer*=superUpcorerboost;
}
hyperCoreBoosted-=superUpcorer;
hyperCoreOUTPUT-=superUpcorer;

}

 if(counter!=0.&&dilate&&morph==0.&&OrthoEvery==0.){
                 /* float sliceanddiceBoost=mod((atan(s.y,s.x)+chiralAdjustment)*divideByMultiplyingPi2*6.+1.,1.)*dstnce*dstnce;
                  sliceanddiceBoost=sign(sliceanddiceBoost)*pow(abs(sliceanddiceBoost),.5);
              hyperCoreBoosted-=sliceanddiceBoost;
               hyperCoreOUTPUT-=sliceanddiceBoost;
                  */
                float dst = length(s);
                  dst=sqrt(dst);//sqrt(dst);
               hyperCoreBoosted-=dst;
                hyperCoreOUTPUT-=dst;
              // hyperCoreBoosted-=dstnce;
               // hyperCoreOUTPUT-=dstnce;

               
       }

   s=vec2(
        s.x*s.x*s.x  - 3.*s.x*s.y*s.y,
       -s.y*s.y*s.y+ 3.*s.x*s.x*s.y
       );

       if(//zoom<.5&&
counter==0.&&
polyNomialStretch
&&OrthoEvery==0.
     //  &&lengthP<twoThirds
){
    if  (budge==1./3.)  s*=lfc/2.+1./4.;
    else
    {
float span=0.;
if(seventhEYE==3.)
    {
        if (lfc<twoThirds)span = lfcCenterCored/2.;
        else span = lfc+.5;
    }
else if(seventhEYE==0.)span = lfcCenterCored;
else span = lfc;
float stretch=pow(pow(span+.5,.5),1./squeezeN);

    if(seventhEYE==0.||lengthP>twoThirds)
      s/=stretch;//maybe other values work?
     else s*= stretch;
}
}


      // if (mod(counter,5.) == 4.)s =pCenterCored;
       //x**3

      // dstnce=length(s)
       if(chop&&dstnce>twoThirds)s=spin2(s,floor(dstnce)*PIdiv2);

      
       


       if(clvrVariant9) s+= coords*gr;

        if(clvrVariant7)s+=pcs;
        

        if(clvrVariant1)  s*=length(lastS);
      // if(counter==0.){ s/=2.;dstnce/=2.;}

        
        /*variants 2356 disabled for some android devices to load properly
      if(clvrVariant3)s-=pCenterCored*dstnce;
     if(clvrVariant2)if(s.x!=0.&&s.y!=0.&&coords.x!=0.&&coords.y!=0.){
          vec2 cb=coords.yx;
          vec2 coordClover=vec2(
                                cb.x*cb.x*cb.x         - 3.*cb.x*cb.y*cb.y,
              -cb.y*cb.y*cb.y+ 3.*cb.x*cb.x*cb.y
              );
          vec2 modifier=coords.xy*coords.yx*(1.-abs(coords.yx))*(1.-abs(coords.xy))/abs(s)/coordClover.yx*coords.y;//*abs(coordClover.x);//coords.xy*coords.yx*(1.-oneOverLeafTruncated);
          s-=modifier;
         // hyperCoreBoosted-=length(modifier);
          }
           */
                                       /*
        if(clvrVariant0)
        {
        if(mod(counter,2.)==1.)     s=vec2(pow(s.x,.5)*sign(s.y),pow(s.y,2.)*sign(s.x));
        else   s=vec2(pow(s.x,2.)*sign(s.y),pow(s.y,.5)*sign(s.x));
        }
                                   */
                                       
        if(clvrVariant4!=0.&&OrthoEvery==0.) s*=1.-oneOverLeafTruncated;

        /*
  if(mod(counter,2.)==1.)   s=vec2(pow(s.x,2.)*sign(s.x),pow(s.y,.5)*sign(s.y));
else s=vec2(pow(s.x,.5)*sign(s.x),pow(s.y,2.)*sign(s.y));
  */
                                            /*

     if(clvrVariant2) {
         if (clvrVariant4) s*=1.5;
        else {
            s*=2.;
            
             hyperCoreBoosted++;
             hyperCoreOUTPUT++;
             }
         }
                                             */
     /* if(clvrVariant5)if(length(s)>0.) s = vec2(pow(s.x,-2.),pow(s.y,-2.));
      if(clvrVariant6)s=s-lastS.yx;
*/
     if(clvrVariant8) if(length(s)<1.)s+=1.;

       //if(dotted)s/=dot(-m,t)*dot(m,-t);
       if(morph==1.&&!wheel)s-=t;

     //  else if(morph==2.&&!wheel)s+=t;
       else s+=t-m;
                             
                             
       if(Clovoid)s.x=(sqrt(2.*abs(1./s.x)));//this is the body steps on the clover
       else if(colorCombo==8||colorCombo==9)s.x=-1./s.x;//this is just the face (without or with +c), inheritance is the only
   
  // dstnce = length(s);
   
   s.x=log(abs(s.x))/log(base);


          dstnce = length(s);

//if(dstnce<2./3.)s=1./(2.+abs(s));//this needs some exploration here


             
   //float trunc=1.;
   //if(lfc!=0.) trunc = log(zoom/dstnce)/100.;
 //  s=vec2(-1./(s.x*s.x-s.y*s.y-p.x),2.0*s.x*s.y-p.y);

   float OrthOnTop = counter;//+1;??

    if(1==1&&(OrthoEvery!=0.&&((OrthoEvery<1.&&mod(-.5+OrthOnTop,1./OrthoEvery)>=1.)||
                             (OrthoEvery>=1.&&mod(OrthOnTop,OrthoEvery)<1.))))
    {
        compensate=true;
       // float logStabilizationConstantA=logStabilizationConstantB;
       // logStabilizationConstantB=logStabilizationConstantB+(1.-logStabilizationConstantB)/2.;

   float angleToLittleClover =atan(lastS.x,lastS.y)-mod(atan(lastS.x,lastS.y),PI2/6.)+PI2/12.;//PI2/12.*4.;
                                                        
 //  angleToLittleClover*=-1.;
                                                     //   float var4Factor = .5;         //if(clvrVariant4!=0.&&1==3)
                                                                                                                                                                         //var4Factor=1.;

                                                        
   float distanceFromCenter = .5;
//if(clvrVariant4!=0.&&1==3)    distanceFromCenter =length(lastS-vec2(-sin(-angleToLittleClover),cos(angleToLittleClover))*-leafDivGR/(logStabilizationConstantB))/(1.+leafDivGR/(logStabilizationConstantA))/2.;/////may not be exact values, as the center separate from clover;
      
//else
                                                                                                                                                                  distanceFromCenter =length(lastS-vec2(-sin(-angleToLittleClover),cos(angleToLittleClover)));
                                                                                                                                                                  //distanceFromCenter =length(lastS-vec2(-sin(-angleToLittleClover),cos(angleToLittleClover))*(1.+oneOverLeafTruncated));///(1.+oneOverLeafTruncated);
                                                                                                                                                                  //if (distanceFromCenter>.5)
 //distanceFromCenter =length(lastS-vec2(-sin(-angleToLittleClover),cos(angleToLittleClover)));
                                  if(distanceFromCenter<1./3.)//4./3.)
                                  {
                                  s*=distanceFromCenter/length(s)*2.;//var4Factor;//*metaCoreDriveFactor;
                                  //s=vec2(0.);
                                 // hyperCoreBoosted+=pow(distanceFromCenter/length(lastS);
                                  //hyperCoreBoosted*=2.;
                                  //multiplier*=multiplier;
                                  //distanceFromCenter/length(lastS);//distanceFromCenter/length(s);
                                //s=vec2(0.);//
                                //hyperCoreBoosted-=1.;
                                //hyperCoreOUTPUT-=1.;

  //else if (distanceFromCenter>.5&&distanceFromCenter<1.);
                                  }
                                           
    //if(clvrVariant4==0.&&3==3)
                           /*                             {hyperCoreBoosted*=OrthBoost;
    hyperCoreOUTPUT*=OrthBoost;

    }
*/
}else if(compensate&& OrthoEvery!=1.){
    //   hyperCoreBoosted/=OrthBoost;
    //   hyperCoreOUTPUT/=OrthBoost;
       compensate=false;
   }
                                                        
                         // if(OrthoEvery!=0.)
                         // {hyperCoreBoosted*=OrthBoost;
                         // hyperCoreOUTPUT*=OrthBoost;

                        //  }
                                                                                            //else   hyperCoreBoosted+=OrthBoost;
                                                                                                                                              //else

   //float outerMargin =atan(s.y,s.x);
 // s=(-vec2(-sin(outerMargin),-cos(outerMargin)).yx-(s));

  if(petalNumber<=6.) s /=squirgleDynamic[int((mod((atan(s.y,s.x)*6./petalNumber//
                                            +PI2*4.
           +PI/petalNumber/2.
                                            )/PI2
                                            ,1.
                                            )*petalNumber*2.))];
                                           
 // if(petalNumber<=6.)   s /=squirgleDynamic[int(mod((atan(s.y,s.x)+PIdiv2*3.+PI/12.)/PI2,1.)*12.*petalNumber/6.)];
 /*s/=squirgleDynamic[int(mod((atan(s.y,s.x)/((petalNumber)/6.)//
                                            +PI2*4.
            +PI/petalNumber/2.
                                //            *6./petalNumber
                                            )/PI2//*(6.+petals)/6.
                                           // -petals/petalNumber
                                            ,1.// (petalNumber)/6.
                                            )*12.*petalNumber/6.)];
                                            */
   //traditionally be e or 3 probably 1.5 to 4
   if(cellularDivision==1||(cellularDivision==2&&counter>1.))      s=vec2(s.x,s.y-sign(s.y)/2.);

   if(squareGenesis){

       float regenerativeLayers = 3.;
      float x=2.;
          // for(float x=2.; x<3.;x+=1.)
           {
           float regenerativeshift = 1./x;
       s.x-=regenerativeshift;
       s= vec2(s.x-sign(s.x)*regenerativeshift,s.y);
             s= vec2(s.x-sign(s.x+regenerativeshift)*regenerativeshift,s.y);
               s.x+=regenerativeshift;
               }
        //   for(float x=2.; x<regenerativeLayers;x+=1.)
           {
           float regenerativeshift = 1./x;
       s.y-=regenerativeshift;
       s= vec2(s.x,s.y-sign(s.y)*regenerativeshift);
             s= vec2(s.x,s.y-sign(s.y+regenerativeshift)*regenerativeshift);
               s.y+=regenerativeshift;
               }
              
       }
    if(constellation)s=starBirth(s);

   dstnce = length(s);
       if(dstnce<twoThirds)s*=pow(dstnce,squeezeN-1. );
   dstnce = length(s);

if(Spoker){
   // if(morph==0.)
    {
        if(//!wheel
            sqrt(dstnce)*dstnce<=hyperCoreBoosted)//||(wheel&&1.<=hyperCoreBoosted))
                         {

                             /*
                         if(wheel){
                             s/=2.;

                             hyperCoreOUTPUT-=logOfSpoke_Factor;

                             hyperCoreBoosted-=logOfSpoke_Factor;
                             }
                         else {
                              */
                            if(counter==0.)inMainSpoke=true;//this actually seems to be the not spoke part of spoker so boolean should be reversed to be accurate
                           
                            if(distributor)//&&counter!=0.
                            {   if (inMainSpoke)//!inMainSpoke
                              //  s=spin2(s,distributorFACTORorth);
                               // else
                                s=spin2(s,distributorFACTOR);

                                }
                            
                         if(!wheel||1==1) s/=spoke_factorLarge;//engage ; s/=2.+'superspokes'
                          
                         float coreFactor =downSpoke;
                       //  if(!inMainSpoke) coreFactor/=dstnce;
                       
                       
                       
                       hyperCoreOUTPUT-=downSpoke;

                         hyperCoreBoosted-=downSpoke;
                         //}

                         }
                         
        else  {
               if(twelveGates)daisifier=0.;
               else daisifier=1.;

            /*
                if(wheel){
            hyperCoreOUTPUT+=logOfSpoke_Factor;
            hyperCoreBoosted+=logOfSpoke_Factor;
            }
                else {*/
                  //  float correctionSpoke =pow(upSpoke/dstnce,grOverLeaf);//uncertain value
                 s*=spoke_factor;
                 float coreFactor =upSpoke;
                // if(!inMainSpoke)
           //   if(!wheel||1==1)coreFactor/=(1.+dstnce);
            hyperCoreOUTPUT+=coreFactor
            ;
            hyperCoreBoosted+=coreFactor;
           // }
            }
}
/*else//for dancer only
{
   
hyperCoreOUTPUT-=spoke_factor;
hyperCoreBoosted-=spoke_factor;}
 */
   }
//dstnce=length(s);
if(spokeloverON)
{
      float dstnceSquaredRooted=dstnce*dstnce*sqrt(dstnce) ;
float powerOfSpokeCore =spoke_factorLarge*dstnceSquaredRooted;//*lfcCenterCored/dstnce;// uncertain value,takes large range, highly responsive on spokes PI*PI/gr*-leaf has nice outer main spokes


        float       spokeloverCoreShiftUp  =   pow(abs(downSpoke),powerOfSpokeCore);//  spokedU;//spokedU;// 
     float spokeloverCoreShiftDown= pow(upSpoke,powerOfSpokeCore);//spokedD;//  


if(counter+dstnceSquaredRooted//+dstnceSquaredAndRooted//sqrt(sqrt(dstnce)*dstnce)*dstnce
   <hyperCoreBoosted
   &&!isinf(spokeloverCoreShiftUp)
 ){
   //  if(continuumClover) s*=sqrt2;//engage shiny spokelover
     //else

    // if(distributor) s=spin2(s,distributorFACTORlove);
     if(distributor)
     {   if (inMainSpoke)
        // s=spin2(s,distributorFACTORloveORTH);
         //else
         s=spin2(s,-distributorFACTORlove);

         }

 //  if(counter!=0.) 
  // { 
   // s/=sqrt2*twoThirds;
       //  spokeloverCoreShiftUp  =   spokedU;//   pow(abs(downSpoke),powerOfSpokeCore);
  // }

   //  else if (!inMainSpoke){
        s/=sqrt2;
    // spokeloverCoreShiftUp*=2./3.;
     //}
    //     {
    //       s/=1.5;
       //      spokeloverCoreShiftUp  =    pow(abs(downSpoke),powerOfSpokeCore)*logStabilizationConstant;

     //    }

     if(!wheel||1==1){
     //float b =pow(pow(abs(downSpoke),powerOfDynamicSokeCoreUp),grOverLeaf);
    // dstnce=length(s);

 //    float coreFactor =spokeloverCoreShiftUp;
    // if(!inMainSpoke) coreFactor/=dstnce;
  hyperCoreOUTPUT+=spokeloverCoreShiftUp;
  hyperCoreBoosted+=spokeloverCoreShiftUp;
  }

     }

else if(!isinf(spokeloverCoreShiftDown))
//if(  0.>=hyperCoreBoosted)
{
           daisifier+=1.;

   // if(true||counter!=0.) {
             //    spokeloverCoreShiftDown=spokedD;//pow(upSpoke,powerOfSpokeCore);

    s*=sqrt2*twoThirds;
   // }
    //else {
   // s*=sqrt2*twoThirds;
       // spokeloverCoreShiftDown=pow(upSpoke,powerOfSpokeCore)*logStabilizationConstant;
   // }
    // dstnce=length(s);

    if(!wheel||1==1)
    {


       // float coreFactor =spokeloverCoreShiftDown;
      // if(!inMainSpoke)
     //  coreFactor/=dstnce;
              hyperCoreOUTPUT-=spokeloverCoreShiftDown;
              hyperCoreBoosted-=spokeloverCoreShiftDown;
             }
    }
 }

dstnce=length(s);
   if(continuumClover!=0&&lfc!=0.){//engage continualization
       float continuumCore=(continuumCounter+hyperCoreBoosted)*correction;

       float cc2 =continuumCore;
       if(seventhEYE==0.)cc2*=(continuumCore);

       if(loops<=continuumCounter+hyperCoreBoosted)
       {
                 //   daisifier=0.;
          //  daisifier+=counter;

       //   if(dstnce<twoThirds) s-=length(coords.yx)*correction;
       //float dstlpcc = dstnce*lpcc;//(9./16.);
       //if(feedTheLamb)dstlpcc*=.5;
      // float dstADJUSTED = dstnce;
      /*  float deDistortion = sqrt(dstlpcc)*sqrt(dstnce)*sqrt(lpcc) *lpcc2;
      if(dstlpcc<16./9.)
       deDistortion*=(1.-((dstlpcc*9./16.)));//*2.?:
       */
      //float deDistortion = sqrt(sqrt(dstlpcc*9./16.)*sqrt(dstnce*3./4.)*sqrt(3./4.*lpcc)*sqrt(1.-3./4.*lpcc));
 // pow(
  //  sqrt(  dstlpcc*9./16.)//,2.)
  ;//*9./16.;//was sqrt(deDistortion)//why would dstnce*9/16 be right over 3/4? if so wouldn't 5/8 (10/16) be just slightly in recognition that really it should be 3*4 (12/16)? And yet 9/16s on the inner main spoke
                  float superBoostedContinuation = pow(.5,cc2)*dstnce;//*sqrt(dstnce);
   
  if(continuumClover==2)superBoostedContinuation*=superBoostedContinuation;//different solutions to sqrts squares and number of deDistortions may be viable//may be (and was before 1.-dstlpcc*9./16.) deDistortion**2 (or perhaps under circumstances just deDistortion?)
           //coords.yx*coords.yx*vec2(sign(coords.y),sign(coords.x))

           s/=pow(1./lpcc,superBoostedContinuation);
         
      hyperCoreBoosted+=cc2;//continuumCore
       hyperCoreOUTPUT+=cc2;
        
       }
       else
{
//s+=coords.yx*correction;
//if(dstnce>twoThirds)s+=correction/(coords.yx-vec2(sign(coords.y),sign(coords.x))*twoThirds)*2.;

//if(dstnce<twoThirds)s-=length(coords.yx)*correction;
//if(dstnce<twoThirds)s-=dstnce;
   // float cc2 =continuumCore*continuumCore*lpcc2;

          
      hyperCoreBoosted-=cc2;//continuumCore
       hyperCoreOUTPUT-=cc2;
          
           
       }

    }
 //  if(length(s)<twoThirds)starship+=texture2D(STAR,cloverMAPadj)/decayCanceller;
 
   
       
  
dstnce= length(s);

                             //              s*=refactorCores;c*=refactorCores;
                             
                             
                             if(petals!=0.&&dstnce<4./3.)s=spin2(s,atan(s.y,s.x)
                                                                 *(petals)/6.);
                             //if(exponentialPetals!=0.)s=spin2(vec2(s.x,exponentialPetals*s.y),
                                //                                                                                             2.*PI*pow(2.,(xenOctaveFactor-atan(s.x,exponentialPetals*s.y)))/pow(2.,xenOctaveFactor));

                            //if(exponentialPetals!=0.)s=spin2(vec2(s.x,s.y*exponentialPetals),log(atan(s.y*exponentialPetals,s.x)*divideByMultiplyingPi));
                             
                             if(dstnce<4./3. &&exponentialPetals!=0.) s=spin2(s,pow(2.,(atan(s.y,s.x)*divideByMultiplyingPi+1.)*2.));
                             //if(dstnce<4./3.)s=spin2(s,pow(2.,atan(s.y,s.x)));
                              dstnce =length(s);

                       if(dilate&&morph==0.&&OrthoEvery==0.){
                           
                      // hyperCoreOUTPUT-=dstnce;//dilate clover shift
                     //  hyperCoreBoosted-=dstnce;//maybe times 1.5
                   /*  float sliceanddiceBoost=mod((atan(s.y,s.x)+chiralAdjustment)*divideByMultiplyingPi2*6.+1.,1.)*dstnce*dstnce;
t
                       hyperCoreBoosted-=sliceanddiceBoost;
                       hyperCoreOUTPUT-=sliceanddiceBoost;
                     */
                     float factor = dstnce*dstnce*sqrt(dstnce);
                        hyperCoreBoosted-=factor;
                         hyperCoreOUTPUT-=factor;
                       }
                    
                // if(superStable&&dstnce<1.5)
               //   {float b = .5;s*=b;dstnce*=b;
                     // hyperCoreBoosted++;
                     // hyperCoreOUTPUT++;
                      
              //    }
              gated = false;

//dstnce=length(s);
//s*=-1.;cool colors
for(int i=0;i<200; i++)//metacoreloop used to be about 40 before squeezeN
if((dstnce<CORE_DELIMITER//||(superStable&&((counter==0.&&dstnce<1.)||dstnce<twoThirds))
    )
    && 0.<=hyperCoreBoosted&&externalCores!=0.)
{
      if(polyNomialStretch&&budge!=1./3.&&OrthoEvery==0.)   {
      //  if (counter==0.)      s=freed(s*8.)/8.;//not sure this does anything, seems to improve vibrancy and vivacity and makes spokes much stabler
//else 
     // s=freed(s*dstnce*lfc)/(dstnce*lfc);//not sure this does anything, seems to improve vibrancy and vivacity and makes spokes much stabler
    // vec2 s2 = vec2(1.);
     s=freed(s*1.)/(1.);///(dstnce*lfc);//not sure this does anything, seems to improve vibrancy and vivacity and makes spokes much stabler
       dstnce=length(s);
      } 

     if(dstnce<twoThirds)
     {
        float squeezer =dstnce*(pow(2.,squeezeN)-2.);
        hyperCoreBoosted-=squeezer;
    hyperCoreOUTPUT-=squeezer;
     }



   float wise = 1.;
   /*
   if(whirlpool!=0.){
       
       if(mod(float(i),4.)==0.)wise=1.;
       else if(mod(float(i),4.)==1.)wise=-2.;
       else  if(mod(float(i),4.)==2.)wise= -1.;
       else  if(mod(float(i),4.)==3.)wise=2.;
       s=spin2(s,wise*whirlpool*length(s)*.75/3.*PI);
       
}
   */
   

    if(spinTowardsMe) if(float(i)>=hyperCoreBoosted-.5)s=spin2(s,atan(d.y,d.x));

   // if(distributor)s=spin2(s,distributorFACTOR);
       float angleS = atan(s.y,s.x);


        // s=spin2(s,PI*sign(angleS));

        float alternator=1.;
      //  float alternate = -1.;
if((swap==1||swap==3)&&petals==0.)
{
    
    alternator = -(mod(counter-loops,2.)-.5)*2.;
    s*=alternator;
    if(swap!=3)
    {
      //  float alt2 =        mod(counter-loops,4.);
    if(alternator==1.)
    {s=spin2(s, 1./3.*PI);
//alternate*=-1.;
    }
   // else     if(alt2==3.)s=spin2(s,PI);

else{s*=-1.;
                    angleS*=-alternator;

}

    }
   // if(alternator==-1.)unSwitch= !unSwitch;

    //if(alternator==-1.)s=spin2(s,PI);
    // s*=-1.;
}



if(swap>0&&//counter>1.&&//removes asymmetry
//distributor&&//not quite the same as distributor, but I don't want to add another button
//morph==0.&&
mod(angleS+PI2+PI2/12.*alternator,//try switching signs on pi2/12.
PI2/3.)>PI2/6.) //p*=0.;
{
 //   s=abs(s);
//-s=-(s);
//s*=0.;
//s=spin2(s,PI);//balances inherited colors
   //s=abs(s);
//s=spin2(s,PI);
//s*=-1.;
if(morph==0.)
{
   // s*=alternator;
    
    if(alternator==1.)
    {s=spin2(s,4.*PI/3.);
    }
   // else     if(alt2==3.)s=spin2(s,PI);
else s*=alternator;

}
else s=spin2(s,PI);


//s*=-1.;

if(alternator==-1.)
unSwitch= !unSwitch;
//else
unSwitch2= !unSwitch2;

} 


   float cloverOrDaisyOnTop = daisifier;//may be +0
   if(twelveGates)cloverOrDaisyOnTop=daisifier+1.;

    if(twelveGatesMeta!=0.&&((twelveGatesMeta<1.&&mod(-.5+cloverOrDaisyOnTop,1./twelveGatesMeta)>=1.)||
                             (twelveGatesMeta>=1.&&mod(cloverOrDaisyOnTop,twelveGatesMeta)<1.)))
    {

        float switch2 = mod((angleS*divideByMultiplyingPi+2.)*6.+.5,2.);
    if(switch2>1.)
     {
        s=spin2(s,PI/6.);
           gated=true;
           }

    }

    /*
    if(superStable)
    {
       if(i==0){
          if(counter==0.) {s/=4.;dstnce/=4.;}  else
              {s/=2.;dstnce/=2.;}
                    
                    hyperCoreBoosted+=.5;
                    hyperCoreOUTPUT+=.5;
                  loops-=.5;
                    
                }
            else{
                s*=2.;dstnce*=2.;
                
                hyperCoreBoosted-=1.;
                hyperCoreOUTPUT-=1.;
                loops+=1.;
            }

            hyperCoreBoosted-=.5;;
            hyperCoreOUTPUT-=.5;;
            loops+=.5;;

}
    
  else
     */

    { s*=metaCoreDriveFactor;dstnce*=metaCoreDriveFactor;
        
        hyperCoreBoosted--;
        hyperCoreOUTPUT--;
        loops++;
    }

    //if(float(i)>=hyperCoreBoosted)s-=vec2(-cos(d.y),-cos(d.x))*.5;

//OmniDynamicPetalShift =texture2D(omniDynamic,vec2((loops+counter-.5)/40.,0.)).x;
//OmniPetal =OmniDynamicPetalShift*((petalNumber)/6.);
  if(dstnce<4./3.&&OmniDynamicPetalShift!=0.)s=spin2(s,atan(s.y,s.x)*OmniPetal);
  /*
  float fanLoop = mod(loops,1.);
 float v = atan(s.y,s.x)*fanLoop;
  loops-=v;
  hyperCoreBoosted+=v;
  hyperCoreOUTPUT+=v;
  */
 if (cloverSlide||dynamicOvercore)
   {
       //float bIs =dstnce*sqrt2;
    /* spokes slide
       if(float(i)>hyperCoreBoosted)
       {
           float b = 0. ;

           if(cloverSlide) b = -dstnce;//may not be core stable try b=dstnce for trad
           if(dynamicOvercore) b += 1./(dstnce/(lfc/(lfc-zoom)));
           loops-=b;
           hyperCoreBoosted+=b;
           hyperCoreOUTPUT+=b;
       }
       else{
           
           if(cloverSlide)
           {
               
           float b = 0. ;
b =dstnce/2.;//(*sqrt2);//dstnce/(gr*-leaf);//may not be core stable
           loops-=b;
       hyperCoreBoosted+=b;
       hyperCoreOUTPUT+=b;
}
       }*/
        
       //the above before modifications is below//doesn't work with swap
        if(float(i)>hyperCoreBoosted)
        {
            float b = dstnce;//may not be core stable
            loops-=b;
            hyperCoreBoosted+=b;
            hyperCoreOUTPUT+=b;
        }
        else{
            float b =dstnce/4.;//may not be core stable
            loops-=b;
        hyperCoreBoosted+=b;
        hyperCoreOUTPUT+=b;

        }
        
        
        
        //this is different
        
       /*
      float b =dstnce/1.5;//try dstnce/1.5
       loops-=b;
   hyperCoreBoosted+=b;
       hyperCoreOUTPUT+=b;
       */
   }
   
   if(fieldPowerBoostMeta&&(float(i)>=hyperCoreBoosted)){
       float powerBoost =eConstant*(log(.5)*dstnce*(sqrt2)*twoThirds);
       s*=pow(dstnce,powerBoost);
       dstnce*=pow(dstnce,powerBoost);

   }
  if(metaCarousel!=0.
     &&(float(i)>=hyperCoreBoosted+1.))  {   //this clause establishes that the loop only be run on the last iterational loops, showing some sort of terminal core number as hyperCore-loops-counter maybe
      
      
      
      if(mod(float(i),4.)==0.)wise=1.;
      else if(mod(float(i),4.)==1.)wise=-1.;
      else  if(mod(float(i),4.)==2.)wise= -1.;
      else  if(mod(float(i),4.)==3.)wise=1.;
      
     
        s=spin2(s,time*wise*metaCarousel*(1.+OmniPetal/6.)*rate);
        
        

        }
     
}
else break;

daisifier+=1.;
hyperCoreBoosted--;
hyperCoreOUTPUT--;
                             colorShift+=hyperCoreBoosted;
                //             dstnce = length(s);

                loopSolid++;

            dstnce=length(s);
}else break;

        
  vec2 deSplicedS =window;
   if(lpcc<twoThirds&&length(window)<twoThirds) deSplicedS=pCenterCored;
   if(unSwitch)   deSplicedS*=-1.;//=spin2(deSplicedS,PI);


                       
  if(gatedPass)deSplicedS=spin2(deSplicedS,-PI/6.);

      dstnce = length(deSplicedS);

                          vec2 cloverMAPNeutral = ((spin2(vec2(deSplicedS.y,-deSplicedS.x),-atan(deSplicedS.y,deSplicedS.x)*OmniPetal/(6.+OmniPetal)-atan(d.x,d.y)+PI+chiralAdjustment)));
                                                    
                               vec2   cloverMAP = cloverMAPNeutral+.5;
                                vec2 cloverMAPadj =cloverMAPNeutral*dimensionFix+.5;
                                                   vec2 ColorWheelClover=vec2(0.);
                                                   float cycleShiftChiral = 0.;

        if(NightAndDay){

                ColorWheelClover=(spin2(vec2(deSplicedS.y,-deSplicedS.x),-atan(deSplicedS.y,deSplicedS.x)*OmniPetal/(6.+OmniPetal)+atan(d.x,d.y)+PI2*(6.+2.*flipStar)/12.+chiralAdjustment-twistStar*flipStar));

                float correctionBrueled = 0.;
                if(brelued==-1.)correctionBrueled=atan(-ColorWheelClover.x,-ColorWheelClover.y)-PIdiv2;
                else correctionBrueled=atan(ColorWheelClover.y,ColorWheelClover.x)+PIdiv2;

                if(dstnce<4./3.)
                beta   =  hsv2rgb(vec3(-correctionBrueled*divideByMultiplyingPi2*flipStar,1.,1.));
                //return beta;
        }

                           sevenSuns+=texture2D(videoTexture,vec2(1.-cloverMAP.x,cloverMAP.y))+texture2D(videoTexture2,vec2(1.-cloverMAP.x,cloverMAP.y));

         if(spokesVisualizeColors>0)    if(dstnce<twoThirds||((spokesVisualizeColors==4||spokesVisualizeColors==3)&&dstnce<4./3.)) if(vUv.x!=0.&&vUv.y!=0.&&vUv.x!=1.&&vUv.y!=1.){
                    float decayCanceller=1.;
                    if(spokesVisualizeColors==4||spokesVisualizeColors==3)decayCanceller = 1.5;
                    //if(morph!=0.)decayCanceller=decayCanceller*decayCanceller;
                    

  vec2 deSplicedS2 =window;

                       if(unSwitch2&&(spokesVisualizeColors==1||spokesVisualizeColors==3))   deSplicedS2*=spin2(deSplicedS2,PI);
                       else if(unSwitch&&(spokesVisualizeColors==2||spokesVisualizeColors==4))   deSplicedS2*=-1.;//=spin2(deSplicedS,PI);
  if(gatedPass)deSplicedS2=spin2(deSplicedS2,-PI/6.);

                          vec2 cloverMAPNeutral2 = ((spin2(vec2(deSplicedS2.y,-deSplicedS2.x),-atan(deSplicedS2.y,deSplicedS2.x)*OmniPetal/(6.+OmniPetal)-atan(d.x,d.y)+PI+chiralAdjustment)));
                                                    
                               vec2   cloverMAP2 = cloverMAPNeutral2+.5;
                                vec2 cloverMAPadj =cloverMAPNeutral*dimensionFix+.5;  
                                                     if(eden==0)starship+=texture2D(STAR,cloverMAPadj)/decayCanceller;
                       else if(eden==1)starship+=texture2D(EDEN,cloverMAPadj)/decayCanceller;
                       //*length((vUv-.5)*max(resolution.x,resolution.y)/min(resolution.x,resolution.y));//+texture2D(STAR,cloverMAP);
                            
                           }
                          
              //   eyeScroll= roundEyes(s,vec2(0.));
            if(onehundredfortyfourthousand)
            {
                 
                 int march= int(mod(initialHyperCoreBoosted,4.));
                 float color = 1.;
                 if (march==1||march==3)color = -1.;
                 if(dstnce<twoThirds)
                 {
                     vec2 moveMen =-d.yx*volume/8.;
                   if(march==0||march==3)oo+=color*(sealedMan(deSplicedS*5.,moveMen)+faceFORWARDTWO(deSplicedS*5.+vec2(2.,0.),vec2(0.))*twoThirds);
                   else oo+=color*(sealedWoman(deSplicedS*5.,moveMen)+kissingEagles(deSplicedS*5.)*twoThirds);
                 }
                                          
            }
            vec3 cloverEYES = vec3(0.);
            if (sevenSquared)
            {
                vec2 es = vec2(0.);
                if(volume> zoomOutRatchetThreshold) es=d.yx;
            if(dstnce<twoThirds)cloverEYES=roundEyes(deSplicedS*3.5,es).xyz;
           // if(cloverEYES.r==cloverEYES.g && cloverEYES.g==cloverEYES.b)cloverEYES=vec3(0.);
        }
                  vec2 b = s;
///if(multiplicatorNexus)s*=colorShift/88.8;

                                     if(colorCombo==-1&&Inherited){
                                                    s/=  pow(colorComputationBoost,1./baseDelimiter);
                                                   s.y*= pow(colorComputationBoost,2.);
                                                   s.x*= pow(colorComputationBoost,.5);
                                                                       }
colorAccumulator*=colorComputationBoost;

vec3 o = vec3(abs(s.x)/s.y*sign(s.x*s.y));
                     if(colorCombo==-7) {
    s/=1.1;//base changes have made original orange pale, this corrects
    o=vec3(s.y,s.x/9.5,1.-s.x/12.);
    }
                             else if(colorCombo==0) o=vec3((1.-abs(s.x)/s.y*sign(s.x*s.y)*20.));
   else if (colorCombo==-10)o = vec3(0.);
                     else if(colorCombo==-2) o=vec3(s.y/100.-s.x*s.y/888.+s.y/50000.,s.x/8.-s.y/s.x/2000.,1.-s.x/20.+s.y/50000.);
                     else if(colorCombo==-3) o= vec3(s.x/8.-s.y/s.x/7000.,1.-s.x/16.,s.y/100.);
                     else if(colorCombo==-4) o= vec3(1.-s.x/20.,s.x/8.-s.y/s.x/2000.,s.y/35.-s.x*s.y/888.);
                     else if(colorCombo==-5)  o=vec3(s.y/40.-s.x*s.y/888.,1.-s.x/21.,s.x/6.-s.y/s.x/2000.);
                     else if(colorCombo==-6) o=  vec3(-sin(time*1.)*s.y/100.-sin(time*gr)*s.x*s.y/888.,s.x/8.-sin(time*(-gr+1.))*s.y/s.x/2000.,1.-sin(time*(gr+1.))*s.x/20.);
                    else if(colorCombo==-1) {
                              o=       (1.-(vec3(s.y/125.-s.x*s.y/888.+s.y/25000.,s.x/8.-s.y/s.x/2000.-s.y/25000.,1.-s.x/20.+s.y/25000.)
                                                *vec3(1.-s.x/20.,s.x/8.-s.y/s.x/2000.,s.y/35.-s.x*s.y/888.)
                                                *vec3(s.y/40.-s.x*s.y/888.,1.-s.x/21.,s.x/6.-s.y/s.x/2000.)));//can swizzle this for new colormodes
                                              if(oppositionalCoreFlop==0) o.g*=1.2;//seems to need more green
                                              else if (continuumClover==2)
                                              o.g*=1.1;
                                              if (continuumClover!=2) o.r/=1.05;
                                                }
                                else if(colorCombo==-8) {
                                            s=-colorAccumulator*(coresIn+1.)*((coresIn+2.)/(60.+1.)-.5);

                                            o= (1.-(vec3(abs(s.y)-s.x*s.y/888.+s.y/25000.,s.x/20.-s.y/s.x/2000.-s.y/25000.,1.-s.x/20.+s.y/25000.)
                                                         *vec3(1.-s.x/20.,s.x/8.-s.y/s.x/2000.,s.y/35.-s.x*s.y/888.)
                                                         *vec3(s.y/40.-s.x*s.y/888.,1.-s.x/21.,s.x/6.-s.y/s.x/2000.)));
                                                              }
   else if(colorCombo==-9) {
  //   if(wheel)heartColors=(vec3(s.x*s.y,s.x+.2,s.y-.3*(1.-s.x))+.3)/length(s);

   float colorFlip=-abs(coresIn-crs/2.)*sign(coresIn/crs*2.-1.);
         s=colorAccumulator*(coresIn/crs*2.-1.);

                  o=((coresIn-(crs/2.))/(crs/2.)-vec3(-s.x,s.y,-s.x*s.y).zxy//try swizzling these
                  *sign(crs/2.-coresIn))
                  *(1.-vec3(s.y-s.x*s.y/888.+s.y/25000.,s.x/8.-s.y/s.x/2000.-s.y/25000.,1.-s.x/20.+s.y/25000.)
                               *vec3(1.-s.x/15.,s.x/8.-s.y/s.x/20.,-abs(s.y)/35.-s.x*s.y/100.)
                               *vec3(s.y/40.-s.x*s.y/888.,1.-s.x/21.,s.x/6.-s.y/s.x/200.));
                      }
                      
                      
                    
                      
                      
                      
                      
                      ///
                      else if(colorCombo==-11) o=vec3(s.y/100.-s.x*s.y/888.+s.y/50000.,s.x/8.-s.y/s.x/2000.,1.-s.x/20.+s.y/50000.).yxz;
                      
                      else if(colorCombo==-12) o=vec3(s.y/100.-s.x*s.y/888.+s.y/50000.,s.x/8.-s.y/s.x/2000.,1.-s.x/20.+s.y/50000.).zxy;
                      else if(colorCombo==-13){
                      o=vec3(s.y/100.-s.x*s.y/888.+s.y/50000.,s.x/8.-s.y/s.x/2000.,1.-s.x/20.+s.y/50000.);
                      o=1.-o.yxz*o.zxy*o.yzx;
                      }
                      else if(colorCombo==-14){
                      o=vec3(s.y/100.-s.x*s.y/888.+s.y/50000.,s.x/8.-s.y/s.x/2000.,1.-s.x/20.+s.y/50000.);
                      o=1.-o.yxz*o.zxy*o.xyz;
                      }
                      else if(colorCombo==-15){
                      o=vec3(s.y/100.-s.x*s.y/888.+s.y/50000.,s.x/8.-s.y/s.x/2000.,1.-s.x/20.+s.y/50000.);
                      o=1.-o.yxz*o.zxy*o.xzy;
                      }
                      else if(colorCombo==-16){
                      o=vec3(s.y/100.-s.x*s.y/888.+s.y/50000.,s.x/8.-s.y/s.x/2000.,1.-s.x/20.+s.y/50000.);
                      o=1.-o.xyz*o.zxy*o.yzx;
                      }
                      
                      /*
                      (1.-(vec3(s.y/125.-s.x*s.y/888.+s.y/25000.,s.x/8.-s.y/s.x/2000.-s.y/25000.,1.-s.x/20.+s.y/25000.)
                                   *vec3(1.-s.x/20.,s.x/8.-s.y/s.x/2000.,s.y/35.-s.x*s.y/888.)
                                   *vec3(s.y/40.-s.x*s.y/888.,1.-s.x/21.,s.x/6.-s.y/s.x/2000.)));
                      */
                      if(Inherited)o*=1.-colorAccumulator.x/colorAccumulator.y*3.;
          
                     if(Black)     o-=1.;

                      if(colorInverter==true){
                      o*=-1.;

                      o.r*=-sin(time);
                      o.g*=abs(-sin(time*gr));
                      o.b*=-sin(time*1./gr);
                     
                        }
                                if(remediatedColors)
                                {
                                o/= max(max(o.r,o.g),o.b);
                                 o=o*.5+.5;
                                 }
                      o=beta*o;

                    if(Inherited&& !Inherited&& bubble<2./3.)
                      {
                      float bubbledOut = 1.5*bubble;
                      o-=bubbledOut;
                      //o=clamp(o,0.,1.);

                      }
  float isBlack =1.;//or black
  if (starship.x==0.0&&starship.x==starship.y&& starship.y==starship.z&&starship.w>3.5/255.)isBlack=0.;
                      
                      float isGrey =0.;

                      if (starship.x==starship.y&& starship.y==starship.z&&starship.x<.51&&starship.x>.49)isGrey=starship.x;
                      
                      
                      
                      float spirographTranslucer = 1.;
                    //  if (starship.x!=0.&&starship.x!=1.&&starship.x!=.5&&(starship.x+starship.y>=255.-3.5||starship.y+starship.z>=255.-3.5||starship.z+starship.x>=255.-3.5)&&starship.w==1.)spirographTranslucer=.75-(starship.x+starship.y+starship.z)/2.;
                      
                      
o=clamp((clamp(o-1000000000000.*oo,0.,1.)+oo+eyeScroll.xyz)-(starship.x+starship.y+starship.z)*7.*starship.w-(sevenSuns.x+sevenSuns.y+sevenSuns.z)*7.,0.,1.)+starship.xyz*spirographTranslucer+sevenSuns.xyz;
                      o*=isBlack;
                      o+=(isBlack-1.)*100.;
                      o+=isGrey;
                      if(length((vUv.yx-.5)/(resolution/max(resolution.x,resolution.y)))<2.*sqrt2/min(resolution.x,resolution.y))o=vec3(hyperCoreOUTPUT/255.*4.,cored/255.*4.,255.);
return vec4(clamp(o+cloverEYES,0.,1.),atan(b.y,b.x));}

                      
                      
                      
                      
  
  
  
  vec3 MannyWoManny(vec2 p,vec2 t,vec2 d){

                               float time2 = t.x;
                               float c=0.,k=0.,l=0.,x=0.,e=0.;
                               vec3 head=vec3(0.);
              if(abs(p.y*p.y)+abs(p.x*p.x)<700.){
                 // t.y=t.x;
                           //vv body vv
                               vec2 g=p;
                                ///g.x+=(coz(t.y)-1.)/2.*.5;
                               vec2 z=g;
                               if(abs(p.y)<6.)for (int f=0;f<30;f+=1)if(abs(z.x+z.y)>(20.-t.y*30.)&&f>4){x=z.y;break;}
                               else {z=2.*vec2(-1./((z.x*z.x-(1.44+t.x*.44)*z.y*z.y)
                            -g.x*(1.2+t.y*.2)+d.x),
                       ((1.2-t.y*.8)*z.x*z.y-(1.2+t.y*.2)*g.y+d.y));
  //The Holy Bible Revelation 21:16 "The city was laid out like a square, as long as it was wide.
  //He measured the city with the rod and found it to be 12,000 stadia in length,
   //and as wide and high as it is long. The angel measured the wall using human measurement, and it was 144 cubits thick.
                                                         z.x=pow(abs(z.x),(.777+t.y*.277));}



          //legs
                               g=p/2.;
                              // g.x-=.5;
                               z=g;
                               if(g.x>.75&&g.x<1.7&&abs(g.y*g.x)<.54)for(int f=0;f<8;f+=1)if(abs(z.x)>52.&&f>1){c=abs(z.x)/1000000.;break;}
                               else {z=3.*vec2(-1./((z.x*z.x-z.y*z.y)-g.x+d.x),(77.0*z.x*z.y-(2.+t.y)*g.y+d.y));
                                     z.y = -1./z.y;}
                 //vv head vv
                                       g=p*-leaf;
                                       z=g;
                          if(abs(p.y)<4.)for (int f=0;f<21;f+=1)if(abs(z.y)>21.&&(f==int(floor(.8+t.y*.4)))){l=0.;break;}
                               else if(abs(z.y)>19.&&(f>4))l=1.;
                                       else{z=vec2(-1./((z.x*z.x-z.y*z.y)-g.x),2.0*z.x*z.y-g.y);
                            z*=pow(abs(z.x),(z.x-t.y*-z.x));
                            l = clamp(1.-abs(z.y)*6.,0.,1.);
                            if(z.x>-.1&&f!=0)l=clamp(1.-z.x*49.,0.,1.);
                               }
                                      

                                     
      }

                           return vec3(l)+vec3(c,x+c/2.,0.)*10000.+clamp(vec3(0.,(k+e)*10.,(k+e)*10.),0.,1.);}


vec3 robeL(vec2 g, vec2 t, vec2 d){
     float r=0.;
     g.x*=(1.2+t.y*.2);
     g.x+=(-.45-t.y*.5);
     g.y/=1.14;
     vec2 z=g.xy;
     if(g.x>.5 &&abs(g.y)<(.8-t.y*1.0))for(int f=0;f<70;f+=1)if(abs(z.y)>11.&&f>7){
     r=clamp(1.4-abs(g.x-2.3)
                      *(1.-abs(g.y*g.x))-.07//(un)comment this line to toggle sleeves
                     ,0.,1.);
                     break;
                     }
     else{
         z=1.1*vec2(-2./(((1.2+t.x*.1)*z.x*z.x-1.8*z.y*z.y)-g.x+d.x),(3.*z.x*z.y-(1.4+t.y*.1)*g.y+d.y));;
         z.x=pow(abs(z.x),.8);}
     return vec3(r);
     }


     vec3 heartZoom(vec2 p, vec2 t){
                    
 float c=3.58;
 p.y*=-1.;
 p*=2.;
 if(colorCombo==18) p*=4.*c;
 vec2 z=p;
const float iterations =  21.*21.;
for (float f=0.;f<iterations;f+=1.)
if(f>iterations*(lerp(time/15.)*.5+.5)){if(length(z)>5.&&colorCombo!=18)break;
else{
if(colorCombo==18)if(length(z)>c)z/=c;
z=vec2(z.x*z.x-z.y*z.y-p.x+t.x, 2.0*z.x*z.y-p.y+t.y);//this is {s=s^2-p}
//z=spin2(p,(atan(z.y,z.x)+PI2)/2.);

}}

return
      (vec3(z.x*z.y,z.x+.144,z.y-.0333*(1.-z.y))+.1)
      /length(z);

 
 }
  
  
  
                      
                      vec3 excelsior(vec2 p,vec2 t){
          t.x*=-1.;
          float oscillatorDouble = zin(t.x*2.+6.28);//works better with +6.28
          float oscillatorSingle = zin(t.x);
           p*=gr;
           vec2 s=p;
           float l=0.;
               for (int f=0;f<21;f+=1)
           if(abs(s.y)<21.){
            s=vec2(((s.x*s.x-s.y*s.y)-p.x),(2.0*s.x*s.y-p.y));

               s.x=pow(abs(s.x),oscillatorDouble)*sign(-s.x*-oscillatorDouble);
                                l=(2.-abs(s.y*-oscillatorSingle)*19.)*-oscillatorSingle;//middle horn
               if(s.x>-.1)l=oscillatorSingle-(s.x*(100.-100.*oscillatorDouble)*oscillatorSingle);
               }
           else break;
          vec3  ret = vec3(0.);
           if(l!=0.) ret = vec3(1./l);
       return ret;
                               }
vec3 ring(vec2 r, float number)
{   
    float amp= texture2D( twelveNotesTex, vec2((number+.5)/12.,0)).x;
    amp=pow(amp,1./3.);
   // r/=max(resolution.x,resolution.y)/min(resolution.x,resolution.y);
    vec3 ret = vec3(0.);
    float radius = length(r);
    if(abs(radius*2.-amp)<.01) 
    {ret = hsv2rgb( vec3( mod((twistStar/PI2*12.-number)*brelued+4.,12.)/12. ,1.,1. ));
        float increment = mod(mod((atan(r.y,r.x))/PI2*12.*2.+12.*12.+6.,1.)-number/12.,1.);
        
   if(increment<1./48.)ret=vec3(-1.*brelued);
   else if(increment<3./48.)ret=vec3(1.*brelued);
 
   else if(increment>47./48.)ret=vec3(-1.*brelued);
   else if(increment>45./48.)ret=vec3(1.*brelued);
  
   
    }
;
    return ret;
}
                      vec3 wings (vec2 p){
                          
                          if(chirality==-1)p=p.yx;
                          vec3 destColor = vec3(.0);
                          float f = 0.0;
                          p*=3.5;
                          vec2 reincrementation = vec2 (0.);
                          
                          float rings = 1.;
                          if (chirality==3)rings=7.;
                                                          float m=0.;

                          if (length(p)<3.)
                            //  for(float m = 0.0; m < rings; m++)
                            {
                                  if (m==0.)destColor=vec3(-1.);
                                  else destColor=vec3(1.);
                                  
                          for(float i = 0.0; i < 6.; i++){
                              
                              float s = -sin(PI/3.*i);
                              float c = -cos(PI/3.*i);

                              float val = pow((p.y+s+reincrementation.y)*(p.y+s+reincrementation.y)+(p.x+c+reincrementation.x)*(p.x+c+reincrementation.x),.5);
                              if (val>1.&& val<1.05)
                              f = 2.*(val+(p.y*p.y+p.x*p.x-9.)/10.);
                          }
                                  reincrementation = vec2(-sin(3.141/3.*m),-cos(3.141/3.*m));
                      }
                          return f*destColor;
                      }
                          
                      
     vec3 man(vec2 p,vec2 t) {
         p*=-1.75;
         vec2 s = p;
         float l=0.;
         float flip=-t.x;
         if (flip<0.) p = -p;
          vec3 ret = vec3(0.);//vec3(-lerp(time));

         if (abs(p.x*p.x+p.y*p.y)<2.0)
         {for (int t = 0; t < 30; t++) {
                 s = vec2(((s.x * s.x - s.y * s.y) +flip* p.x), (s.x * s.y + flip*p.y));
                 if(flip<1.)
                 s.x = 1./pow(abs(s.x),flip)*sign(s.x*flip);
                 else s.x = 1./s.x;
           l = length(s);
           ret =vec3(-10.);
         if (l >20.0&&t!=0)
         {ret=vec3(10.);
             break;
             }
         

         }

           

         }
        return ret*(lerp(time)+.5);
 }


     vec3 eagle(vec2 p,vec2 t) {
     p*=10.;
         vec2 s = p;
         float d = 0.0, l=0.;
         vec3 ret = vec3(0.);

         float flip=-t.x;
         if (flip<0.) p = -p;
         
         if(abs(6.*p.x*p.x+p.y*p.y*2.)<700.0)
         for (int i = 0; i < 30; i++) {
             s=vec2(-(s.x * s.x - s.y * s.y) +flip* p.x, (s.x * s.y + t.y*p.y));
            /* if(b<=.5 ||rate == 0.)
                 s.x = 1./s.x;
             else*/
            if(flip<1.)s.x = 1./pow(s.x,flip)*sign(s.x*flip);
            else s.x=1./s.x;
               s.y = s.x*s.y;
             l = length(s);
             d +=2.;
              if(l >(20.0)&& float(i)>3.&&float(i)>3.)
              {
                 ret =  vec3(1.-sin(d * 0.003)-.5,1.- sin(d * 0.9)-.5,1.- sin(d * 0.1)-.5)*3.;
                 break;
              }
              }
         return vec3(.0);
        }

      vec3 eaglePerched(vec2 p, vec2 t){
            p*=2.5;
            vec2 s=p;
                    float l = 0.;

                    float flip=-t.x;
                    if (flip<0.) p = -p;
                    if(abs((p.x)*(p.x)+(p.y*p.y))<8.&&p.x<0.1)
            for (int f=0;f<20;f+=1)if(abs(s.x+s.y)>20.){l=-10.;break;}
            else {s=vec2((s.x*s.x+s.y*s.y+p.x),-(2.0*s.x*s.y-p.y));

                        if(flip<1.)s.x = 1./pow(s.x,flip)*sign(s.x*flip);
                        else s.x=1./s.x;
                  l=10.;}
            return vec3((lerp(time)+.5)*l);
        }

      vec3 lion(vec2 p,vec2 t) {
      p*=-3.;
      vec2 s = -p;
          vec3 ret = vec3(0.);
      float flip=-t.x;
      if (flip<0.) p = -p;
          if(p.x*p.x*1.+p.y*p.y*2.<21.) for (int t = 0; t < 50; t++){ if(length(s)<15.||t<3)
      {
          s = vec2(((s.x * s.x - s.y * s.y) +flip* p.x), (2.0* s.x * s.y + flip*p.y));
          s/=2.;
              if(flip<1.) s.x = 1./pow(s.x,flip)*sign(-s.x*flip);
              else s.x=-1./s.x;
            ret=vec3(0.);
      }
      else {ret =  vec3(s.y,s.x,s.y*s.x)*zin(time);break;}
      }
          
          return ret;
          }
      
 vec3 ox(vec2 p,vec2 t) {
    p*=1.5;
       vec2 s = p;
       float d = 0.0, l=0.;
         float flip=-t.x;
         vec3 ret = vec3(0.);
         if (flip<0.) p = -p;
         if( (p.x+.25)*(p.x+.25)+p.y*p.y<1.||(p.x>0.&& p.x*p.x+p.y*p.y<7. ))
       for (int t = 0; t < 30; t++) {
         s = vec2(((s.x * s.x - s.y * s.y) -flip* p.x), (3.0* s.x * s.y - flip*p.y));
         if(flip<1.) s.x = 1./pow(s.x,flip)*sign(-s.x*flip);
         else s.x=-1./s.x;
           l = length(s);
         d += l/10.;
         if (l >14.0 &&float(t)  >2.)
         {
         ret = vec3(-sin(d +time*1./gr*2.),-sin(d +time*gr*2.),-sin(d *time*2.));
         break;
         }
       }
       return ret;
     }




const float brideWidth=1.27;
        vec3 bride(vec2 p,vec2 t){
                   float c=0.,l=0.,x=0.;
                   vec3 e = vec3(0.);
  if(abs(p.y*p.y)+abs(p.x*p.x)<49.){
    p+= vec2(.8787878787878,0.);
               //vv body vv
                   vec2 g=p/2.;
                   g.y/=brideWidth;
                  // g.x+=.5;
                   vec2 z=g;
                   for (int f=0;f<75;f+=1)if(abs(z.x+z.y)>20.&&f>4){x=z.y;break;}

                   else {z=2.*vec2(-1./((1.2*z.x*z.x-(1.37-t.y*.37)
                       *z.y*z.y)-g.x*1.2+t.x),((1.37-t.x*.37)
                       *z.x*z.y-1.2*g.y+t.y));

z.x=pow(abs(z.x),.777-t.x/49.);}
                   /*
                   for (int f=0;f<75;f+=1)if(abs(z.x+z.y)>20.&&f>4){x=z.y;break;}
                   else {z=2.*vec2(-1./(1.2*(z.x*z.x-1.37*z.y*z.y)-g.x*1.2+t.x),(1.37
                                                                                *z.x*z.y-1.2*g.y+t.y));

                         z.x=pow(abs(z.x),.777-t.x/49.);}*/
                   float mingle = 22.5;
                   
                         if(x<0.) x+=mingle;
                          else if(x>0.)x-=mingle;
               //vv legs vv
                   g=p/3.5;
                   //g.x-=.5;
                   z=g;
                   for (int f=0;f<70;f+=1)if(abs(z.x+z.y)>200.&&f>4){c=1.;break;}
                   else {z=3.*vec2(-1./((z.x*z.x-z.y*z.y)-g.x+t.x/40.),(77.0*z.x*z.y-2.*g.y+t.y/40.));
                         z.y = -1./z.y;}
               //vv head vv
                   g=p;
                  // g.x-=.1;
                   z=g;
                   for (int f=0;f<10;f+=1)if(abs(z.x+abs(z.y))>27.&&f>4){l=1.;break;}
                   else{z=vec2(-1./((z.x*z.x-z.y*z.y)-g.x+t.x/8.),(2.0*z.x*z.y-g.y+t.y/8.));
                        z*=pow(abs(z.x),z.x);}
                   /*
               //vv mandelbrot\heart vv
                   g=p*2.;
                   g.x-=6.;
                   z=g;
                   for (int f=0;f<50;f+=1)if(abs(z.x+z.y)>20.)break;
                   else {z=vec2(((z.x*z.x-z.y*z.y)-g.x-t.x/4.),(2.0*z.x*z.y-g.y-t.y/4.));
                                if(f>2)k+=0.02;}*/
               //vv eye lights vv
                   g=p;
                   z=g;
                   
                   for (int f=0;f<5;f+=1)if(abs(z.x+z.y)>20.)break;
                   else {z=vec2((1./(z.x*z.x-z.y*z.y)-g.x-t.x/4.),(4.0*z.x*z.y-g.y-t.y/4.));
                         if(f>2)
                         {if(p.y>0.)e+=vec3(0.45,.3,0.);
                            else e+=vec3(0.,.3,.45);
                         }
                         }
}

  if(x<0.)x+=l*100.;
  return vec3(l+c,x+c,c)+e;}


  vec3 dress(vec2 p,vec2 t){
          //            vec2 o=vec2(p*vec2(1.26,1.)/(1.5/gr)/2.-vec2(1.,0.));
    p-= vec2(.5,0.);

  p/=2.5;

   p.x*=1.77;

   p.y/=brideWidth;
   vec2 z=p;
   float l = 0.;
  const float iterations =  71.;
  if ((p.x-1.)*(p.x-1.)+p.y*p.y*3.*brideWidth<2.)
       for (float f=0.;f<iterations;f+=1.)
{
               //if(length(z)>c)z/=c;//this refracts the Mandelbrot outwards

           z=2.*vec2(-1./(z.x*z.x-z.y*z.y-p.x+t.x), 2.0*z.x*z.y-p.y+t.y);//this is {s=s^2-p;s.real=-1./s.real}
          // for (float f=0.;f<iterations;f+=1.){
           // o = z;
        //   o=vec2(-1./(o.x*o.x-o.y*o.y-p.x), 2.0*o.x*o.y-p.y)-vec2(o.x*o.x*o.x  - 3.*o.x*o.y*o.y, -o.y*o.y*o.y+ 3.*o.x*o.x*o.y);//this is {s=s^2-p;s.real=-1./s.real}
                       
   z.x=sqrt(abs(z.x));
   l=z.x;
  }
//float cpi=0.;
      //         if(p.y!=0.)cpi=(o.x/o.y)*sign(o.x*o.y)+o.x*2.;
   return vec3(l
               //+cpi
               );}
                                                                                      
                                                                                      
                                                                                      
                                                                                      
                                                                                      
                                                                                      
                                                                                      
                                                                                      
                                                                                      
                                                                                      
                                                                                      
                                                                                      
                                                                                      
                                                                                      
              vec3 tokogae (vec2 p, vec2 t){
                  vec2 s = p*2.;
                   float l=1.;
                  vec3 digorno=vec3(0.);

                   for (int f=0;f<41;f+=1)if(abs(s.y)<5.&&s.x!=0.&&s.y!=0.){
                       
                       s=vec2(s.x+s.y/(s.x*s.x + s.y*s.y), (1./(s.x*s.x + s.y*s.y))-sin(1.-t.x)/2.);//this equation comes from the equation (x-1/((x - y*i)))=x
                  s.y=s.y-log(dot(s.y,s.y))*-sin((1.-t.x)/2.);
                  digorno+=vec3(s.x,s.x/s.y,(s.y/s.x));
                  }
                  else      {
                           
                          digorno-=vec3(s.x*1.4,(s.y*s.x),s.y)/50.;
                          break;
                          }

                  return digorno/4.;
              }


      vec3 TOLTOK (vec2 p, vec2 t){
                                  float precores = 0.49;
                                  if(spirated!=0.) precores = 1.;
                                  if(spirated>-.5) p.y*=-1.;
                                  float cored = log(zoom*3./2.)*LogHalfReciprocal+1.+precores;
                                  float c = length(p);
                                  float loops=1.;
                                                    vec2 s = p*1.5;
                                  if(!MetaCored)for(int i=1;i<60; i++)if(c<twoThirds&&loops<cored){s*=2.;c*=2.;loops++;}else break;
                                  loops=0.;
                                  float hyperCore=0.;
                                  float lfc = length(freed(coords));
                                  if(outerCoresOff) hyperCore=0.;
                                  else if(!MetaCored)hyperCore=cored*twoThirds+log(lfc*3./2.)*logStabilizationConstant+.25*LogHalfReciprocal;//.9551195 is based on x=log3(x), x = .910239log3(x).  So (1.-.910239)/2+.910239=.9551195 may be incorrect but is close to right.
                                   // if(MetaCored&&morph>=.5)hyperCore*=4./3.;//engage overstable core if dancing

                                  float term=0.;
                                //  if(spirated!=0.)term=(1.-lfc)*(3.-eConstant);//if is spirated then oscillate the function's log between e and 3

                   float l=1.;
                  vec3 digorno=vec3(0.);
                   for (int f=0;f<41;f+=1)if(abs(s.y)<5.){
                                      if(spirated!=0.&&length(s)<twoThirds)   s*=length(s)*PI2/(atan(s.y,s.x)+PI);

                       if(f>0) s=vec2(s.x+s.y/(s.x*s.x + s.y*s.y), (1./(s.x*s.x + s.y*s.y))+zoom*1.5-1.);//this equation comes from the equation (x-1/((x - y*i)))=x.  This equation has no solutions, but upon feedback it gains solutions (technically this may require other steps too)
                       for (int counter=0;counter<15;counter+=1)if(abs(s.y)<1.5*(1.-zoom*1.5)){
                            s=vec2(s.x*s.x*s.x  - 3.*s.x*s.y*s.y-t.x, -s.y*s.y*s.y+ 3.*s.x*s.x*s.y-t.y);//x**3
                            s.x=log(abs(s.x))/log(3.-term);


                            float d = length(s);
                            if(d<4./3.&&petals!=0.)s=spin2(s,atan(s.y,s.x)*petals/6.);
                            for(int i=0;i<69; i++)if(!MetaCored&&d<twoThirds&& loops+float(f)+1.<hyperCore)
                         {
                               float shift=2.;s*=shift;d*=shift;loops++;

                               float wise;
                               if(mod(float(i),4.)==0.)wise=1.;
                               else if(mod(float(i),4.)==1.)wise=-1.;
                               else  if(mod(float(i),4.)==2.)wise= -1.;
                               else  if(mod(float(i),4.)==3.)wise=1.;

                               if(metaCarousel!=0.)s=spin2(s,time*wise*metaCarousel*(1.+petals/6.)*rate);

                            }
                             else break;

                       }else break;


                  l = s.x-l;

                  //s.y=s.y-log(dot(s.y,s.y))*-sin((1.-zoom*1.5)/2.);
                  digorno+=vec3((s.y/s.x),(s.y/s.x)*5.+l*s.y,s.x);
                  }
                      else         digorno-=vec3(s.x*1.4,(s.y*s.x),s.y)/21.;

                  return digorno/8.;
              }


  vec3 TOLTOK1    (vec2 s, vec2 t){
                            s=-s.yx;
                            vec2 p = s;
    vec3 ret = vec3(1.);
      for (int f=0;f<20;f+=1)if(abs(s.y)<30.){
          if (f<10)
          for (int p=0;p<2;p+=1)if(abs(s.y)<(1.-t.x)*2.)
          {
          s=vec2(s.x*s.x*s.x  - 3.*s.x*s.y*s.y, -s.y*s.y*s.y+ 3.*s.x*s.x*s.y);//x**3
              s.x=log(abs(s.x));
              ret+=vec3(s.y/100.-s.x*s.y/888.,s.x/8.-s.y/s.x/2000.,1.-s.x/20.)/20.;
             }
          if (f>3){ s=vec2((s.x+s.y/(s.x*s.x + s.y*s.y)), (1./(s.x*s.x + s.y*s.y)))-abs(p);
          s.y=s.y-log(dot(s.y,s.y))*-sin(1.-t.x);
          ret= vec3(s.y,abs(s.x-s.y),s.y*s.x)/50.;
                    }
      }
      return ret;
}



vec3 xx(vec2 s, vec2 t){
                                   vec2 m =vec2(0.);
                                   if(wheel) m =  s/length(freed(coords))+coords.yx;//this is essentially just p as in the mandelbrot x <== x^2+p

      for (int f=0;f<40;f+=1)if(abs(s.y)<19.){
          s=vec2((s.x*s.x-s.y*s.y)-t.x-m.x, 2.0*s.x*s.y-t.y-m.y);//this is {s^2} (try dividing by 2)
          
  s.x=log(abs(s.x));
}

  return vec3(s.x,s.y,0.);}
vec3 xtol(vec2 s, vec2 t){
                                  float cored=   log(zoom*1.75)/log(.75)+1.;
                                        float h =1.3333333;
                                            float loops=1.;
                                        if(cored>1.&&MetaCored)
                                         {
                                             float c = sqrt(s.y*s.y+s.x*s.x);
                                             c/=h;
                                             {for(int i = 0; i<69+1; i++)if(c<h/2.&&loops<cored){s*=h;c*=h;loops++;}else break;

                                                                                           }
                                         }

                            for (int f=0;f<40;f+=1)if(abs(s.y)<19.){
                            if(mod(float(f),3.)==0.)s=vec2(s.x*s.x*s.x  - 3.*s.x*s.y*s.y, -s.y*s.y*s.y+ 3.*s.x*s.x*s.y);//x**3
                            s=vec2((s.x*s.x-s.y*s.y), 2.0*s.x*s.y);//this is {s^2-p;s.real=-1./s.real}
                                    s.x=log(abs(s.x));

                                    if(MetaCored){
                                        float c = sqrt(s.y*s.y+s.x*s.x);
                                        //for(int i=0;i<69; i++)if(c<twoThirds&&i<int(cored)){p*=2.;c*=2.;}
                                        c/=h;
                                        if(c<h/2. &&f<int((cored/2.+log(length(freed(coords))*h/2.)+.5)/2.)){float shift=h;s*=shift;c*=shift;}
                                                                 }
                                                                                      }

                           return vec3(s.y/50.-s.x*s.y/600.,s.x/8.-s.y/s.x/200.,1.-s.x/10.);

                        }

    vec3 acrostic(vec2 t){
      float c=1.44;

        for (int f=0;f<40;f+=1)if(abs(t.x)<1./sqrt(zoom)){
        //  if(length(t)>c)t/=c;

        t=vec2(1./(t.x*t.x-t.y*t.y), 2.0*t.x*t.y);//this is {s=s^2;s.real=-1./s.real}}
//t.x=log(abs(t.x)
    }
    return vec3(t.x,1./t.y,t.x/t.y);

}vec3 horse(vec2 p, vec2 t){ //horse
    float r =0.;
    p.x-=3.;
    p.x*=3.;
       vec2 g=p;
       vec2 z=g;
       if(g.x*g.x+g.y*g.y<4.)
       {
           for(int f=0;f<23;f+=1)if(abs(z.y)>11.&&f>7){r=1.;break;}
       else{
           z=1.*vec2(2./((1.*z.x*z.x-5.*z.y*z.y)-g.x+t.x),2.*(z.x*z.y-g.y+t.y));;
           z.x=pow(abs(z.x),.8);}
       }
       return vec3(r);
       }
                      vec3 sword(vec2 p,vec2 t){
                                 //sword
                                     vec2 g=p*3.;
                                     g.x+=(lerp(time2dance/22.)+1.)*21.
                                     -7.;
                                     g.x/=1.5;
                                     vec2 z=g;
                                     float d = 0.0;
                                     float u=0.;
                                     vec3 h=vec3(0.);
                                     if (p.x>.7&&g.x>-2.5 && abs(g.y*g.x) <1.77 &&abs(g.y)<2.11111111)
                                     {
                                         for (int i = 0; i < 14; i++) {
                                           z = vec2(1.1/(1.-pow((z.x * z.x - z.y * z.y +1.+ g.x),2.)), -1.77/(2.0 * z.x * z.y + g.y));
                                         u = length(z);
                                         d +=z.x+z.y+20.;
                                         if (u >5.4 && ( i==4||( i==13 )))  h=vec3(-sin(-d*0.0061),-sin(-d * 0.0063),-sin(-d * 0.0069));
                                         }
                                         
                                   }
                                 return h;
                                 }
                      
                                  vec3 flames(vec2 p){
                                      p*=1.5;
                                      p.y*=3.;
                                  vec2 s=p;
                                  float l=0.;
                                          float m = 0.;
                                          float k = 0.;
                                         
                                          if(abs(p.x*p.x+p.y*p.y)<50.&&s.y!=0.)
                                          {
                                  for (int f=0;f<20;f+=1)if(abs(s.x+s.y)>20. && f>1)l=1.;
                                      else{ s=vec2(-1./(s.x*s.x+s.y*s.y+p.x),-(2.0*s.x/s.y+p.y));
                                          m += abs(s.x+s.y);
                                          }
                                      }
                                  return vec3(m*l, m*l/400.,-sin(m*gr)*l);}


                          vec3 scroll(vec2 p,    vec2 unleashed) {
                                   p=-p*2.;
                                   float flip=unleashed.x;
                                   if (flip<0.) p = -p;
                                   float r = 0.;
                            vec3 ret = vec3(0.);
                              vec2 s = p;
                              float d = 0.0, l=0.;
                             if(length(p)<2.){
                                 for (int t = 0; t < 20; t++)if (l < 20.||t<4)
                              {
                                  s = vec2(((s.x * s.x - s.y * s.y) +flip* p.x*p.x), (2.0* s.x * s.y + flip*p.y*p.y));
                                  if(flip==-1.)s.x = -1./s.x;
                                  else s.x = pow(s.x,flip)*sign(s.x*flip);
                                  l = length(s);
                                  d += l/40.;
                              }
                              else { r=d ;ret=vec3(r); break;}
                              }
                              r=0.;
                             if(ret.x==0.&&ret.y==0.&&ret.z==0.) ret=vec3(r);
                             return ret;
                          }
                                                                                      
                          
                          vec3 lamp(vec2 p,vec2 unleash) {
                            p.x-=3.;
                            p*=3.;
                            vec2 s = p;
                            float d = 0.0, l=0.;
                            vec3 ret = vec3(0.);
                              if (!(p.x<-5.)&&abs(p.y)<1.789||unleash.x!=-1.)
                              {
                            for (int i = 0; i < 5; i++) {
                              s = vec2(-1./(s.x * s.x - s.y * s.y + p.x),-1./( 2.0 * s.x * s.y + p.y));
                              l = length(s);
                             d +=s.x+s.y+20.;
                               
                              if (l >7.)
                            {
                                ret =
                                vec3(1.-sin(d * 0.001),1.- sin(d * 0.0015),1.- sin(d * 0.0069));
                              break;
                              }
                            }
                            }

                            return ret;
                                                                                      }


                                                                                      
                                                                                   
          
  vec3 body(vec2 p, vec2 t){
    vec3 b = vec3( 0.);
    b = torso(p,t,false).xyz;
    if(p.x>0.)
    {b+=musculature(p,t);}
    return b+robe(p,t)+legs(p,t/33.3)+heart(p*2.,t);}
      
vec4 bodyPlayer(vec2 p, vec2 t){
vec4 b = vec4( 0.);
b = torso(p,t,true);
if(p.x>0.){if(p.x>.333)b+=vec4(musculature(p,t),0.);}
return b+vec4(legs(p,t/33.3),0.);}
      
                      vec3 bodyFourCreatureCharacter(vec2 p, vec2 t){
                      vec3 b = vec3( 0.);
                      b = torso(p,t,true).xyz;
                      if(p.x>0.){if(p.x>.25)b+=musculature(p,t);}
                      return b+robe(p,t)+legs(p,t/33.3);}

                      
  vec3 bod(vec2 p, vec2 t){return torso(p,t,false).xyz+musculature(p,t)+robe(p,t)+legs(p,t/33.3);}
  vec3 manny(vec2 p, vec2 t){
    return shiny(p,t)+body(p,t)
    ;}
  vec3 mannyX(vec2 p, vec2 t){return excelsior(p,vec2(time*metronome,0.));}
  vec3 fourCreatures(vec2 p, vec2 t){
             float inversion = -1.;
            if (wheel)inversion=coz(time);
            vec2 spacing = vec2(5.,3.)*.7;
            p.x+=.5;
            
            vec2 eagleCoord = p+spacing;
            vec2 lionCoord = p+vec2(-spacing.x,spacing.y);
            vec2 oxCoord = p+vec2(spacing.x,-spacing.y);
            vec2 manCoord = p-spacing;
            
            
            return eaglePerched(eagleCoord,vec2(inversion,0.))+body(eagleCoord,t)
          +lion(lionCoord,vec2(inversion,0.))+body(lionCoord,t)
          +ox(oxCoord,vec2(inversion,0.))+body(oxCoord,t)
          +man(manCoord,vec2(inversion,0.))+body(manCoord,t)
          ;
}
            vec3 fourCreaturesSmall(vec2 p, vec2 t){
                    float inversion = -1.;
                   if (wheel)inversion=coz(time);
                      vec2 spacing = resolution.yx/min(resolution.x,resolution.y)*2.24;
                     // spacing.x+=resolution.x/min(resolution.x,resolution.y)*.15;
                     
                     
                     vec2 eagleCoord = p+spacing;
                     vec2 lionCoord = p+vec2(-spacing.x,spacing.y);
                     vec2 oxCoord = p+vec2(spacing.x,-spacing.y);
                     vec2 manCoord = p-spacing;
                     vec3 OX =  ox(oxCoord,vec2(inversion,0.));
                     vec3 MAN = man(manCoord,vec2(inversion,0.));
                     vec3 EAGLE = eaglePerched(eagleCoord,vec2(inversion,0.));
                          return
                      lion(spin2(lionCoord,coz(-time)/4.),vec2(inversion,0.))
                            +body(lionCoord*3.,t)*2.+wings(lionCoord/2.)+
                     clamp(body(eagleCoord*3.,t)-EAGLE,0.,1.)+EAGLE+wings(eagleCoord/2.)+
                     clamp(body(oxCoord*3.,t)-OX/3.,0.,1.)+OX+wings(oxCoord/2.)+
                      clamp(body(manCoord*3.,t)-MAN,0.,1.)+MAN+wings(manCoord/2.) ;
          }

  //function library: manny body legs robe musculature torso face excelsior shiny lion ox man eagle eaglePerched fourCreatures heart anomalyze spin x
                      float pillarScale = 25.;

vec3 sevenPillars(vec2 p){
                      float pillarHeight = pillarScale/max(resolution.x,resolution.y);

    float screenBase = pillarHeight;
vec3 ret = vec3(0.);
    p.x-=screenBase;
    if(p.x<pillarHeight)
    {
        const float pillarDepth = 3333.;
       float pillars=0.;
       if (p.x>0.) pillars = totalAmp*pillarDepth;
       else pillars = (1./totalAmp);
    if (pillars<0.) pillars=0.;
      p*=pillars;
      vec2 s=p;
                      float l=0.;
                      
                      for (int f=0;f<11;f+=1)if(abs(s.y)<sqrt(pillarDepth)){
                  s=vec2(-1./s.x, 2.0*s.y);//this is from a thought about y=x
                          }
                  ret= vec3(s.y/s.x,-s.x*2.,-s.y*s.x);
                  }
    else ret= vec3(0.);
    return ret;
}
 
vec3 movie(vec2 p){
    vec3 MOVIE=vec3(0.);
    if(movieTime>0.&&movieTime<2.)MOVIE=tol(p*zoom,vec2(0.)).xyz;
    else if (movieTime>=2.&&movieTime<3.)MOVIE=torso(p,vec2(0.),false).xyz;
    else if (movieTime>=3.&&movieTime<4.)
    {
        vec4 MOVIEbuffer= faceBlackAndWhite(p*1.221221,vec2(0.),false,-1,false,-1.);
        if (MOVIEbuffer.w==-.25) MOVIE=vec3(1.);
        else MOVIE=MOVIEbuffer.xyz;
    }
  else if (movieTime>=4.&&movieTime<5.)MOVIE= heart(p+vec2(0.5,0.),vec2(0.));
    /*    else if (movieTime>=5.&&movieTime<6.)MOVIE=torso(p,vec2(0.),false).xyz;
        else if (movieTime>=6.&&movieTime<7.)MOVIE=legs(p,vec2(0.));
*/
    return MOVIE;
}
                                                      
      void main(){
                      vec2 aspectRatio = resolution/max(resolution.x,resolution.y);

vec2 r=-(vUv.yx-.5)/aspectRatio;
vec2 p=r*shaderScale/2.;

vec4 oopm = vec4(0.);
if((volume!=1.&&Pointers)||(volume==1.&&!Pointers))
oopm=oppositeOfPitchMarker(r);//seems like volume should be zero if touchmode, it's not, and causes black screen

vec2 spunC=coords.yx;
//if(continuumClover&&colorCombo<=10)spunC*=1.5;
if (spinner){spunC*=-1.;spunC=spin2(spunC,twistStar);}
 if(carousel!=0.){spunC*=-1.;spunC=spin2(spunC,-carousel*mod(time*rate,PI2));}

vec2 background=p;

if (colorCombo!=20)background=freed(background*zoom+spunC);

float lfc=length(freed(constellationCoord));

if(whirlpool!=0.) background=spin2(background,whirlpool*length(background)*.75/6.*PI/abs(zoom-lfc));

if (spinner){background=spin2(background,-twistStar);}

if(carousel!=0.)background=spin2(background,carousel*mod(time*rate,PI2));
float xenOctaveFactor =4.;

if(exponentialPetals!=0.)background=spin2(vec2(background.x,exponentialPetals*background.y),
                                                                                                
                                          PI2*pow(2.,
                                                  (xenOctaveFactor-(atan(background.x,exponentialPetals*background.y)/
                                                                    PI)*xenOctaveFactor-(petals)/
                                                    6.))/pow(2.,xenOctaveFactor));

                   background=spin2(background,atan(background.y,background.x)*petals/6.);
                   


vec2 dance = vec2(0.);
                                   vec2 dance2 = vec2(0.);
           if (morph>.5){
                dance = //vec2(-sin(time+time2dance), -sin(time*-gr))*zoom+
                vec2((spunC.x),abs(spunC.y))*log(lfc);
                //heart dance
                   dance2 = vec2(   -abs(lfc/(lfc-zoom)) -lfc/(lfc+zoom)*twoThirds,
                                     -((zoom*lfc)/(lfc+zoom)*sign(constellationCoord.y)*sign(constellationCoord.x)*(1.-lfc*zoom) )
                                       );//clover dance
             }

 vec2 driftCanceller=vec2(dance.x,-dance.y);
                                                                                         
                                                                                         
                                                     vec3 faceFORWARDbuffer = vec3 (1.);
                                                 vec3 zoomer=vec3(0.);
                                                 vec2 t =vec2(lerp2(time),lerp2(time*(gr-1.)));
                                                t/=2.;
                                 vec2 move = d.yx*volume;
                                 vec2 moveDynamic=vec2(0.);
                                 float angleOfClover = 0.;
                                 if(dynamicDance) moveDynamic = (move/4.+t)/2.*smush;
                                 else  moveDynamic = move/4.*smush;
                                 vec3 backgroundFace = vec3(0.);
         if(colorCombo<=10){
                      
                       vec4 tolOUT = vec4(0.);
                       tolOUT=tol(background, dance2);
                       zoomer=tolOUT.xyz;
                       
                       angleOfClover=tolOUT.w;
                       if(chirality==3){
                           if(!twelveGates)
                           {
                               tolOUT=tol(background.yx,dance2);
                               zoomer+=tolOUT.xyz;
                               }
                           else
                           { tolOUT=tol(spin2(background,PI2/24.),dance2);
                               zoomer+=tolOUT.xyz;
                               }
                           angleOfClover+=tolOUT.w;
                           zoomer/=2.;
                           
                       }
                       
                   }
                            
     else if (colorCombo==11||colorCombo==18)zoomer=heartZoom(background+driftCanceller, dance);
    // else if (colorCombo==13)zoomer=tokogae(background,vec2(zoom));
                                 
     else if (colorCombo==14)zoomer=TOLTOK(background,dance2);
     else if (colorCombo==15)zoomer=xx(background,dance2);
    // else if (colorCombo==16)zoomer=xtol(background,vec2(0.));
                                 
     else if (colorCombo==17){
                       if(Character == 3||Character == 4){
                           faceFORWARDbuffer =faceFORWARD(background*3.,vec2(0.));
                           zoomer=faceFORWARD(background*3.,vec2(0.));
                           }
                       else zoomer=faceHeights(background,vec2(0.));
                       zoomer = clamp(bod(background*2.,vec2(0.))-zoomer*50.,.0,1.)+zoomer;
                       }
     else if (colorCombo==20){
                       zoomer=vec3(0.);
                       if(Character!=3&&Character != 4)
                           backgroundFace =clamp(face(background*1.75-vec2(1.,0.),vec2(0.))+.5,0.,1.);
                       else{
                           if(musicAngelMan==0)backgroundFace =faceFORWARDstatic(background*1.75-vec2(1.,0.),vec2(0.));
                           else backgroundFace =faceFORWARDstatic(background*4.,vec2(0.));
                        }
                       if(gameOn||scoreLoaded)
                       {    if(Character==3||Character==4&&gameOn) backgroundFace/=1.5;
                           backgroundFace+=.25;
                           }
                       }
    else if (colorCombo==19)zoomer=acrostic(background);
    else if (colorCombo==100)zoomer=vec3(.5);

                                                 
                                                 
                                 
         vec2 characterP = p*2.;
                                 
         vec2 characterPSpunToKey=spin2(characterP*vec2(1.,flipStar*brelued)///.8
                                        ,-(//starSpin*mod(time*rate,PI*2.)-
                                                                          twistStar*brelued));
                                 
         vec2 characterOnTrailP = characterP;
                                                                 
                                                                 if(MannyONtrail>1)characterOnTrailP+=dotCoord.yx*(shaderScale/2.);

         if(MannyONtrail>0) characterOnTrailP=spin2(characterOnTrailP,atan(d.y,d.x)-PIdiv2*3.);//put manny on trail
                                                                 
                                                                                                         
                                 vec2 characterPStatic = p*2.;

         vec2 fourcreaturePlayerP = p*1.5;
                                                                 
                                                                 if(MannyONtrail>1)fourcreaturePlayerP+=dotCoord.yx*(shaderScale/2.);
        if(MannyONtrail>0) fourcreaturePlayerP=spin2(fourcreaturePlayerP,atan(d.y,d.x)-PIdiv2*3.);//put manny on trail
     vec3 creatures=vec3(0.);
    vec3 b=vec3(0.);
     vec3 bridge=vec3(0.);
                                          
                                                                 vec3 cloud= vec3(0.);
                                                 float swordSkew = -0.22;
                 
                 if(helm)
                 {bridge=fourCreaturesSmall(characterPStatic,moveDynamic);
                       if(colorCombo==20&&(helm&&(Character==3||Character==4))) cloud=clouds(background*4.,moveDynamic);
                       else if(colorCombo==20)cloud=clouds(background*1.75-vec2(1.,0.),moveDynamic);
                       else  cloud=clouds(characterPStatic*1.2,moveDynamic);
                                    
                                                     cloud=clamp(cloud,0.,1.);
                                                     }
     if(fourCreats<0){
                       const float brideSize = 24.;
                       creatures=fourCreatures(background*8.,vec2(0.)//t
                                               );
                                               vec2 bgBride = background*brideSize;
                       if(length(bgBride)>4./3./brideSize)
                            b=bride(bgBride,vec2(0.))+heart(bgBride*2.,vec2(0.))+dress(bgBride*1.5/gr,vec2(0.))*2.;
     }

                 float inversion = -1.;
                 if (wheel)inversion=coz(time);

                   vec3 mny=vec3(0.);

                    vec3 mnyX = vec3(0.);
                    vec3 overchargeCharacter = vec3(0.);
                                 float angelSize = 1.221221;

                                 vec4 mannyFace = vec4(0.);//.w is a flag for the face layers set to .5 for eyes, 1 for face, and 0 for background
                                                                 vec3 AM =  vec3(0.);//faceFORWARDTWO(characterOnTrailP/2.,vec2(0.));
                                                                 vec3 clothes=vec3(0.);
                                                                 float elbowed = 0.;
                                                                 vec4 bodyWithArms = vec4( 0.);

if(Character==2)clothes=dress(characterOnTrailP*1.5,-moveDynamic/7.);
                                                                 else if(Character==1){
                       
                       vec2 lerper = vec2(lerp(time2dance));//,lerp(time2dance));
                       
                        elbowed = -lerper.y*lerper.y+(-1.+lerper.y*lerper.y)*abs(characterOnTrailP.y*characterOnTrailP.y)*twoThirds;
                       if (elbowed<-1.)elbowed=-1.;
                       
                       clothes=robeL(characterOnTrailP,vec2(elbowed),move/5.)*.84;}
                                            else if(Character<=10)
                                                                 {
                       vec2 morphDance = vec2(0.);
                       if(cloverArms) morphDance = vec2(-sin(-angleOfClover),1.-cos(-angleOfClover));
                       else morphDance=moveDynamic;
                       
                       bodyWithArms = bodyPlayer(characterOnTrailP,morphDance);
                       clothes=robe(characterOnTrailP,morphDance);
                                                                }
            if(colorCombo!=17&&colorCombo!=20){
                   if(metronome>1.) mnyX = mannyX(characterOnTrailP/2.*1.221221,vec2(time))+bodyWithArms.xyz;
                   else if (Character==0){
                       mannyFace = (faceBlackAndWhite(characterOnTrailP*1.221221,moveDynamic,false,-1,false,-1.));//,0.,1.);
                       
                         
                       mny=bodyWithArms.xyz+mannyFace.xyz*(1.-bodyWithArms.w);
                   }
                   else if (Character==1){
                       
                       
                       mny = MannyWoManny(characterOnTrailP,
                                          vec2(elbowed),move/5.
                                                        )
                                                        ;
                                                        
                                                                if(mny.g<0.)mny=vec3(1.,0.,1.);
                                                                clothes=clamp(clothes-(mny.r+mny.g+mny.b)*4.,0.,1.);
                   }
                   else if (Character==2){
                        mny=bride(characterOnTrailP*gr,moveDynamic);
                        
                       swordSkew+=.5;}
                   else if (Character==3||Character==4){
                    overchargeCharacter = faceFORWARDstatic(characterOnTrailP*angelSize,moveDynamic);
                     if(musicAngelMan>0) AM+= overchargeCharacter;
                       mny=bodyWithArms.xyz;
                   }
                   else if (Character==5)mny=lion(fourcreaturePlayerP,vec2(inversion,0.))+bodyWithArms.xyz;
                   else if (Character==6){
                       mny=eaglePerched(fourcreaturePlayerP,vec2(inversion,0.))+bodyWithArms.xyz;
                       swordSkew+=1.;}
                   else if (Character==7)mny=ox(fourcreaturePlayerP,vec2(inversion,0.))+bodyWithArms.xyz;
                   else if (Character==8)mny=man(fourcreaturePlayerP,vec2(inversion,0.))+bodyWithArms.xyz;
                   else if (Character==9)mny=bodyWithArms.xyz//+heart(characterPSpunToKey*(2.)*pow(-leaf,3.),moveDynamic*1.5)
                   +clamp(face(characterOnTrailP*1.221221,moveDynamic)+heart(characterPSpunToKey*min(resolution.x,resolution.y)/max(resolution.x,resolution.y)
                                                                            /gr,moveDynamic/5.),0.,1.);
                                                                           // else if (Character==10)mny=sealedMan(characterOnTrailP,moveDynamic);
                                                                         //   else if (Character==11)mny=sealedWoman(characterOnTrailP/1.44,moveDynamic);
                                                                         else if (Character==10)
                                                                         {
                                                                             mannyFace = (faceBlackAndWhite(characterOnTrailP*1.221221,moveDynamic,false,-1,false,-1.));//,0.,1.);
                                                                             
                                                                             mny=clamp(faceFORWARDTWO(characterOnTrailP/1.75//+vec2(.5,.0)
                                                                                                      ,moveDynamic)-(bodyWithArms.x+bodyWithArms.y+bodyWithArms.z)*100.,0.,1.)+bodyWithArms.xyz+mannyFace.xyz;
                                                                             }
                                                                         else if (Character==11)mny=faceBlackAndWhite( sign(characterOnTrailP)-characterOnTrailP,moveDynamic,false,0,false,-1.).xyz;

                                                                         else if (Character==12)mny=vec3(0.);
           }

                            
                                                                 float sidle =4.;

                                                                 
   
                                                                 /*
                                                                  if(vUv.x<1./sidle) bigEyes=          faceBlackAndWhite(vec2(-sign(vUv.y-.5)*
                                                                                                                              (tan(abs(vUv.y)*PI2+PI/2.))*vUv.x,sign(vUv.y-.5)*
                                                                           vUv.x*sidle*.5),moveDynamic,fals,-1.).xyz;
                                                                                                           else bigEyes=vec3(0.);
                                                                  */
 //  bigEyes=          faceBlackAndWhite(vec2(sign(vUv.x-.5)*(tan(vUv.x*PI2))*vUv.y*2.,vUv.y),vec2(0.),false,-1.).xyz;
                                                                 vec3 oneEye = vec3(0.);
                                                   
                                                                 
                                                                 
                                                                 vec2 eyeMatch=vec2(0.);
                                                            float winkColor = 1.;
                                                             vec2     winkMotion = vec2(0.);
                                                                 if(largeEyeColor!=0.){
                       eyeMatch = characterP/3.5*min(resolution.x,resolution.y)/max(resolution.x,resolution.y);
            winkColor=-1.;
                       winkMotion=moveDynamic*1.5;
                       }
                                                                 else if (eyeSingle)eyeMatch = characterP/4.;
                                                            if(major==0){
                                                             if(eyeSingle&&volume!=1.)
                                                                 {
                       oneEye =faceBlackAndWhite(eyeMatch,winkMotion,true,0,false,-1.).xyz*winkColor;
                                                                }
                                                            }
                                                            else if(eyeSingle)
                                                            {   vec2 majorPBaseline= characterP/5.;
                                                                if(major==2)majorPBaseline=spin2(majorPBaseline,   atan(d.y,d.x)-PIdiv2*3.-PI/12.*flipStar);

                                                                vec2 majorP = vec2(0.);;
                                                                float number =0.;
                                                                float eyeAMP = 1.;

                                                                              if((major==3)||majorPBaseline.x>0.)   {
                                                                                                                                                                                                                                                  if(major==3||majorPBaseline.y*flipStar<0.)
{

     if(!(major==3)||p.x<0.){
                                                                                        number =0.;
                                                                eyeAMP= texture2D( twelveNotesTex, vec2((number+.5)/12.,0)).x;
                                                                                                                                majorP=majorPBaseline/eyeAMP;
      oneEye +=faceBlackAndWhite(majorP,winkMotion,true,0,true,number).xyz*winkColor;
}
                                                                              }
                                                                              
                                                                                   if(!(major==3)||(p.x<0.&&p.y*flipStar<0.)){

                                                                                    number =1.;
                                                                eyeAMP= texture2D( twelveNotesTex, vec2((number+.5)/12.,0)).x;
                                                                                                                                majorP=majorPBaseline/eyeAMP;

                                                                                       oneEye +=faceBlackAndWhite(majorP,winkMotion,true,0,true,number).xyz*winkColor;
                                                                                   }
                                                                                }
                                                                                            if(!(major==3)||p.x<0.){

                                                                                    }
                                                                                    if(major==3||majorPBaseline.y*flipStar>0.){
                                                                                                                                                                                                                                                          if(major==3||majorPBaseline.x>0.)
{

                                                                                   if(!(major==3)||(p.x<0.&&p.y*flipStar<0.)){

                                                                                        number =2.;

                                                                eyeAMP= texture2D( twelveNotesTex, vec2((number+.5)/12.,0)).x;
                                                                                                                                                                                                                        majorP=majorPBaseline/eyeAMP;

                                                                                       oneEye +=faceBlackAndWhite(majorP,winkMotion,true,0,true,number).xyz*winkColor;
                                                                                    
                                                                                   }

                                                                                   if(!(major==3)||(p.x<0.&&p.y*flipStar<0.)){

                                                                                        number =3.;

                                                                eyeAMP= texture2D( twelveNotesTex, vec2((number+.5)/12.,0)).x;
                                                                                                                                                                                                                        majorP=majorPBaseline/eyeAMP;

                                                                                       oneEye +=faceBlackAndWhite(majorP,winkMotion,true,0,true,number).xyz*winkColor;
                                                                                   }
}
                                                                                }
                                                                                if(major==3||majorPBaseline.x<0.){

                                                                                if(major==3||majorPBaseline.y*flipStar>0.){

                                                                                    
                                                                                   if(!(major==3)||(p.x>0.&&p.y*flipStar<0.)){

                                                                                        number =4.;

                                                                eyeAMP= texture2D( twelveNotesTex, vec2((number+.5)/12.,0)).x;
                                                                                                                                                                                                                        majorP=majorPBaseline/eyeAMP;

                                                                                       oneEye +=faceBlackAndWhite(majorP,winkMotion,true,0,true,number).xyz*winkColor;
                                                                                   }

                                                                                   if(!(major==3)||(p.x>0.&&p.y*flipStar<0.)){

                                                                                        number =5.;
                                                                eyeAMP= texture2D( twelveNotesTex, vec2((number+.5)/12.,0)).x;
                                                                                                                                majorP=majorPBaseline/eyeAMP;

                                                                                       oneEye +=faceBlackAndWhite(majorP,winkMotion,true,0,true,number).xyz*winkColor; 
                                                                                   }

                                                                                   if(!(major==3)||(p.x>0.)){

                                                                                        number =6.;
                                                                eyeAMP= texture2D( twelveNotesTex, vec2((number+.5)/12.,0)).x;
                                                                 majorP=majorPBaseline/eyeAMP;

                                                                                       oneEye +=faceBlackAndWhite(majorP,winkMotion,true,0,true,number).xyz*winkColor;
                                                                                   }
                                                                                }

                                                                                   if(!(major==3)||(p.x>0.&&p.y*flipStar>0.)){

                                                                                        number =7.;
                                                                eyeAMP= texture2D( twelveNotesTex, vec2((number+.5)/12.,0)).x;
                                                                 majorP=majorPBaseline/eyeAMP;

                                                                                       oneEye +=faceBlackAndWhite(majorP,winkMotion,true,0,true,number).xyz*winkColor;   
                                                                                   }
                                                                                }
                                                                                if(major==3||majorPBaseline.y*flipStar<0.){
                                                                                                                                                                    if(major==3||majorPBaseline.x<0.){

                                                                                   if(!(major==3)||(p.x>0.&&p.y*flipStar>0.)){

                                                                                        number =8.;
                                                                eyeAMP= texture2D( twelveNotesTex, vec2((number+.5)/12.,0)).x;
 majorP=majorPBaseline/eyeAMP;
                                                                                       oneEye +=faceBlackAndWhite(majorP,winkMotion,true,0,true,number).xyz*winkColor;
                                                                                   
                                                                                   }

                                                                                   if(!(major==3)||(p.x<0.&&p.y*flipStar>0.)){

                                                                                        number =9.;
                                                                eyeAMP= texture2D( twelveNotesTex, vec2((number+.5)/12.,0)).x;
                                                                 majorP=majorPBaseline/eyeAMP;

                                                                                       oneEye +=faceBlackAndWhite(majorP,winkMotion,true,0,true,number).xyz*winkColor;
                                                                                   
                                                                                   }

                                                                                   if(!(major==3)||(p.x<0.&&p.y*flipStar>0.)){

                                                                                        number =10.;
                                                                eyeAMP= texture2D( twelveNotesTex, vec2((number+.5)/12.,0)).x;
                                                                 majorP=majorPBaseline/eyeAMP;

                                                                                       oneEye +=faceBlackAndWhite(majorP,winkMotion,true,0,true,number).xyz*winkColor;
                                                                                                                                                    }                                                                 }
                                                                                }
                                                                                if(major==3||majorPBaseline.x>0.){
                                                                                                                                                                    if(major==3||majorPBaseline.y*flipStar<0.){

                                                                                   if(!(major==3)||(p.x<0.&&p.y*flipStar>0.)){

                                                                                        number =11.;
                                                                eyeAMP= texture2D( twelveNotesTex, vec2((number+.5)/12.,0)).x;
                                                                 majorP=majorPBaseline/eyeAMP;

                                                                                       oneEye +=faceBlackAndWhite(majorP,winkMotion,true,0,true,number).xyz*winkColor;
                                                                            }
                                                                        }
                                                                        }
                                                                                    
                                                                                     /*   number =12.;
                                                                eyeAMP= texture2D( twelveNotesTex, vec2((number+.5)/12.,0)).x;
                                                                 majorP=majorPBaseline/eyeAMP;

                                                                                       oneEye +=faceBlackAndWhite(majorP,winkMotion,true,0,true,number).xyz*winkColor;
                                                                                    */
                                                                                    }
                                                       if(oneEye.x!=0.&&mny.g!=0.)mny=oneEye;

                                                                 vec3 bigEyes = vec3(0.);
  if(largeEyeColor==1.||largeEyeColor==-1.)
                                                                 {
                   // if(length(characterOnTrailP)>.25)//for the eyezone on lttle manny, for G and A eyes
                       bigEyes = clamp(face(eyeMatch,moveDynamic*1.5),0.,1.);//dimensions seem difficult to manage
                   }
 else if (largeEyeColor== 3.) bigEyes = clamp(shiny(eyeMatch,moveDynamic*1.5),0.,1.);
    else if(largeEyeColor==4.)
                        bigEyes=faceBlackAndWhite(eyeMatch,moveDynamic*1.5,false, 0,false,-1.).xyz;
                                                                 
                                                  if(musicAngelMan>0&&Character!=3&&Character!=4)
                                                                       {
                                                             float divisor = 1.;
                                                             if(gameOn)divisor=1.5;
                                                             AM+=faceFORWARD(characterOnTrailP*angelSize,moveDynamic)/divisor;
                                                             AM=clamp(AM,0.,1.);
                                                            if(mny.r!=0.||mny.g!=0.||mny.b!=0.) AM*=mny;
                                                         //    mny+=AM;
                                                             }
                                                                 
                                                              //   eyeMatch*=1.5;
                                                                 vec3 unrolledEyes = vec3(0.);
                                                                                                    if (unroll==1){
                                                                           vec2  vUvSplit = vUv;
                                                                                      if (vUv.x>.5)vUvSplit=vec2(abs(1.-vUv.x),vUv.y);
                                                                             if(vUvSplit.x<1./sidle) unrolledEyes=          faceBlackAndWhite(vec2(-sign(vUvSplit.y-.5)*
                                                                                                                                         (tan(abs(vUvSplit.y)*PI2+PI/2.))*vUvSplit.x,sign(vUvSplit.y-.5)*
                                                                                                                                              vUvSplit.x*sidle*.5),-vec2(moveDynamic.x,-moveDynamic.y),false,-2,false,-1.).xyz;
                                                                                                                                              }
                                                                 vec4 insideOut = vec4(0.);
                                                                 if(inseyedOut!=0){
                       vec2 bounce =characterP;
                       float leafDivGR=leaf/gr;

                       if(inseyedOut==2) bounce/=1.75;
                       else bounce*=-leafDivGR;

                       vec2 eyeSwivel = vec2(0.);
                       if (volume==1.)eyeSwivel=move/2.;
                       else if (volume>zoomOutRatchetThreshold)eyeSwivel=d.yx;
                       else eyeSwivel=vec2(0.);
                     insideOut= roundEyes(bounce,eyeSwivel);
                     if(insideOut.w==.5){
                      //  if(oneEye.r!=0.) oneEye/=1.5;
                      if(insideOut.g==0.){
                          if(insideOut.b==0.)insideOut.r/=1.5;
                          else  if(insideOut.r==0.)insideOut.b/=1.33;}
                      else if((insideOut.g>insideOut.b&&insideOut.r==0.)||(insideOut.g>insideOut.r&&insideOut.b==0.))insideOut/= 5./3.;
                      
                        //insideOut=vec4(insideOut.r/1.3,insideOut.g,insideOut.b,insideOut.w);
                        // insideOut/=1.1;
                         }
                     else
                     {insideOut=vec4(clamp(insideOut.xyz,.05,.9),1.);
                         insideOut+=clamp(AM.r,0.,1.)/2.;
                         }
                     }
float outerARMS = 0.;
if(handOfGod)
{
        float angle =atan(d.x,d.y);
             if(length(characterP)>1.25)  outerARMS = spinningArms(characterP*vec2(1.,(-upOrDown)*flipStar),d,angle*upOrDown*flipStar,1.,true,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.).x;
                      //        outerARMS = spinningArms(characterP,d,-angle,1.,true,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.).x;

}

                                                                 vec3 moreHorns = vec3(0.);
                                                                 if (elderHorns>0)
                                                                 {
                                                                
                                                                
                                                                vec2 cross = characterOnTrailP;

                                                                                                                                if(abs(cross.x)<abs(cross.y))
                                                                                                      cross=cross.yx;
                                                                                                      // cross.y*=4./3./log(3.);
                                                      if(cross.x>0.)
                                                                                     cross.x = -cross.x;
                                                                        
                                                                 moreHorns=mannyFace.xyz-faceBlackAndWhite(cross*1.221221,-vec2(0.),false, 100,false,-1.).xyz;
                                                                 }
                                 //          mny=clamp(mny,0.,1.);
                                                                 
                                                                 float frAMP=1.;
                                                                 float heartRate =1./4.;
                                                                  float heartInEyeSize=gr*gr*-leaf*3.;
                                                                 float heartSize=heartInEyeSize;

                                                                 
                                                                 
                                                                 
                                                                 vec2 moveDynamicSpunToKey=spin2(moveDynamic*vec2(1.,flipStar*brelued)///.8
                                                                 , -(//starSpin*mod(time*rate,PI*2.)-
                                                                 twistStar*brelued));

                                                                 vec2 vUvCenteredASKEW = (vUv.yx-.5-d.yx*heartRate*aspectRatio);
                                                                 vec2 uVuASKEW=-(vUvCenteredASKEW)/(aspectRatio);
                                                                // vec2 uVuMinCenterASKEW=-vUvCenteredASKEW/(min(resolution.x,resolution.y)/resolution.yx);

                                                                 vec2 uVuCenterASKEWSpunToKey=spin2(uVuASKEW*vec2(1.,flipStar*brelued)///.8
                                                                 , -(//starSpin*mod(time*rate,PI*2.)-
                                                                 twistStar*brelued))*8.;

                                                                 vec2 uvSwizzled=uVuCenterASKEWSpunToKey.yx;


                                    float angleASKEW = ((-atan(uvSwizzled.y,uvSwizzled.x)*flipStar-twistStar
                                 +PIdiv2*flipStar)*divideByMultiplyingPi2)+.5;
            //angle=mod(angle,1.);

                                 
if(heartStar==0){
         
            //return vec4(angle);
            //   const float octBoost = 17.;
            //  float b =nyq*pow(2.,angle+octBoost);
            //starts -3, full -2
         /*  for (float n = -1.; n<11.;n+=1.0)//the range seems small
            // if(b>=.5/nyq&&b<sampleRate/2.)
            //not sure why it has negative range
            //if (twistStar<24.)
            {
            float b =1./sampleRate*pow(2.,angleASKEW+n)*concertKeyTuning;
            frAMP += texture2D(micIn, vec2(b,0.)).r;
           }*/
          //  float     
                     frAMP = texture2D(radialFrequenciesSummed, vec2(mod(angleASKEW+10.-1./12.,1.),0.)).r;

         //  if (abs(frAMP-frAMP2)<20./255.)mny+=1.;
            
}




     vec2 heartShift = vec2(0);
     vec3 HEART = vec3(0.);
     vec3 heartWarmed= vec3(0.);
     if (Character!=10&&colorCombo!=20&&colorCombo!=17){
                       
if (Character==4||Character==3) {heartSize=1.5;
    heartShift=vec2(.5,0.);}
                                                            //else if(Character==2)heartSize=gr;
                                                            
                                                            float direction = 1.;
                                                            if (Character==0&&holyeyes==1)
                                                            {//heartSize*=1.75;
                                                                direction=-1.;
                                                                }
                                                          //  else heartSize*=6./5.;

if(volume!=1.)
{//frAMP-=volume*(zoomOutRatchetThreshold)*16.;
//frAMP*=(.5+frAMP)/(1.+zoomOutRatchetThreshold);
}
if(heartStar==0&&frAMP>0.&&volume!=1.&&maxSamp< volume*volume //&&minSamp*3.<maxSamp
)
{
  // if (rnd(mod(angleASKEW+10.,1.)*12.)==1.)
 heartSize/=frAMP/(sqrt(volume)+zoomOutRatchetThreshold)*note/(3.);//*8.;
    direction/=3.;}

else if(heartStar==1&&volume!=0.){
    heartSize/=(1.+volume);//multiplied by two if heart argument is not vec2(0.)
    frAMP=volume*4.;
    }

else if(heartStar==2) frAMP=1.;
                                                            vec2 heartPitch = vec2(0.);
                                                            if(volume!=0.&&volume!=1.)
                                                            {
                                                              float  noteAngle=(note/12.*PI2*flipStar*brelued+twistStar+PIdiv2);
                                                                heartPitch=-direction*spin2(vec2(-zin(-noteAngle),-coz(noteAngle)),-twistStar)/4.;
                                                                // heartPitch=-direction*spin2(-d.yx,-twistStar)/4.;
                                                                                            }
                                                            
vec2 heartField = characterPSpunToKey*heartSize
+heartShift;
     if(Character!=9&&(heartStar!=3))
     {  if(volume!=1.&&frAMP>0.)
         HEART = heart(heartField
                                                    ,//vec2(0.)
                      heartPitch*vec2(1.,flipStar)+
                       heartField/frAMP*heartRate//*flipStar//*vec2(1.,flipStar)// not working on some androids, may work with vec2(0.)
                                    );
                                    else         HEART = heart(heartField,vec2(0.));
                                    }

     //*(1.-length(uVuMinCenterASKEW)/8.)
      
                    
                    /*
     vec3 heartMultiplier = vec3(1.);
     heartMultiplier=HEART.xyz+(1.-length(characterPSpunToKey*heartSize));
    if(length(characterPSpunToKey*heartSize)>0.)heartMultiplier=vec3(1.);
                if(mannyFace.z>0.)heartMultiplier+=mannyFace;
   if(mannyFace.z>0.)heartMultiplier*=mannyFace;
*/
                       //  heartWarmed = HEART/2.;
          
                       // else   clothes*=HEART;

                            
                       //mny+=clothes/2.;

//mny+=clamp(heartWarmed+(-mny.r-mny.g-mny.b),0.,1.);//+HEART*heartMultiplier;
                           
                           }

                                                                 
                                           
                           


















vec3 Shekina = vec3(0.);

//recalculation
vec2 vUvCenteredASKEW2 = (vUv.yx-.5);
vec2 uVuASKEW2=-(vUvCenteredASKEW2)/(aspectRatio);
vec2 uVuCenterASKEWSpunToKey2=spin2(uVuASKEW2*vec2(1.,flipStar)///.8
,
twistStar);

vec2 uvSwizzled2=uVuCenterASKEWSpunToKey2.yx;


            float angleASKEW2 = ((-atan(uvSwizzled2.y,uvSwizzled2.x)*flipStar-twistStar
                                 +PIdiv2*flipStar)*divideByMultiplyingPi2)+.5;
float frAMP2 = texture2D(radialFrequenciesSummed, vec2(mod(angleASKEW2+10.-1./12.,1.),0.)).r;
//if (rnd(mod(angleASKEW2+10.,1.)*12.)==1.)
if(frAMP2>0.&&volume!=1.&&maxSamp< volume*volume )//&&minSamp*3.<maxSamp)
{
    float shekinaSize=1./(frAMP2*frAMP2/(volume)*note)*1024.*length(uVuASKEW2);//*8.;
    if (shekinaSize>.5&&shekinaSize<.6)Shekina=vec3(1.25-15.*(shekinaSize-.5));
    }
     









                
                      
     
                                 float recenter = 0.;
                                  float rescale = 1.;
                                 if (colorCombo==20&&!(musicAngelMan>0&&(Character==3||Character==4)))
                                 {recenter=2./1.75/(shaderScale)/(resolution.y/min(resolution.x,resolution.y));//may not be exactly centered
                                    rescale = 2.;
                       }

                               vec2  starshipLOOKUP = ((vUv-.5)+vec2(0.,recenter))*rescale+.5;
                                 
    vec4 starship=vec4(0.);
                                 float isBlack =1.;
                                 vec3 starshipMultiplier = vec3(1.);
                                 float isGrey =0.;
                                                                 
                                                                 float isWhite = 0.;

                                                          
                                                                 float isGreyISH = 0.;
                                                                 float shipSUM =0.;

                    vec3 isColoredMultiplier = vec3(1.);
                                 float maxColorOfStarship=1.;
                                 float minColorOfStarship=0.00000001;
                                 float spirographTranslucer = 1.;


if(starOnDot!=2){
                                 if (starshipLOOKUP.x<1.&&starshipLOOKUP.y<1.&&starshipLOOKUP.x>0.&&starshipLOOKUP.y>0.)starship = texture2D(STAR,starshipLOOKUP);
                                 
                                 if (starship.x!=0.||starship.y!=0.||starship.z!=0.)maxColorOfStarship=max(max(starship.x,starship.y),starship.z);
                                 if (starship.x!=0.||starship.y!=0.||starship.z!=0.)minColorOfStarship=min(min(starship.x,starship.y),starship.z);
                                 if (starship.x!=0.||starship.y!=0.||starship.z!=0.)isColoredMultiplier=(starship.xyz+(1.-starship.w)+1.)/2.;
                                 /*if(starship.w>3.5/255.)
                                 {
                                     
                                             if(mannyFace.w==-.25&&starship.g==1.&&starship.r==0.)starship/=2.;
                                               
                                 if(mny.z==mny.y&&mny.y==mny.x&&mny.x!=0.)
                                 {
                                     if(mny.x>0.)mny*=starship.xyz*+(1.-starship.w);//-mny.x*.66;
                                    // else if(mny.x<0.)mny+=starship.xyz*2.;
                                     
                                         
                                     
                                     }
                                 if(mny.z!=0.||mny.y!=0.||mny.x!=0.)mny+=starship.xyz;
                                 }*/

                                 if(AM.x>0.)AM=clamp(AM*(.888+starship.xyz),0.,1.);//-mny.x*.66;

                     if(starship.w>0.){starshipMultiplier=vec3(1.);
                     if(insideOut.w!=.5)insideOut*=.888;
                     }
                     if(AM.x!=0.)heartWarmed=clamp((AM*HEART+AM*mny)+(-mny.r-mny.g-mny.b)*4. ,0.,1.);
                        else heartWarmed=HEART/2.;


                         if(HEART.x==0.&&HEART.y==0.&&HEART.z==0.)
                         {heartWarmed=AM;
                             }
                         if((heartWarmed.x!=0.||heartWarmed.y!=0.||heartWarmed.z!=0.)&&oneEye.y!=0.)   heartWarmed-=oneEye/1.5;

                                 if(mannyFace.z>0.&&mannyFace.x>0.&&mannyFace.z>0.) starshipMultiplier=vec3(1.);;//starshipMultiplier=vec3(1.25);
                    if(mannyFace.z<0.&&mannyFace.x<0.&&mannyFace.y<0.)starshipMultiplier=starshipMultiplier=vec3(1.);//vec3(.75);
    if (starship.x==0.&&starship.x==starship.y&& starship.y==starship.z&&starship.w>3.5/255.)isBlack=starship.x;
    shipSUM = starship.x+starship.y+starship.z;

                                 if (starship.x==starship.y&& starship.y==starship.z&&starship.x<.51&&starship.x>.49)isGrey=starship.x;
                if(starship.x*starship.w>=.5&&starship.y*starship.w>=.5&&starship.z*starship.w>=.5&&starship.x==starship.y)isGreyISH=shipSUM/3.;
                                     
                                     if (starship.x==starship.y&& starship.y==starship.z&&starship.x==1.)isWhite=starship.x;

     //if (starship.x!=0.&&starship.x!=1.&&starship.x!=.5&&(starship.x+starship.y>=255.-3.5||starship.y+starship.z>=255.-3.5||starship.z+starship.x>=255.-3.5)&&starship.w==1.)spirographTranslucer=.75-(starship.x+starship.y+starship.z)/2.;
                                 }
                                 vec4 DOTstarship=vec4(0.);
                                 float isBlackDOT =1.;
                                 float spirographTranslucerDOT = 1.;
                                 float DOTmaxColorOfStarship=1.;


                                 float isGreyDOT =0.;

if(starOnDot==1||starOnDot==2){
                       float dotstarscale = 1.;
                       vec2  DOTstarshipLOOKUP = mod((vUv)-(dotCoord)/2.*resolution.yx/max(resolution.x,resolution.y)-.5+.5/dotstarscale,1.);//-.125-.25
        if (DOTstarshipLOOKUP.x<1.&&DOTstarshipLOOKUP.y<1.&&DOTstarshipLOOKUP.x>0.&&DOTstarshipLOOKUP.y>0.)DOTstarship = texture2D(STAR,DOTstarshipLOOKUP);
        


        if (DOTstarship.x==0.&&DOTstarship.x==DOTstarship.y&& DOTstarship.y==DOTstarship.z&&DOTstarship.w>3.5/255.)isBlackDOT=DOTstarship.x;
        
        if (DOTstarship.x==DOTstarship.y&& DOTstarship.y==DOTstarship.z&&DOTstarship.x<.51&&DOTstarship.x>.49)isGreyDOT=DOTstarship.x;

        
        if(DOTstarship.x!=0.||DOTstarship.y!=0.||DOTstarship.z!=0.)DOTmaxColorOfStarship=max(max(DOTstarship.x,DOTstarship.y),DOTstarship.z);
        

      //  if(DOTstarship.x!=0.&&DOTstarship.x!=1.&&DOTstarship.x!=.5&&(DOTstarship.x+DOTstarship.y>=255.-3.5||DOTstarship.y+DOTstarship.z>=255.-3.5||DOTstarship.z+DOTstarship.x>=255.-3.5)&&DOTstarship.w==1.)spirographTranslucerDOT=.75-(DOTstarship.x+DOTstarship.y+DOTstarship.z)/2.;
      
                   }
                                 vec4 StaRivers=vec4(0.);
                                 if(eden==2||eden==4)
                                 {
                                StaRivers=texture2D(EDEN,vUv);
                                starship *= vec4(0.);
                                }
                                 
                                 float spirographTranslucerStaRivers = 1.;
                                // if (StaRivers.x!=0.&&StaRivers.x!=1.&&StaRivers.x==.5&&(StaRivers.x+StaRivers.y>=255.-3.5||StaRivers.y+StaRivers.z>=255.-3.5||StaRivers.z+StaRivers.x>=255.-3.5)&&StaRivers.w==1.)spirographTranslucerStaRivers=(StaRivers.x+StaRivers.y+StaRivers.z);
                                 
           float isBlackStaRivers =1.;//or black
           if (StaRivers.x==StaRivers.y&& StaRivers.y==StaRivers.z&&StaRivers.x<3.5/255.&&StaRivers.w>3.5/255.)isBlackStaRivers=StaRivers.x;
                                 
                                 float isGreyStaRivers =0.;

                                 if (StaRivers.x==StaRivers.y&& StaRivers.y==StaRivers.z&&StaRivers.x<.51&&StaRivers.x>.49)isGreyStaRivers=StaRivers.x;

                                 
                                 vec3 pillar = vec3(0.);
                                 pillar = sevenPillars(vUv.yx-vec2(0.,.5));
                                                     if(pillar.x!=0.||pillar.y!=0.||pillar.z!=0.)         pillar=   clamp(pillar+(-mny.x-mny.y-mny.z)*40.,0.,1.);
                                 vec3 hypnoticHarmonicCircles = vec3(0.);
                                                                
                                 if(ringSpring)
                                 {
                                    vec2 rr = r;//* min(resolution.x,resolution.y)/max(resolution.x,resolution.y);
                                                            float number =0.;
                                                               
                                    hypnoticHarmonicCircles+=ring(rr,number);
                                    number =1.;
                                                               
                                    hypnoticHarmonicCircles+=ring(rr,number);
                                    number =2.;
                                                               
                                    hypnoticHarmonicCircles+=ring(r,number);
                                    number =3.;
                                                               
                                    hypnoticHarmonicCircles+=ring(rr,number);
                                    number =4.;
                                                               
                                    hypnoticHarmonicCircles+=ring(rr,number);
                                    number =5.;
                                                               
                                    hypnoticHarmonicCircles+=ring(rr,number);
                                    number =6.;
                                                               
                                    hypnoticHarmonicCircles+=ring(rr,number);
                                    number =7.;
                                                               
                                    hypnoticHarmonicCircles+=ring(rr,number);
                                    number =8.;
                                                               
                                    hypnoticHarmonicCircles+=ring(rr,number);
                                    number =9.;
                                                               
                                    hypnoticHarmonicCircles+=ring(rr,number);
                                    number =10.;
                                                               
                                    hypnoticHarmonicCircles+=ring(rr,number);
                                    number =11.;
                                                               
                                    hypnoticHarmonicCircles+=ring(rr,number);
                                    
                                 }
                                 if(balloonsON!=0.||balloonsONexponential!=0.)
                                 {
                                    if(maxColorOfStarship!=1.) hypnoticHarmonicCircles+=clamp(balloons(p)-shipSUM,0.,1.);
                                    else hypnoticHarmonicCircles+=balloons(p);
                                }
                                                                                if(bodyWithArms.w==1.)
                                                                                {hypnoticHarmonicCircles=bodyWithArms.xyz;
                                                                                }
                                                                                if(hypnoticHarmonicCircles.x!=0.||hypnoticHarmonicCircles.y!=0.||hypnoticHarmonicCircles.z!=0.)
                                                                                {
                                                                                   HEART=hypnoticHarmonicCircles;
                                                                                }
                                                                 
                    vec4 pixelStarship=vec4(0.);
                                                                 float mnyWhite=1.;
         float pixelShipGrey = 0.;
         vec4 icicles=vec4(0.);
         vec4 linearFrequency=vec4(0.);
                                                                 vec3 pong = vec3(0.);
                                                                 vec2 vUvCentered = (vUv.yx-.5);
vec3 pongBall = vec3(0.);
                     if(pongOn){//may be useful to seperate pong from pixelStar
                          pong += paddles(vUvCentered.yx);
                          pongBall += ball(p);
                          }
                                                                 
                                                                 
                                                                 
                                                                 
                 float sevenPillarShrink = pillarScale*2./max(resolution.x,resolution.y);
                 vec2 adjustedvUv=vec2(vUv.x,(vUv.y-sevenPillarShrink)/(1.-sevenPillarShrink));
                                                                 vec4 GOH =vec4(0.);
                                                                 if(gates)
                                                                 {
                            GOH=
                   
                                                            gatesOfHeaven(vec2(vUv.x,1.-vUv.y),9.)
                                                                 +gatesOfHeaven(vec2(1.-vUv.y,1.-vUv.x),0.)
                                                               //   +gatesOfHeaven(vec2(adjustedvUv.y,adjustedvUv.x),6.)
                                                                  +gatesOfHeaven(vec2(vUv.y,vUv.x),6.)
                                                                 +gatesOfHeaven(vec2(1.-vUv.x,vUv.y),3.)
                                                                 ;
                                                                 }
                                                                 
                                                                 
                                                                 
                                                                 vec2 uVu=-(vUvCentered)/aspectRatio;
                                                                 vec2 uVuMinCenter=-vUvCentered/(min(resolution.x,resolution.y)/resolution.yx);
                         
         if (pixelSTARon) pixelStarship = audioEq(uVuMinCenter);
            if(linearEQ){
                                 
             linearFrequency=linearFrequencyEQ(adjustedvUv);
             linearFrequency+=linearFrequencyEQ(vec2(1.-adjustedvUv.x,adjustedvUv.y));
             
             if (pongOn&&linearFrequency.x==linearFrequency.y&&linearFrequency.y==linearFrequency.z&&linearFrequency.z==linearFrequency.x&&linearFrequency.x!=0.)
             pong+=linearFrequency.xyz*10.;
             }
            // linearFrequency/=2.;
          
    if ( icicle)icicles = waveForm();
            
             //if(mny.z==mny.y&&mny.y==mny.x&&mny.x!=0.&&pixelStarship.w>0.)
            // mny*=pixelStarship.xyz;//-mny.x*.66;
                                 
 if(pixelWitnesses){
vec4 starBuffer = vec4(0.);
//for (float x = 0.; x<12.;x++) 
starBuffer+=starns(uVu//,x
);

//if(isGrey==0.)

if (starBuffer.x==starBuffer.y&& starBuffer.y==starBuffer.z&&starBuffer.z!=0.){
    
pixelShipGrey=starBuffer.x;
//if((bodyWithArms.r!=0.||bodyWithArms.g!=0.||bodyWithArms.b!=0.))bodyWithArms=vec4(vec3(pixelShipGrey*12.),1.);
}
if(pixelShipGrey!=0.)
{
if(isBlack==0.)pixelShipGrey=(.5+pixelShipGrey);
//if(isGrey>0.)pixelShipGrey=-1.;;
}
if(mny.r!=0.||mny.g!=0.||mny.b!=0.)mny-=pixelShipGrey*12.;
//pixelStarship += starBuffer;


}
if ((HEART.x!=0.||HEART.y!=0.||HEART.z!=0.)&&oneEye.r!=0.)
{
    //oneEye=HEART/4.;
    //HEART=-oneEye;
  // heartWarmed=-oneEye;
}
if(oneEye.r!=0.)zoomer=-oneEye;

   if(oneEye.r!=0.&&pixelShipGrey!=0.)oneEye=vec3(-pixelShipGrey*2.);
  // if((starship.r!=0.||starship.g!=0.||starship.b!=0.)&&isGreyISH!=0.&&pixelShipGrey!=0.)starship=vec4(vec3(pixelShipGrey),1.);
  //  if(bodyWithArms.z!=0.&&pixelShipGrey!=0.)bodyWithArms=vec4(vec3(pixelShipGrey),bodyWithArms.z);
                                 heartWarmed-=(pillar.x+pillar.y+pillar.z)*100.;
            vec3 seeThrough = pixelStarship.xyz+(1.-pixelStarship.w*pixelStarship.w);
             
            
         /*    if(mny.z>0.&&mny.y>0.&&mny.x>0.){
             mnyWhite=0.;//-mny.x*.66;
             mny*=seeThrough;
             }
          */
             if(heartWarmed.z==heartWarmed.y&&heartWarmed.y==heartWarmed.x&&heartWarmed.x!=0.&&pixelStarship.w>0.)
             heartWarmed*=seeThrough;//-mny.x*.66;

             

    
                                                         
                                                                 vec3 ARTICLE=vec3(0.);

                                                                 
                                                     if(articles){
                                                                        
                                                            vec3 HORSE=horse(characterOnTrailP, moveDynamic);
                                                             ARTICLE+=scroll(characterOnTrailP+1.5*vec2(0.,resolution.x/min(resolution.x,resolution.y)),vec2(-1.));
                                                             vec3 SWORD = sword(characterOnTrailP+vec2(swordSkew,0.),vec2(0.));
                                                             vec2 c4 = characterOnTrailP/vec2(1.,2);
                                                              vec3 LAMP = clamp(lamp(c4,vec2(-1.))-(SWORD.x+SWORD.y+SWORD.x)*10.,0.,1.)+SWORD;
                                                              float ls = (SWORD.x+SWORD.y+SWORD.z+LAMP.x+LAMP.y+LAMP.z)*1000.;
                                                         //     clothes=clamp(clothes-ls,0.,1.);
                                                        //      heartWarmed=clamp(heartWarmed-ls,0.,1.);

                                                            ARTICLE+=clamp(flames(-c4-vec2(.5,0.))-(ls+HORSE.r*3.),0.,1.)+HORSE+SWORD+LAMP;
                                                                         
                                                                    //working on buggy android:sword,horse,lamp
                                                                    
                                                                    //not working:flames
                                                                    
                                                                    }
                                                                 
                                                                
                                          

                                                                 
                                                                 
                                                                 
                                                                 vec2 faceDimension = ((1.-vUv));
                                                                 vec2 faceDimensionReversed =   vec2(vUv.x,1.-vUv.y);
                                                              vec4 yourFace= vec4(0.);
                                                                 //  yourFace=texture2D(videoTexture,faceDimension).xyzw+
                                                            //   texture2D(videoTexture2,faceDimensionReversed).xyzw//over the top cam
                                                                 ;
                                 if(linearFrequency.x!=0.||linearFrequency.y!=0.||linearFrequency.z!=0.)   unrolledEyes=vec3(0.);
                                 if(linearFrequency.x!=0.&&linearFrequency.y!=0.&&linearFrequency.z!=0.)   unrolledEyes=vec3(.5);

                                 if(pong.x!=0.||pong.y!=0.||pong.z!=0.)   unrolledEyes=vec3(0.);
                                 if(abs(GOH.x)>.75&&unrolledEyes.x!=0.&&unrolledEyes.z!=0.&&unrolledEyes.y!=0.)   {
                       unrolledEyes=vec3(.5);
                       GOH=vec4(0.);
                       }
                                 heartWarmed=clamp(heartWarmed,-1.5,1.5);

                               if(heartWarmed.x!=0.)  heartWarmed-=zoomer/8.;
                                 mny=clamp(mny,-1.,1.);
                                 if(mny.x==mny.y&&mny.y==mny.z&&Character==0&&mannyFace.w!=-.25&&oneEye.r==0.)
                                 {
                                 if(mny.x>0.)
                       mny-=zoomer/2.;
                                 else if(mny.x<0.)
                       mny+=zoomer/4.;
                       
                       }
                               
                      // float zoomerSum = zoomer.r+zoomer.g+zoomer.b;

                                // if(isGreyISH==129./255.&&starship.w==1.)bodyWithArms=vec4(vec3(.5)+bodyWithArms.xyz/2.,1.);

                                 if(colorCombo!=17&&colorCombo!=20)
                                 {
                       if (clothes.r>=1.){mny=vec3(0.);if(bodyWithArms.w!=1.)bodyWithArms=vec4(0.);}
                       if (clothes.r!=0.&&starship.b!=0.)clothes*=starship.xyz+.25;
                       mny+=clamp(clothes-bodyWithArms.w*100.,0.,1.)+bodyWithArms.xyz*bodyWithArms.w*clamp(clothes*100000.,0.,1.);
                       }

                                              if(oopm.x!=0.||oopm.y!=0.){HEART=oopm.xyz;heartWarmed=oopm.xyz;}
                                       /*       float insideOutSUM = insideOut.x+insideOut.y+insideOut.z;
                                             // insideOutSUM/=1.5;
                                              if((insideOutSUM!=0.)&&(HEART.x!=0.||HEART.y!=0.||HEART.z!=0.)){HEART=
                                                clamp(HEART-insideOutSUM,0.,1.)+insideOut.xyz;heartWarmed=clamp(heartWarmed-insideOutSUM,0.,1.)+insideOut.xyz;}
*/
      if ((starship.x!=starship.y||starship.y!=starship.x||starship.z!=starship.x||starship.z!=starship.y)&&shipSUM<126./255.&&starship.w==1.)
      {
        HEART*= shipSUM*4.;//to show black on oreo
      }
      


                                                  vec4 layeredOUT =vec4(0.);
                          // if (isBlack==1.&&starship.w==1.)layeredOUT=vec4(vec3(0.),1.);
                   
                     if(constellation||squirgle==1)layeredOUT=vec4(zoomer,1.);
                                 else if(length(p)<2.*sqrt2/min(resolution.x,resolution.y)) layeredOUT=vec4(zoomer,1.);
                           else if(pixelShipGrey!=0.&&bodyWithArms.w==1.&&starship.x==starship.y&&starship.y==starship.z)
                    {
                        if(starship.w!=0.)
                        {
                        if(isGreyISH==1.) layeredOUT=vec4(.75);
                        else if(isGreyISH==0.) layeredOUT=vec4(.25);
                        }
                        else layeredOUT=vec4(pixelShipGrey+.25);
                       if(!(bodyWithArms.x==bodyWithArms.y&&bodyWithArms.y==bodyWithArms.z)) layeredOUT=layeredOUT*.75+bodyWithArms;
                        
                    }                     
                    else if (Shekina.r!=0.)layeredOUT=vec4(Shekina.r);
                     else if (hypnoticHarmonicCircles.x==hypnoticHarmonicCircles.y&&hypnoticHarmonicCircles.x==hypnoticHarmonicCircles.z&&hypnoticHarmonicCircles.x!=0.)layeredOUT=vec4(vec3(hypnoticHarmonicCircles.x),1.);
                  
                                              else if(oneEye.r==-1.)
                                              {
                                                if(oopm.r==.5&&oopm.b==.5)layeredOUT=vec4(vec3(.5),1.);
                                                else if (starship.x!=0.||starship.y!=0.||starship.z!=0.)layeredOUT=vec4(starship.xyz+.25,1.);
                                                else layeredOUT=vec4(vec3(2.),1.);
                                                if(pixelShipGrey!=0.)
                                                {layeredOUT*=pixelShipGrey;
                                                    layeredOUT-=pixelShipGrey;
                                                }
    
                                              }
                 
                                 else if(starship.x==starship.y&&starship.z==starship.x&&(starship.x==254./255.||starship.x==1./255.)&&starship.w!=0.)layeredOUT=vec4(vec3(starship.r+mannyFace*(starship.r/2.+.5)),1.);
                   else if (mannyFace.w==.75)  {
                       if (starship.w>0.&&shipSUM<341./255.)layeredOUT=vec4(mannyFace.xyz+starship.xyz,1.);

                                 else      if(  !((HEART.x==0.&&HEART.y==0.)||(HEART.y==0.&&HEART.z==0.)||(HEART.z==0.&&HEART.x==0.)))
                                 layeredOUT=vec4(mannyFace.xyz+HEART-oneEye.r,1.);
                                 else                                layeredOUT=vec4(mannyFace.xyz-oneEye.r,1.);
                                 }
                                                                 
else if(mannyFace.w==.5)//detect if in eyeHolies, if so output grey
{
    
    if(  heartSize>heartInEyeSize*heartInEyeSize*length(characterOnTrailP*(vec2(4.,gr)))&&
       
       
!((HEART.x==0.&&HEART.y==0.)||(HEART.y==0.&&HEART.z==0.)||(HEART.z==0.&&HEART.x==0.))
       
       )
       layeredOUT=vec4(clamp(mannyFace.xyz-4.*(HEART.r+HEART.g+HEART.b),0.,1.)+HEART,1.);
       
    //else if(!(starship.x==.5||starship.y==.5||starship.z==.5))
    //layeredOUT=vec4(clamp(mannyFace.xyz+(-starship.x-starship.y-starship.z)*10.,0.,1.)+starship.xyz,1.);
    
    else if(starship.x==starship.y&&starship.y==starship.z&&starship.x>=1.)
             layeredOUT=vec4((mannyFace.xyz+starship.xyz/1.5),1.);
             else if(starship.y==0.&&starship.x==0.&&starship.z==0.&&starship.w>3.5/255.)layeredOUT=vec4(mannyFace.xyz*.25,1.);
             else if (starship.w>0.&&shipSUM<341./255.)layeredOUT=vec4(mannyFace.xyz+starship.xyz,1.);
    else layeredOUT=vec4(mannyFace.xyz,1.);
    //if(colorCombo==-1)layeredOUT=vec4(clamp(layeredOUT.xyz-zoomer,0.,1.)+zoomer/2.5,1.);
}

                                 else if(isGreyISH>=129./255.&&isGreyISH!=1.&&starship.x==starship.y&&starship.y==starship.z)layeredOUT=vec4(vec3(.5),1.);
                                                         else if (oopm.r!=0.||oopm.g!=0.)
                                                         {
                                                         if(pixelShipGrey!=0.)layeredOUT=vec4(pixelShipGrey);
                                                         else layeredOUT=oopm;

                                                         }
else if (starship.w==254./255.)layeredOUT=starship-oneEye.r/3.;
         else if (holyeyes==1&&Character==0&& !((HEART.x==0.&&HEART.y==0.)||(HEART.y==0.&&HEART.z==0.)||(HEART.z==0.&&HEART.x==0.)))
                                 {layeredOUT=vec4(clamp(HEART-(bodyWithArms.x+bodyWithArms.y+bodyWithArms.z)/2.-starship.xyz/3.+4.*(-pong.r-pong.g-pong.b-linearFrequency.r-linearFrequency.g-linearFrequency.b),0.,1.)+(GOH.xyz//+pixelStarship.xyz
                                                                                                                                                                                                                                  )/4.+pong.xyz+linearFrequency.xyz+pillar+insideOut.xyz+starship.xyz+bodyWithArms.xyz+mannyFace.x/64.-oneEye.r*2.,1.);
                       if(pixelShipGrey!=0.)layeredOUT=layeredOUT*pixelShipGrey+pixelShipGrey;
                       }
                                 else if(oneEye.r!=0.){layeredOUT=vec4(-oneEye.x*.25+starship.xyz/1.5+bodyWithArms.xyz*bodyWithArms.w,1.);
                                if(insideOut.w==.5)layeredOUT+=vec4(insideOut.xyz/3.,0.);
                       }
                       else if (pongBall.r!=0.)layeredOUT=vec4(pongBall,1.);
                       else if(mannyFace.w==-.25&&pixelShipGrey==0.&&isBlack!=0.&&isWhite!=1.)
                    {
                     layeredOUT=vec4(1.+clamp(mannyFace.xyz,-1.,0.)+starship.xyz/4.+bodyWithArms.xyz,1.);
                    }
                                           else if(outerARMS!=0.&&pixelShipGrey==0.&&isBlack!=0.&&isWhite!=1.)layeredOUT=vec4(0.);

else {
                  
                       vec4 ss =clamp(StaRivers*spirographTranslucerStaRivers+DOTstarship*spirographTranslucerDOT+starship*spirographTranslucer+(-bodyWithArms.r-bodyWithArms.g-bodyWithArms.b)*20.
                                    +yourFace.xyzw-vec4(oneEye
                                                        ,0.)/2. -vec4(ARTICLE,0.),0.,1.);
                                           //*pow(radialIntensity,3.)/2.;
                                    
                                
                       vec4 faceFromShip =vec4(0.);// vec4(clamp(mannyFace.xyz,0.,1.)-backgroundFace*starshipMultiplier,0.)*(1.-isGreyISH*2.);
                       vec4 goodies =
                       vec4(
                                           mnyX+
                                           backgroundFace+//is this in the right layer?
                            clamp(heartWarmed*isColoredMultiplier                            -(oneEye)//*((isGrey+pixelShipGrey)/2.)*2.
,0.,1.)

                            +unrolledEyes+clamp(insideOut.xyz-(bodyWithArms.r+bodyWithArms.g+bodyWithArms.b)*20.                            -(oneEye)//*((isGrey+pixelShipGrey)/2.)*2.
,0.,1.)
                            -(oneEye)//*((isGrey+pixelShipGrey)/2.)*2.

                                           +largeEyeColor*clamp(bigEyes-(ss.r+ss.g+ss.b)*ss.w,0.,1.)*1.*starshipMultiplier
                                          +(pillar
                                            +icicles.xyz
                                                +
                                            clamp(
                                            +linearFrequency.xyz
                                                  -(pong.r+pong.g+pong.b),0.,1.)
                                        +linearFrequency.w
                                            +pong
                                            
                                            +GOH.xyz)*(1.-pixelShipGrey*40.)
                                        +yourFace.xyz
                    +//clamp((
                           (mny-oneEye*100.*mny)//*(1.-isGrey-pixelShipGrey)
                            +overchargeCharacter
                            +pixelStarship.xyz
                                      //     -clamp(vec3(pixelStarship.b,pixelStarship.g-pixelStarship.g*pixelStarship.g,pixelStarship.r),0.,1.)*2.*mnyWhite
                                     // +(-hypnoticHarmonicCircles.x-hypnoticHarmonicCircles.y-hypnoticHarmonicCircles.z)*2.)*starshipMultiplier*(1.-isGrey-pixelShipGrey)
                      //  -(ARTICLE.r+ARTICLE.g+ARTICLE.b)
                        //   ,-1.,1.)
                                                    +ARTICLE
                                                   +bridge//*(1.-isGrey-pixelShipGrey)//+AM*(1.-isGrey-pixelShipGrey)
                                                    ,1.);
                       vec3 awayFromTree =  vec3((-ss.x-ss.y-ss.z)*starship.w
                                                 -yourFace.xyz
                                                 +(-pixelStarship.x-pixelStarship.y-pixelStarship.z)/2.

                                                 +(-HEART.b*2.5-HEART.r-HEART.g)/3.
                                                // +(-HEART.b-HEART.r-HEART.g)/4.
                                                 -clamp(AM.r*17.,0.,1.)
                                                 +(-linearFrequency.r-linearFrequency.g-linearFrequency.b)*4.
                                                 -(pong.r+pong.g+pong.b)
                                                 +bigEyes.xyz*largeEyeColor
                                                // +moreHorns
                                                 -(yourFace.x+yourFace.y+yourFace.z)/256./3.
                        -(ARTICLE.x+ARTICLE.y+ARTICLE.z)*40.
                                                 -oneEye.r*10.

                       -(bridge.x+bridge.y+bridge.z)*4.
                       //-(shipSUM)/maxColorOfStarship*starship.w
                                  
                       -(DOTstarship.x+DOTstarship.y+DOTstarship.z)/DOTmaxColorOfStarship*.5*DOTstarship.w
                      -(StaRivers.r+StaRivers.g+StaRivers.b)*StaRivers.w
                       -(creatures.r+creatures.g+creatures.b+b.b+b.g+b.r)*4.
                                                 
                                                 +(-mny.r-mny.g-mny.b)*(mannyFace.w+1.)*20.
                                                 
                                                 );
float treeBrightner = 1.;

if(colorCombo==-1&&!remediatedColors&&Inherited)treeBrightner=-leaf;
vec4 tree = vec4( clamp(
                     clamp(
                           cloud
                           +(zoomer
                           +awayFromTree)*treeBrightner
                           
                                              ,0.,1.)
                        +b+creatures
                   
          ,.0,1.)
              ,1.);

          vec4 fin = (clamp(vec4(ss.xyz*starshipMultiplier
                                 ,1.)
                            -faceFromShip,0.,1.)+clamp(
                                                                                     goodies+
                                                                                     tree//+pixelShipGrey
                                                       ,0.,1.))*isBlack*isBlackStaRivers*isBlackDOT+(isBlack-1.)+(isBlackDOT-1.)+(isBlackStaRivers-1.);
                                                                               if ((starship.x!=starship.y||starship.y!=starship.x||starship.z!=starship.x||starship.z!=starship.y)&&shipSUM<126./255.&&starship.w==1.)fin*= shipSUM*4.;//to show black on oreo

                                                             float radialIntensity = length(r);
             if( moreHorns.r!=0.)fin=vec4((fin.xyz-(ss.x-ss.y-ss.z)*10.)+ss.xyz+vec3(moreHorns.r*pow(radialIntensity,3.5)),0.);
                                                             
                                                            /* if(isGrey!=0.&&isGrey!=1.&&pixelShipGrey==0.)fin=vec4(vec3(.25),1.);*/

                                                            else if(isGrey!=.0&&pixelShipGrey!=0.)fin=vec4(vec3(.125),1.);
                                                                else if (isGrey!=.0)fin=vec4(vec3(.5),1.);
                                                                else if(fin.r>=1.&&fin.g>=1.&&fin.b>=1.&&starship.w!=0.&&pixelShipGrey!=0.)
                                                                 fin=vec4(vec3(.25),1.);

                                                                                    else if(fin.r<=0.&&fin.g<=0.&&fin.b<=0.&&starship.w!=0.&&pixelShipGrey!=0. ){                         fin=vec4(vec3(.75),1.);
                                                                                         }
                                                                                    else if (pixelShipGrey!=0.)
                                                                                    fin=vec4(pixelShipGrey+pixelShipGrey*clamp(fin.xyz,0.,1.)*2.,1.);
                                                                                    //else if (isGreyStaRivers==.5)fin=vec4(1.);
                                                                                    //else if(isBlackStaRivers!=1.)fin=vec4(0.);
                                                        /*
                                                            
          else if(fin.r>=1.&&fin.g>=1.&&fin.b>=1.)fin-=(isGrey+isGreyDOT+pixelShipGrey+isGreyStaRivers+pixelShipGrey*1.5)*2.;
          else if((fin.r<=.0&&fin.g<=.0&&fin.b<=.0))fin+=(isGrey+isGreyDOT+isGreyStaRivers+pixelShipGrey)*1.5;
                                                          */
                                                      
          vec3 confraculator = vec3(1.);
          if(sparklesON)confraculator=sparkles(p*length(vec2(length(vec2(fin.x,fin.y)),fin.z)));
          vec3 card = vec3(1.);
          if(cards){vec2 fracp = FRACTALIZE(p);
              
              card =lamb(fracp)*2.
              +scroll(min(resolution.x, resolution.y)/max(resolution.x, resolution.y)*4.*vec2(fracp.x,fracp.y+3.),vec2(inversion,0.))*12.;
              }
                    /*
              card+=lamb(fracd);
              fracd = FRACTALIZE(fracd);
              card+=lamb(fracd);
              card/=4.;
              */
          
          fin=clamp(fin/vec4(card,1.) -(hypnoticHarmonicCircles.x+hypnoticHarmonicCircles.y+hypnoticHarmonicCircles.z+ARTICLE.x+ARTICLE.y+ARTICLE.z)*4.,0.,1.)+vec4(clamp(hypnoticHarmonicCircles+ARTICLE-(isGrey+pixelShipGrey),0.,1.),1.);
          layeredOUT=//vec4(mny,1.);
fin/vec4(confraculator
                           ,1.);
                       
       //  gl_FragColor= vec4(.5);
       
       

                   }
                   
           if(movieTime<=5.&&movieTime>=0.)layeredOUT=vec4(movie(characterP),1.);
                          else if(movieTime==-2.)layeredOUT=vec4(0.);
    
                        gl_FragColor=layeredOUT;//vec4(movie(characterP),1.);//
//things known to cause bugs on some android chrome: heart (divides by zero), linear eq,waveform, "144000" men and women in clover, articles
                                                                 
                                         }

</script>

  <video id="video" style="display:none">Video stream not available.</video>
  <canvas id="videoCanvas" style="display:none"> </canvas>

  <video id="video2" style="display:none">Video stream not available.</video>
  <canvas id="videoCanvas2" style="display:none"> </canvas>


<script src="loadMicrophone.js"></script>
<script src="hotkeys.js" ></script>
<script src="starshipMod.js"></script>
<script src="bigTreeOfLife.js"></script>

    </body>
</html>
